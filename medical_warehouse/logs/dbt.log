[0m12:15:44.704518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724741ab2a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724741684980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7247410723f0>]}


============================== 12:15:44.711203 | 26207949-4888-419c-be87-590fe35c18c6 ==============================
[0m12:15:44.711203 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:15:44.712202 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'invocation_command': 'dbt debug', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'target_path': 'None', 'write_json': 'True'}
[0m12:15:44.737233 [info ] [MainThread]: dbt version: 1.11.2
[0m12:15:44.738421 [info ] [MainThread]: python version: 3.12.3
[0m12:15:44.739510 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:15:44.740907 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:15:44.755057 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:15:44.760695 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1420297, "process_in_blocks": "107664", "process_kernel_time": 0.271495, "process_mem_max_rss": "98960", "process_out_blocks": "16", "process_user_time": 2.052748}
[0m12:15:44.763276 [debug] [MainThread]: Command `dbt debug` failed at 12:15:44.761962 after 0.14 seconds
[0m12:15:44.765671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724741964a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724740c70bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7247411920c0>]}
[0m12:15:44.767097 [debug] [MainThread]: Flushing usage events
[0m12:15:45.745168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:51.800952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265feaa0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265ff999550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265fef4b320>]}


============================== 12:17:51.810525 | d4ed91cd-40f8-4f77-a647-ded623a41322 ==============================
[0m12:17:51.810525 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:17:51.811927 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'target_path': 'None'}
[0m12:17:51.842740 [info ] [MainThread]: dbt version: 1.11.2
[0m12:17:51.843542 [info ] [MainThread]: python version: 3.12.3
[0m12:17:51.844251 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:17:51.845111 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:17:51.854637 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:17:51.858129 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.16273409, "process_in_blocks": "130786", "process_kernel_time": 0.320149, "process_mem_max_rss": "91880", "process_out_blocks": "16", "process_user_time": 2.32033}
[0m12:17:51.859146 [debug] [MainThread]: Command `dbt debug` failed at 12:17:51.858945 after 0.16 seconds
[0m12:17:51.859886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265fdd59010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265fdd07470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265fe11fd40>]}
[0m12:17:51.861231 [debug] [MainThread]: Flushing usage events
[0m12:17:52.945829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:56.029310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a966b3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a98453800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a97792b70>]}


============================== 12:18:56.047840 | f5db1b40-3d39-4c73-8bda-1c9b580e4407 ==============================
[0m12:18:56.047840 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:18:56.049038 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'empty': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt debug', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False'}
[0m12:18:56.119590 [info ] [MainThread]: dbt version: 1.11.2
[0m12:18:56.120776 [info ] [MainThread]: python version: 3.12.3
[0m12:18:56.122477 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:18:56.123361 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:18:56.299695 [info ] [MainThread]: Using profiles dir at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse
[0m12:18:56.301087 [info ] [MainThread]: Using profiles.yml file at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/profiles.yml
[0m12:18:56.302156 [info ] [MainThread]: Using dbt_project.yml file at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/dbt_project.yml
[0m12:18:56.304199 [info ] [MainThread]: adapter type: postgres
[0m12:18:56.305345 [info ] [MainThread]: adapter version: 1.10.0
[0m12:18:56.558238 [info ] [MainThread]: Configuration:
[0m12:18:56.560060 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:18:56.560881 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:18:56.561977 [info ] [MainThread]: Required dependencies:
[0m12:18:56.564386 [debug] [MainThread]: Executing "git --help"
[0m12:18:56.658379 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:18:56.659628 [debug] [MainThread]: STDERR: "b''"
[0m12:18:56.660380 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:18:56.661164 [info ] [MainThread]: Connection:
[0m12:18:56.662145 [info ] [MainThread]:   host: ep-young-brook-ah5jgfxg-pooler.c-3.us-east-1.aws.neon.tech
[0m12:18:56.663119 [info ] [MainThread]:   port: 5432
[0m12:18:56.664016 [info ] [MainThread]:   user: neondb_owner
[0m12:18:56.664792 [info ] [MainThread]:   database: neondb
[0m12:18:56.665605 [info ] [MainThread]:   schema: public
[0m12:18:56.666612 [info ] [MainThread]:   connect_timeout: 10
[0m12:18:56.667915 [info ] [MainThread]:   role: None
[0m12:18:56.668892 [info ] [MainThread]:   search_path: None
[0m12:18:56.669819 [info ] [MainThread]:   keepalives_idle: 0
[0m12:18:56.670780 [info ] [MainThread]:   sslmode: None
[0m12:18:56.671532 [info ] [MainThread]:   sslcert: None
[0m12:18:56.672424 [info ] [MainThread]:   sslkey: None
[0m12:18:56.673263 [info ] [MainThread]:   sslrootcert: None
[0m12:18:56.673985 [info ] [MainThread]:   application_name: dbt
[0m12:18:56.674658 [info ] [MainThread]:   retries: 1
[0m12:18:56.678492 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:18:57.089026 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:18:57.161331 [debug] [MainThread]: Using postgres connection "debug"
[0m12:18:57.162313 [debug] [MainThread]: On debug: select 1 as id
[0m12:18:57.163127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:59.724222 [debug] [MainThread]: SQL status: SELECT 1 in 2.550 seconds
[0m12:18:59.755071 [debug] [MainThread]: On debug: Close
[0m12:18:59.778807 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:18:59.782204 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:18:59.817546 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.9344578, "process_in_blocks": "251302", "process_kernel_time": 0.526594, "process_mem_max_rss": "99824", "process_out_blocks": "72", "process_user_time": 3.080779}
[0m12:18:59.823533 [debug] [MainThread]: Command `dbt debug` succeeded at 12:18:59.821256 after 3.94 seconds
[0m12:18:59.827482 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:18:59.831648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a99bb7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a94d4a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a957fb8c0>]}
[0m12:18:59.835319 [debug] [MainThread]: Flushing usage events
[0m12:19:01.507043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:20.061126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae904c32fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae90425e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae903fb7bc0>]}


============================== 12:19:20.073495 | e7886ff8-ad2e-421b-83da-a3841a7b2840 ==============================
[0m12:19:20.073495 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:19:20.074888 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'empty': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80'}
[0m12:19:20.111562 [info ] [MainThread]: dbt version: 1.11.2
[0m12:19:20.112679 [info ] [MainThread]: python version: 3.12.3
[0m12:19:20.113597 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:19:20.114520 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:19:20.124977 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:19:20.127731 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.20539492, "process_in_blocks": "149376", "process_kernel_time": 0.353052, "process_mem_max_rss": "90072", "process_out_blocks": "8", "process_user_time": 2.511374}
[0m12:19:20.128729 [debug] [MainThread]: Command `dbt debug` failed at 12:19:20.128543 after 0.21 seconds
[0m12:19:20.129427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae904970500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae903cd3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae903b22f00>]}
[0m12:19:20.130828 [debug] [MainThread]: Flushing usage events
[0m12:19:21.134274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:26.132896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384e34bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384e3813a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384dfba7b0>]}


============================== 12:20:26.139129 | 80459f75-8d64-42a9-a723-504e5a083893 ==============================
[0m12:20:26.139129 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:20:26.140128 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'empty': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'use_experimental_parser': 'False', 'indirect_selection': 'eager'}
[0m12:20:26.166935 [info ] [MainThread]: dbt version: 1.11.2
[0m12:20:26.168154 [info ] [MainThread]: python version: 3.12.3
[0m12:20:26.169169 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:20:26.170183 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:20:26.179999 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:20:26.182557 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12919685, "process_in_blocks": "96104", "process_kernel_time": 0.245682, "process_mem_max_rss": "99696", "process_out_blocks": "8", "process_user_time": 2.002408}
[0m12:20:26.183998 [debug] [MainThread]: Command `dbt debug` failed at 12:20:26.183775 after 0.13 seconds
[0m12:20:26.185190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384dcc1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384cfe9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384d17a660>]}
[0m12:20:26.186634 [debug] [MainThread]: Flushing usage events
[0m12:20:27.428753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:59.661717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb0e45580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb0c9e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb0e20c80>]}


============================== 12:21:59.668880 | 1aeacb8c-f3d8-49e4-9bf5-d709e19457f2 ==============================
[0m12:21:59.668880 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:21:59.670034 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False'}
[0m12:21:59.696079 [info ] [MainThread]: dbt version: 1.11.2
[0m12:21:59.697049 [info ] [MainThread]: python version: 3.12.3
[0m12:21:59.698138 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:21:59.699073 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:21:59.708574 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:21:59.712353 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13688487, "process_in_blocks": "53808", "process_kernel_time": 0.239784, "process_mem_max_rss": "100132", "process_out_blocks": "16", "process_user_time": 2.113289}
[0m12:21:59.714600 [debug] [MainThread]: Command `dbt debug` failed at 12:21:59.714385 after 0.14 seconds
[0m12:21:59.715556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb055fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb0497470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb039fd40>]}
[0m12:21:59.717203 [debug] [MainThread]: Flushing usage events
[0m12:22:00.720242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:12.676546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730847c6b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730847b01ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7308474f4b30>]}


============================== 12:24:12.685320 | 92cf703f-128b-4207-b413-eec05401c79d ==============================
[0m12:24:12.685320 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:24:12.686522 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'invocation_command': 'dbt debug', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs'}
[0m12:24:12.714937 [info ] [MainThread]: dbt version: 1.11.2
[0m12:24:12.718077 [info ] [MainThread]: python version: 3.12.3
[0m12:24:12.719029 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:24:12.719965 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:24:12.853431 [info ] [MainThread]: Using profiles dir at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse
[0m12:24:12.854129 [info ] [MainThread]: Using profiles.yml file at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/profiles.yml
[0m12:24:12.854913 [info ] [MainThread]: Using dbt_project.yml file at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/dbt_project.yml
[0m12:24:12.856388 [info ] [MainThread]: adapter type: postgres
[0m12:24:12.857110 [info ] [MainThread]: adapter version: 1.10.0
[0m12:24:13.186082 [info ] [MainThread]: Configuration:
[0m12:24:13.186857 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:24:13.187560 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:24:13.188216 [info ] [MainThread]: Required dependencies:
[0m12:24:13.188970 [debug] [MainThread]: Executing "git --help"
[0m12:24:13.194681 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:24:13.196342 [debug] [MainThread]: STDERR: "b''"
[0m12:24:13.198129 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:24:13.199590 [info ] [MainThread]: Connection:
[0m12:24:13.200850 [info ] [MainThread]:   host: ep-young-brook-ah5jgfxg-pooler.c-3.us-east-1.aws.neon.tech
[0m12:24:13.205307 [info ] [MainThread]:   port: 5432
[0m12:24:13.206628 [info ] [MainThread]:   user: neondb_owner
[0m12:24:13.208816 [info ] [MainThread]:   database: neondb
[0m12:24:13.210210 [info ] [MainThread]:   schema: public
[0m12:24:13.211583 [info ] [MainThread]:   connect_timeout: 10
[0m12:24:13.213101 [info ] [MainThread]:   role: None
[0m12:24:13.214524 [info ] [MainThread]:   search_path: None
[0m12:24:13.216015 [info ] [MainThread]:   keepalives_idle: 0
[0m12:24:13.217425 [info ] [MainThread]:   sslmode: require
[0m12:24:13.218927 [info ] [MainThread]:   sslcert: None
[0m12:24:13.220455 [info ] [MainThread]:   sslkey: None
[0m12:24:13.221810 [info ] [MainThread]:   sslrootcert: None
[0m12:24:13.222838 [info ] [MainThread]:   application_name: dbt
[0m12:24:13.223572 [info ] [MainThread]:   retries: 1
[0m12:24:13.224593 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:24:13.479683 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:24:13.544421 [debug] [MainThread]: Using postgres connection "debug"
[0m12:24:13.545325 [debug] [MainThread]: On debug: select 1 as id
[0m12:24:13.546250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:16.628845 [debug] [MainThread]: SQL status: SELECT 1 in 3.083 seconds
[0m12:24:16.630372 [debug] [MainThread]: On debug: Close
[0m12:24:16.631152 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:24:16.631774 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:24:16.633454 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.0433774, "process_in_blocks": "107426", "process_kernel_time": 0.314338, "process_mem_max_rss": "116216", "process_out_blocks": "24", "process_user_time": 2.486041}
[0m12:24:16.634465 [debug] [MainThread]: Command `dbt debug` succeeded at 12:24:16.634225 after 4.04 seconds
[0m12:24:16.635765 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:24:16.637245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730848395c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7308479472c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7308474f4b30>]}
[0m12:24:16.638577 [debug] [MainThread]: Flushing usage events
[0m12:24:17.632238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:05.488526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abb144ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abaf2cbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abaeee2840>]}


============================== 12:26:05.494905 | 2e65e85d-2f13-4008-82bc-5200542c96a1 ==============================
[0m12:26:05.494905 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:26:05.495837 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False'}
[0m12:26:05.747372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e65e85d-2f13-4008-82bc-5200542c96a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abadf5fda0>]}
[0m12:26:05.838571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e65e85d-2f13-4008-82bc-5200542c96a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abaf332660>]}
[0m12:26:05.841473 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:26:06.069809 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:26:06.072446 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:26:06.073448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e65e85d-2f13-4008-82bc-5200542c96a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abadfa6ed0>]}
[0m12:26:07.646208 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m12:26:07.648161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2397048, "process_in_blocks": "55592", "process_kernel_time": 0.311105, "process_mem_max_rss": "115500", "process_out_blocks": "16", "process_user_time": 3.880262}
[0m12:26:07.649002 [debug] [MainThread]: Command `dbt run` failed at 12:26:07.648862 after 2.24 seconds
[0m12:26:07.649620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abaeee2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abad31ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abacbe33b0>]}
[0m12:26:07.650240 [debug] [MainThread]: Flushing usage events
[0m12:26:08.692759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:46.504945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7b42ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec792a7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7a85fc20>]}


============================== 12:31:46.512024 | 8e254b02-cf7f-43c6-9d00-c5c3278b2887 ==============================
[0m12:31:46.512024 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:31:46.513606 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'empty': 'False', 'static_parser': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True'}
[0m12:31:46.785138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec787aa690>]}
[0m12:31:46.878135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec787831d0>]}
[0m12:31:46.879584 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:31:47.028461 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:31:47.030331 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:31:47.031061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7882ff80>]}
[0m12:31:48.712023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec77f5d7c0>]}
[0m12:31:48.826165 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m12:31:48.829692 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m12:31:48.858511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec77b6c440>]}
[0m12:31:48.859448 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m12:31:48.860174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7675e360>]}
[0m12:31:48.863066 [info ] [MainThread]: 
[0m12:31:48.863800 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:48.864417 [info ] [MainThread]: 
[0m12:31:48.865430 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:31:48.874124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m12:31:48.953270 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m12:31:48.953921 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m12:31:48.954544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:51.024144 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.070 seconds
[0m12:31:51.028340 [debug] [ThreadPool]: On list_neondb: Close
[0m12:31:51.030665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m12:31:51.038201 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m12:31:51.038899 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:31:51.039408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:52.766363 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.727 seconds
[0m12:31:52.768799 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m12:31:52.953264 [debug] [ThreadPool]: On list_neondb_public: Close
[0m12:31:52.960844 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:52.961527 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:31:52.962116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:54.421843 [debug] [MainThread]: SQL status: SELECT 0 in 1.460 seconds
[0m12:31:54.426270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec77b007d0>]}
[0m12:31:54.428823 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:54.601573 [debug] [MainThread]: On master: COMMIT
[0m12:31:54.602324 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:54.603079 [debug] [MainThread]: On master: COMMIT
[0m12:31:54.944068 [debug] [MainThread]: SQL status: COMMIT in 0.339 seconds
[0m12:31:54.945032 [debug] [MainThread]: On master: Close
[0m12:31:54.952232 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m12:31:54.953185 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m12:31:54.953981 [info ] [Thread-1 (]: 1 of 4 START sql table model public.dim_dates .................................. [RUN]
[0m12:31:54.954891 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m12:31:54.955779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m12:31:54.956606 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m12:31:54.957324 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m12:31:54.958122 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m12:31:54.968050 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m12:31:54.976122 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m12:31:54.977865 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m12:31:54.985151 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m12:31:55.086167 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m12:31:55.091051 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m12:31:55.092645 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:31:55.093389 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:31:55.094093 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m12:31:55.094919 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- Generate date dimension for last 2 years
with dates as (
    select generate_series(
        current_date - interval '2 years',
        current_date + interval '1 year',
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    to_char(full_date, 'Day') as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    to_char(full_date, 'Month') as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from dates
  );
  
[0m12:31:55.095648 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:31:55.096428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:56.550321 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.453 seconds
[0m12:31:56.558898 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:31:56.559646 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m12:31:56.583496 [debug] [Thread-1 (]: SQL status: SELECT 1097 in 1.487 seconds
[0m12:31:56.591694 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:31:56.592400 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:31:56.733345 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.173 seconds
[0m12:31:56.751374 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m12:31:56.752113 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:31:56.752723 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m12:31:56.769459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m12:31:56.771763 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m12:31:56.772551 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:31:56.773179 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m12:31:56.922172 [debug] [Thread-2 (]: SQL status: COMMIT in 0.169 seconds
[0m12:31:56.932525 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m12:31:56.939540 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:31:56.940301 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m12:31:56.947669 [debug] [Thread-1 (]: SQL status: COMMIT in 0.174 seconds
[0m12:31:56.951052 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m12:31:56.955053 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:31:56.955750 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m12:31:57.109468 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.168 seconds
[0m12:31:57.114010 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m12:31:57.135409 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.179 seconds
[0m12:31:57.137454 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m12:31:57.161312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7b32f6b0>]}
[0m12:31:57.162233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec74dbdb50>]}
[0m12:31:57.163360 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 2.16s]
[0m12:31:57.164549 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.dim_dates ............................. [[32mSELECT 1097[0m in 2.18s]
[0m12:31:57.165747 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m12:31:57.166654 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m12:31:57.167843 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_channels
[0m12:31:57.168568 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m12:31:57.169486 [info ] [Thread-4 (]: 3 of 4 START sql table model public.dim_channels ............................... [RUN]
[0m12:31:57.172099 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m12:31:57.170896 [info ] [Thread-1 (]: 4 of 4 START sql table model public.fct_messages ............................... [RUN]
[0m12:31:57.173059 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_channels
[0m12:31:57.173766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.fct_messages)
[0m12:31:57.178119 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m12:31:57.179060 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m12:31:57.183410 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m12:31:57.184290 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_channels
[0m12:31:57.190016 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m12:31:57.190749 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m12:31:57.199458 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m12:31:57.200613 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:31:57.202385 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m12:31:57.203377 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m12:31:57.204251 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:31:57.205040 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m12:31:57.206081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:58.610396 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column s.has_media does not exist
LINE 20:     s.has_media
             ^

[0m12:31:58.611453 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: ROLLBACK
[0m12:31:58.719175 [debug] [Thread-4 (]: SQL status: SELECT 3 in 1.515 seconds
[0m12:31:58.723991 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:31:58.724650 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m12:31:58.785395 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m12:31:58.794432 [debug] [Thread-1 (]: Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql
[0m12:31:58.796780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7442fad0>]}
[0m12:31:58.797835 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.fct_messages ...................... [[31mERROR[0m in 1.62s]
[0m12:31:58.798993 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m12:31:58.800135 [debug] [Thread-7 (]: Marking all children of 'model.medical_warehouse.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql.
[0m12:31:58.910477 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.185 seconds
[0m12:31:58.916781 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m12:31:58.917948 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:31:58.919006 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m12:31:59.107425 [debug] [Thread-4 (]: SQL status: COMMIT in 0.187 seconds
[0m12:31:59.112023 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m12:31:59.113562 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:31:59.114961 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m12:31:59.297111 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.181 seconds
[0m12:31:59.299319 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: Close
[0m12:31:59.300315 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec744655e0>]}
[0m12:31:59.301238 [info ] [Thread-4 (]: 3 of 4 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 2.13s]
[0m12:31:59.303279 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_channels
[0m12:31:59.306075 [debug] [MainThread]: On master: COMMIT
[0m12:31:59.306764 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:59.307301 [debug] [MainThread]: On master: COMMIT
[0m12:31:59.307950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:32:00.758136 [debug] [MainThread]: SQL status: COMMIT in 1.450 seconds
[0m12:32:00.760440 [debug] [MainThread]: On master: Close
[0m12:32:00.763606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:00.765547 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m12:32:00.766297 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m12:32:00.766901 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m12:32:00.767586 [info ] [MainThread]: 
[0m12:32:00.768197 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 11.90 seconds (11.90s).
[0m12:32:00.769761 [debug] [MainThread]: Command end result
[0m12:32:00.806616 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m12:32:00.810122 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m12:32:00.821683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m12:32:00.822609 [info ] [MainThread]: 
[0m12:32:00.823555 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:32:00.824456 [info ] [MainThread]: 
[0m12:32:00.825467 [error] [MainThread]: [31mFailure in model fct_messages (models/marts/fct_messages.sql)[0m
[0m12:32:00.826488 [error] [MainThread]:   Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql
[0m12:32:00.827345 [info ] [MainThread]: 
[0m12:32:00.828356 [info ] [MainThread]:   compiled code at target/compiled/medical_warehouse/models/marts/fct_messages.sql
[0m12:32:00.829284 [info ] [MainThread]: 
[0m12:32:00.830469 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m12:32:00.833000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.428364, "process_in_blocks": "129920", "process_kernel_time": 0.405302, "process_mem_max_rss": "128164", "process_out_blocks": "2912", "process_user_time": 4.707509}
[0m12:32:00.834404 [debug] [MainThread]: Command `dbt run` failed at 12:32:00.834127 after 14.43 seconds
[0m12:32:00.835620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7cee3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec78c90ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec797e80e0>]}
[0m12:32:00.836931 [debug] [MainThread]: Flushing usage events
[0m12:32:01.954576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:04.764887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c72c7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c97578c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c79c7fe0>]}


============================== 12:54:04.773658 | 984135a1-ca97-4b06-906f-6999190e06bb ==============================
[0m12:54:04.773658 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:54:04.774812 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'use_experimental_parser': 'False', 'empty': 'False', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'static_parser': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m12:54:05.071255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c6b0fbc0>]}
[0m12:54:05.172268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c7266960>]}
[0m12:54:05.173996 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:54:05.332537 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:54:05.611804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:05.612498 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:54:05.613102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:05.674576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c59c9f10>]}
[0m12:54:05.779465 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m12:54:05.782341 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m12:54:05.817157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c51ca630>]}
[0m12:54:05.817948 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m12:54:05.818538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c55caae0>]}
[0m12:54:05.821149 [info ] [MainThread]: 
[0m12:54:05.821852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:05.822613 [info ] [MainThread]: 
[0m12:54:05.823764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:05.831989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m12:54:05.913157 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m12:54:05.913866 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m12:54:05.914433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:08.010476 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.096 seconds
[0m12:54:08.013133 [debug] [ThreadPool]: On list_neondb: Close
[0m12:54:08.015859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m12:54:08.023240 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m12:54:08.024157 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:54:08.024868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:10.011905 [debug] [ThreadPool]: SQL status: SELECT 3 in 1.987 seconds
[0m12:54:10.014456 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m12:54:10.315516 [debug] [ThreadPool]: On list_neondb_public: Close
[0m12:54:10.324864 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:10.326505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:54:10.327698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:15.071263 [debug] [MainThread]: SQL status: SELECT 1 in 4.743 seconds
[0m12:54:15.073692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c6a4c2c0>]}
[0m12:54:15.074913 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:15.330912 [debug] [MainThread]: On master: COMMIT
[0m12:54:15.333195 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:15.335415 [debug] [MainThread]: On master: COMMIT
[0m12:54:15.798029 [debug] [MainThread]: SQL status: COMMIT in 0.460 seconds
[0m12:54:15.799000 [debug] [MainThread]: On master: Close
[0m12:54:15.849788 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m12:54:15.850536 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m12:54:15.851519 [info ] [Thread-1 (]: 1 of 4 START sql table model public.dim_dates .................................. [RUN]
[0m12:54:15.852578 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m12:54:15.853445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m12:54:15.856535 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m12:54:15.857298 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m12:54:15.858227 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m12:54:15.880217 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m12:54:15.881555 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m12:54:15.883782 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m12:54:15.908545 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m12:54:15.972067 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m12:54:15.982285 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m12:54:15.986101 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:15.988651 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:15.990974 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m12:54:15.992293 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- Generate date dimension for last 2 years
with dates as (
    select generate_series(
        current_date - interval '2 years',
        current_date + interval '1 year',
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    to_char(full_date, 'Day') as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    to_char(full_date, 'Month') as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from dates
  );
  
[0m12:54:15.993724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:15.994604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:18.194522 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 2.201 seconds
[0m12:54:18.221860 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:18.223969 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m12:54:18.225516 [debug] [Thread-1 (]: SQL status: SELECT 1097 in 2.231 seconds
[0m12:54:18.243309 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:18.245507 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m12:54:18.511754 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.285 seconds
[0m12:54:18.512626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.266 seconds
[0m12:54:18.517517 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:18.524813 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:18.525608 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m12:54:18.526375 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:54:18.803368 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.276 seconds
[0m12:54:18.810119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.282 seconds
[0m12:54:18.851031 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m12:54:18.853388 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m12:54:18.855295 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:18.856863 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:18.857760 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m12:54:18.858725 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m12:54:19.118215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.259 seconds
[0m12:54:19.126473 [debug] [Thread-2 (]: SQL status: COMMIT in 0.267 seconds
[0m12:54:19.134306 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m12:54:19.144677 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m12:54:19.168235 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:19.173496 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:19.174478 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m12:54:19.175332 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m12:54:19.457830 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.281 seconds
[0m12:54:19.458911 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.283 seconds
[0m12:54:19.462795 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m12:54:19.464844 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m12:54:19.467944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c9557770>]}
[0m12:54:19.468766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c79c54c0>]}
[0m12:54:19.470252 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 3.61s]
[0m12:54:19.471975 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.dim_dates ............................. [[32mSELECT 1097[0m in 3.61s]
[0m12:54:19.473997 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m12:54:19.475313 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m12:54:19.477558 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m12:54:19.479140 [debug] [Thread-4 (]: Began running node model.medical_warehouse.fct_messages
[0m12:54:19.481556 [info ] [Thread-1 (]: 3 of 4 START sql table model public.dim_channels ............................... [RUN]
[0m12:54:19.483218 [info ] [Thread-4 (]: 4 of 4 START sql table model public.fct_messages ............................... [RUN]
[0m12:54:19.484321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.dim_channels)
[0m12:54:19.485688 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m12:54:19.487064 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m12:54:19.490097 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.fct_messages
[0m12:54:19.504252 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m12:54:19.505528 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m12:54:19.507660 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m12:54:19.514397 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.fct_messages
[0m12:54:19.521564 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m12:54:19.530585 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:19.532201 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m12:54:19.533371 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m12:54:19.538731 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m12:54:19.540357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:19.543356 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m12:54:19.546603 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:54:21.408339 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.868 seconds
[0m12:54:21.419008 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:21.420142 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m12:54:21.597227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m12:54:21.607078 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:21.608362 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m12:54:21.765723 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column s.has_media does not exist
LINE 20:     s.has_media
             ^

[0m12:54:21.766507 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: ROLLBACK
[0m12:54:21.781805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.171 seconds
[0m12:54:21.789372 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m12:54:21.790965 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:21.792140 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m12:54:21.969011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.175 seconds
[0m12:54:21.973813 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m12:54:21.975170 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:21.975750 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m12:54:22.025270 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: Close
[0m12:54:22.038619 [debug] [Thread-4 (]: Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql
[0m12:54:22.039642 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c5d658e0>]}
[0m12:54:22.040658 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model public.fct_messages ...................... [[31mERROR[0m in 2.55s]
[0m12:54:22.041751 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.fct_messages
[0m12:54:22.042577 [debug] [Thread-7 (]: Marking all children of 'model.medical_warehouse.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql.
[0m12:54:22.151265 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.175 seconds
[0m12:54:22.160781 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: Close
[0m12:54:22.161918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c516d340>]}
[0m12:54:22.162911 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 2.68s]
[0m12:54:22.164798 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m12:54:22.170368 [debug] [MainThread]: On master: COMMIT
[0m12:54:22.171106 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:22.171882 [debug] [MainThread]: On master: COMMIT
[0m12:54:22.172532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:24.277101 [debug] [MainThread]: SQL status: COMMIT in 2.105 seconds
[0m12:54:24.277976 [debug] [MainThread]: On master: Close
[0m12:54:24.279471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:24.281792 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m12:54:24.282758 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m12:54:24.283362 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m12:54:24.284146 [info ] [MainThread]: 
[0m12:54:24.284855 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 18.46 seconds (18.46s).
[0m12:54:24.286629 [debug] [MainThread]: Command end result
[0m12:54:24.336472 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m12:54:24.340691 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m12:54:24.353483 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m12:54:24.354416 [info ] [MainThread]: 
[0m12:54:24.355470 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:54:24.356686 [info ] [MainThread]: 
[0m12:54:24.357949 [error] [MainThread]: [31mFailure in model fct_messages (models/marts/fct_messages.sql)[0m
[0m12:54:24.359498 [error] [MainThread]:   Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql
[0m12:54:24.360674 [info ] [MainThread]: 
[0m12:54:24.362144 [info ] [MainThread]:   compiled code at target/compiled/medical_warehouse/models/marts/fct_messages.sql
[0m12:54:24.363295 [info ] [MainThread]: 
[0m12:54:24.366212 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m12:54:24.369628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 19.715199, "process_in_blocks": "124048", "process_kernel_time": 0.421761, "process_mem_max_rss": "125716", "process_out_blocks": "1984", "process_user_time": 3.506079}
[0m12:54:24.371351 [debug] [MainThread]: Command `dbt run` failed at 12:54:24.370941 after 19.72 seconds
[0m12:54:24.372906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c97578c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c6b0fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c0886fc0>]}
[0m12:54:24.374442 [debug] [MainThread]: Flushing usage events
[0m12:54:25.690622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:09.902756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aadb1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aa6c6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230ad24f410>]}


============================== 13:02:09.909253 | 1fb4da35-f56d-48a3-a960-102fba477ba6 ==============================
[0m13:02:09.909253 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:02:09.911162 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'empty': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'quiet': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'no_print': 'None'}
[0m13:02:10.167847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aa2a3e90>]}
[0m13:02:10.256712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aad52a20>]}
[0m13:02:10.257884 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:02:10.397164 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:02:10.569474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:02:10.571167 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/staging/stg_telegram_messages.sql
[0m13:02:11.061935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a8ffd2e0>]}
[0m13:02:11.187477 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:02:11.191901 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:02:11.220381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a870adb0>]}
[0m13:02:11.221179 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m13:02:11.221804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a8fb4f80>]}
[0m13:02:11.224440 [info ] [MainThread]: 
[0m13:02:11.225138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:02:11.225731 [info ] [MainThread]: 
[0m13:02:11.226569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:02:11.233074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m13:02:11.295846 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m13:02:11.296968 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m13:02:11.298077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:12.870902 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.573 seconds
[0m13:02:12.873801 [debug] [ThreadPool]: On list_neondb: Close
[0m13:02:12.876118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m13:02:12.883762 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m13:02:12.884479 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:02:12.885069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:14.333216 [debug] [ThreadPool]: SQL status: SELECT 3 in 1.448 seconds
[0m13:02:14.335944 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m13:02:14.512238 [debug] [ThreadPool]: On list_neondb_public: Close
[0m13:02:14.519948 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:14.521027 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:02:14.521870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:16.100680 [debug] [MainThread]: SQL status: SELECT 1 in 1.579 seconds
[0m13:02:16.103032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a8becaa0>]}
[0m13:02:16.104020 [debug] [MainThread]: On master: ROLLBACK
[0m13:02:16.283971 [debug] [MainThread]: On master: COMMIT
[0m13:02:16.284764 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:16.285331 [debug] [MainThread]: On master: COMMIT
[0m13:02:16.650132 [debug] [MainThread]: SQL status: COMMIT in 0.364 seconds
[0m13:02:16.650880 [debug] [MainThread]: On master: Close
[0m13:02:16.677285 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m13:02:16.678429 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m13:02:16.679521 [info ] [Thread-1 (]: 1 of 4 START sql table model public.dim_dates .................................. [RUN]
[0m13:02:16.680740 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m13:02:16.681607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m13:02:16.682771 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m13:02:16.683613 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m13:02:16.684348 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m13:02:16.699074 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m13:02:16.700453 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m13:02:16.726349 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m13:02:16.734108 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m13:02:16.847961 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m13:02:16.860196 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m13:02:16.861376 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:16.862670 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m13:02:16.863797 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:02:16.864611 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:16.866042 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- Generate date dimension for last 2 years
with dates as (
    select generate_series(
        current_date - interval '2 years',
        current_date + interval '1 year',
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    to_char(full_date, 'Day') as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    to_char(full_date, 'Month') as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from dates
  );
  
[0m13:02:16.867221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:18.380315 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.516 seconds
[0m13:02:18.393344 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:18.394060 [debug] [Thread-1 (]: SQL status: SELECT 1097 in 1.527 seconds
[0m13:02:18.394839 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m13:02:18.403896 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:18.404694 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m13:02:18.577584 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.173 seconds
[0m13:02:18.582445 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:18.583116 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m13:02:18.586554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.181 seconds
[0m13:02:18.590802 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:18.591514 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m13:02:18.754497 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.171 seconds
[0m13:02:18.775533 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m13:02:18.776139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.183 seconds
[0m13:02:18.776777 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:18.779068 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m13:02:18.779652 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m13:02:18.780524 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:18.781407 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m13:02:18.962419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.180 seconds
[0m13:02:18.970892 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m13:02:18.983545 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:18.984968 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m13:02:19.001226 [debug] [Thread-2 (]: SQL status: COMMIT in 0.220 seconds
[0m13:02:19.009929 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m13:02:19.121935 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:19.122613 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m13:02:19.178825 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.193 seconds
[0m13:02:19.182820 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m13:02:19.185600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a93bbb60>]}
[0m13:02:19.186894 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.dim_dates ............................. [[32mSELECT 1097[0m in 2.50s]
[0m13:02:19.188091 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m13:02:19.297318 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.174 seconds
[0m13:02:19.300052 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m13:02:19.301234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230ab4d8ce0>]}
[0m13:02:19.302395 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 2.62s]
[0m13:02:19.303567 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m13:02:19.305785 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_channels
[0m13:02:19.306988 [info ] [Thread-4 (]: 3 of 4 START sql table model public.dim_channels ............................... [RUN]
[0m13:02:19.308573 [debug] [Thread-3 (]: Began running node model.medical_warehouse.fct_messages
[0m13:02:19.310314 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m13:02:19.312741 [info ] [Thread-3 (]: 4 of 4 START sql table model public.fct_messages ............................... [RUN]
[0m13:02:19.314486 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_channels
[0m13:02:19.317129 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m13:02:19.327302 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.fct_messages
[0m13:02:19.325890 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m13:02:19.342132 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_channels
[0m13:02:19.339722 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m13:02:19.361930 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.fct_messages
[0m13:02:19.358498 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m13:02:19.379329 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:19.380881 [debug] [Thread-3 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m13:02:19.381629 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m13:02:19.382830 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:02:19.384941 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:02:19.386198 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m13:02:19.387036 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:02:20.846435 [debug] [Thread-4 (]: SQL status: SELECT 3 in 1.464 seconds
[0m13:02:20.855407 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:20.856406 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m13:02:20.869691 [debug] [Thread-3 (]: SQL status: SELECT 276 in 1.483 seconds
[0m13:02:20.874585 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:02:20.875216 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m13:02:21.033679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m13:02:21.038647 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:21.039906 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m13:02:21.058846 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.183 seconds
[0m13:02:21.061674 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m13:02:21.062612 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:02:21.063367 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m13:02:21.217567 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.177 seconds
[0m13:02:21.220034 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m13:02:21.220615 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:21.221169 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m13:02:21.241265 [debug] [Thread-3 (]: SQL status: COMMIT in 0.177 seconds
[0m13:02:21.247200 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public"."fct_messages__dbt_backup"
[0m13:02:21.248831 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:02:21.249500 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "neondb"."public"."fct_messages__dbt_backup" cascade
[0m13:02:21.398694 [debug] [Thread-4 (]: SQL status: COMMIT in 0.177 seconds
[0m13:02:21.401798 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m13:02:21.402980 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:21.403544 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m13:02:21.428363 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.178 seconds
[0m13:02:21.431109 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: Close
[0m13:02:21.432066 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aa64c7a0>]}
[0m13:02:21.432989 [info ] [Thread-3 (]: 4 of 4 OK created sql table model public.fct_messages .......................... [[32mSELECT 276[0m in 2.12s]
[0m13:02:21.433958 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.fct_messages
[0m13:02:21.583493 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.179 seconds
[0m13:02:21.586197 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: Close
[0m13:02:21.587550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a6ae7110>]}
[0m13:02:21.588543 [info ] [Thread-4 (]: 3 of 4 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 2.28s]
[0m13:02:21.590000 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_channels
[0m13:02:21.591872 [debug] [MainThread]: On master: COMMIT
[0m13:02:21.592550 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:21.593121 [debug] [MainThread]: On master: COMMIT
[0m13:02:21.593629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:02:23.051098 [debug] [MainThread]: SQL status: COMMIT in 1.457 seconds
[0m13:02:23.052739 [debug] [MainThread]: On master: Close
[0m13:02:23.054988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:23.056150 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_dates' was properly closed.
[0m13:02:23.057236 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m13:02:23.058104 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m13:02:23.059192 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m13:02:23.060646 [info ] [MainThread]: 
[0m13:02:23.061421 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 11.83 seconds (11.83s).
[0m13:02:23.063269 [debug] [MainThread]: Command end result
[0m13:02:23.128745 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:02:23.135172 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:02:23.153327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m13:02:23.154492 [info ] [MainThread]: 
[0m13:02:23.162423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:23.164269 [info ] [MainThread]: 
[0m13:02:23.167077 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:02:23.173082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.412904, "process_in_blocks": "63128", "process_kernel_time": 0.343797, "process_mem_max_rss": "128956", "process_out_blocks": "2896", "process_user_time": 3.977092}
[0m13:02:23.174593 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:23.174285 after 13.41 seconds
[0m13:02:23.175834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230ab12d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230abb52a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a6ab9e20>]}
[0m13:02:23.177042 [debug] [MainThread]: Flushing usage events
[0m13:02:24.282863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:51.865771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe33792b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2a79910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2ace600>]}


============================== 13:02:51.871670 | ec27bbb7-2e87-47f4-88bc-26abffe28479 ==============================
[0m13:02:51.871670 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:02:51.872856 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'empty': 'None', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'write_json': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs generate', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'cache_selected_only': 'False'}
[0m13:02:52.119346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe28a0920>]}
[0m13:02:52.206570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe3058830>]}
[0m13:02:52.207615 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:02:52.352882 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:02:52.491910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:52.492568 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:02:52.493166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:52.549784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2943740>]}
[0m13:02:52.567770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe13cd220>]}
[0m13:02:52.568617 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m13:02:52.569338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2a074a0>]}
[0m13:02:52.572367 [info ] [MainThread]: 
[0m13:02:52.573172 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:02:52.573888 [info ] [MainThread]: 
[0m13:02:52.575118 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:02:52.581270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public'
[0m13:02:52.659793 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m13:02:52.660545 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:02:52.661184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:54.124826 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.464 seconds
[0m13:02:54.130799 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m13:02:54.312896 [debug] [ThreadPool]: On list_neondb_public: Close
[0m13:02:54.322358 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:54.323237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:02:54.323994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:55.732090 [debug] [MainThread]: SQL status: SELECT 1 in 1.408 seconds
[0m13:02:55.734237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2940440>]}
[0m13:02:55.735062 [debug] [MainThread]: On master: ROLLBACK
[0m13:02:55.908339 [debug] [MainThread]: On master: Close
[0m13:02:55.916660 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m13:02:55.917310 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m13:02:55.918008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m13:02:55.918933 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m13:02:55.919617 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m13:02:55.920224 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m13:02:55.930823 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m13:02:55.934995 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m13:02:55.936311 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m13:02:55.936935 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m13:02:55.938110 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m13:02:55.939582 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m13:02:55.941616 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_channels
[0m13:02:55.942835 [debug] [Thread-3 (]: Began running node model.medical_warehouse.fct_messages
[0m13:02:55.943889 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m13:02:55.945412 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m13:02:55.946375 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m13:02:55.947436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now test.medical_warehouse.assert_no_future_messages)
[0m13:02:55.948226 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_channels
[0m13:02:55.948840 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.fct_messages
[0m13:02:55.949445 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m13:02:55.953311 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m13:02:55.957439 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m13:02:55.963153 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m13:02:55.964515 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_channels
[0m13:02:55.965812 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.fct_messages
[0m13:02:55.967269 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_channels
[0m13:02:55.967960 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m13:02:55.969171 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.fct_messages
[0m13:02:55.970615 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m13:02:55.974462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:55.975388 [debug] [MainThread]: Connection 'test.medical_warehouse.assert_no_future_messages' was properly closed.
[0m13:02:55.976141 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m13:02:55.977415 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m13:02:55.978389 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m13:02:55.981349 [debug] [MainThread]: Command end result
[0m13:02:56.217844 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:02:56.220191 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:02:56.231555 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m13:02:56.238337 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:02:56.239197 [info ] [MainThread]: Building catalog
[0m13:02:56.257223 [debug] [ThreadPool]: Acquiring new postgres connection 'neondb.information_schema'
[0m13:02:56.274153 [debug] [ThreadPool]: Using postgres connection "neondb.information_schema"
[0m13:02:56.275727 [debug] [ThreadPool]: On neondb.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "neondb.information_schema"} */

    
    

    select
        'neondb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_dates')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_telegram_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:02:56.277090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:57.891820 [debug] [ThreadPool]: SQL status: SELECT 41 in 1.615 seconds
[0m13:02:57.899747 [debug] [ThreadPool]: On neondb.information_schema: ROLLBACK
[0m13:02:58.084302 [debug] [ThreadPool]: On neondb.information_schema: Close
[0m13:02:58.112549 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m13:02:58.146603 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:02:58.149120 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:02:58.149754 [info ] [MainThread]: Catalog written to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m13:02:58.151156 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.363494, "process_in_blocks": "21496", "process_kernel_time": 0.293286, "process_mem_max_rss": "123876", "process_out_blocks": "5296", "process_user_time": 3.015107}
[0m13:02:58.152206 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:02:58.152000 after 6.36 seconds
[0m13:02:58.153100 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:02:58.153652 [debug] [MainThread]: Connection 'neondb.information_schema' was properly closed.
[0m13:02:58.154219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe47d7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe6db7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe32ca1e0>]}
[0m13:02:58.154814 [debug] [MainThread]: Flushing usage events
[0m13:02:59.152386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:01.750643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b513ce840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b5133bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b5375f5f0>]}


============================== 13:03:01.754822 | 056a8159-7676-44f4-a985-eee98dfd1b8f ==============================
[0m13:03:01.754822 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:03:01.755957 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'empty': 'None'}
[0m13:03:01.994911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '056a8159-7676-44f4-a985-eee98dfd1b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b50b9a7e0>]}
[0m13:03:02.085640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '056a8159-7676-44f4-a985-eee98dfd1b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b50147e90>]}
[0m13:12:22.762363 [error] [MainThread]: Encountered an error:

[0m13:12:22.795323 [error] [MainThread]: Traceback (most recent call last):
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:12:22.815444 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 561.14154, "process_in_blocks": "37856", "process_kernel_time": 0.199594, "process_mem_max_rss": "107716", "process_out_blocks": "3360", "process_user_time": 2.390072}
[0m13:12:22.818986 [debug] [MainThread]: Command `dbt docs serve` failed at 13:12:22.818661 after 561.15 seconds
[0m13:12:22.823931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b512bcfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b4fd62900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b5015b2c0>]}
[0m13:12:22.825937 [debug] [MainThread]: Flushing usage events
[0m13:12:23.831334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:32.759906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a80cd4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a80b497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a807395e0>]}


============================== 13:12:32.766330 | 8f921f87-14a1-411d-81d4-e7bd252b6206 ==============================
[0m13:12:32.766330 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:12:32.767594 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'no_print': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:12:33.035778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f921f87-14a1-411d-81d4-e7bd252b6206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7ff15d00>]}
[0m13:12:33.126751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f921f87-14a1-411d-81d4-e7bd252b6206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7fecff20>]}
[0m13:12:33.128233 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:12:33.283265 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:12:33.501637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:12:33.503837 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/sources.yml
[0m13:12:34.130156 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_messages' in
package 'medical_warehouse' (models/sources.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m13:12:34.130938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8f921f87-14a1-411d-81d4-e7bd252b6206', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7df2cb30>]}
[0m13:12:34.173214 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m13:12:34.174205 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:12:34.175433 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 1.5085763, "process_in_blocks": "21320", "process_kernel_time": 0.272659, "process_mem_max_rss": "119432", "process_out_blocks": "8", "process_user_time": 3.248026}
[0m13:12:34.176252 [debug] [MainThread]: Command `dbt docs generate` failed at 13:12:34.176125 after 1.51 seconds
[0m13:12:34.176990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a80a5ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7e75c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7e340710>]}
[0m13:12:34.177663 [debug] [MainThread]: Flushing usage events
[0m13:12:35.030050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:59.848882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d6d21c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d6eff680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d4176f00>]}


============================== 13:12:59.853105 | a9bc1ddf-954b-4de7-9df9-73b342986031 ==============================
[0m13:12:59.853105 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:12:59.854422 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs generate', 'debug': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'version_check': 'True', 'empty': 'None', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'False'}
[0m13:13:00.085377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9bc1ddf-954b-4de7-9df9-73b342986031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d4ff1130>]}
[0m13:13:00.184179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9bc1ddf-954b-4de7-9df9-73b342986031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d659ddf0>]}
[0m13:13:00.185361 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:13:00.329885 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:13:00.471671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:00.473109 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/sources.yml
[0m13:13:01.115658 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_messages' in
package 'medical_warehouse' (models/sources.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m13:13:01.116435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9bc1ddf-954b-4de7-9df9-73b342986031', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d27e4e30>]}
[0m13:13:01.175843 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m13:13:01.176895 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:13:01.178293 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 1.4127607, "process_in_blocks": "0", "process_kernel_time": 0.236956, "process_mem_max_rss": "119456", "process_out_blocks": "16", "process_user_time": 3.231409}
[0m13:13:01.179499 [debug] [MainThread]: Command `dbt docs generate` failed at 13:13:01.179291 after 1.41 seconds
[0m13:13:01.180183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d41ff1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d27e49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d373a000>]}
[0m13:13:01.180864 [debug] [MainThread]: Flushing usage events
[0m13:13:01.998205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:04.466411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb13bc1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb1410cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb13d5dbe0>]}


============================== 13:13:04.470744 | 4d3aab00-413a-46aa-a305-ad452d989311 ==============================
[0m13:13:04.470744 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:13:04.471965 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'debug': 'False', 'invocation_command': 'dbt docs serve', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:13:04.734443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d3aab00-413a-46aa-a305-ad452d989311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb130afe00>]}
[0m13:13:04.834886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d3aab00-413a-46aa-a305-ad452d989311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb13fea000>]}
[0m13:16:52.681542 [error] [MainThread]: Encountered an error:

[0m13:16:52.706664 [error] [MainThread]: Traceback (most recent call last):
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:16:52.724598 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 228.3388, "process_in_blocks": "41160", "process_kernel_time": 0.192364, "process_mem_max_rss": "107972", "process_out_blocks": "3360", "process_user_time": 2.309377}
[0m13:16:52.726227 [debug] [MainThread]: Command `dbt docs serve` failed at 13:16:52.725951 after 228.34 seconds
[0m13:16:52.727812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb1410cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb130f42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb13abe1b0>]}
[0m13:16:52.728900 [debug] [MainThread]: Flushing usage events
[0m13:17:32.798613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ec79dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ece6d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ed1a0350>]}


============================== 13:17:32.806621 | 9d726aae-e935-4804-a088-7ccb9c4ec20e ==============================
[0m13:17:32.806621 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:17:32.808056 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'use_experimental_parser': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'False', 'target_path': 'None'}
[0m13:17:33.140893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ebe3a750>]}
[0m13:17:33.235968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ec0c3020>]}
[0m13:17:33.237386 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:17:33.434229 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:17:33.645586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:17:33.646727 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models/schema.yml
[0m13:17:33.905137 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_messages' in
package 'medical_warehouse' (models/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m13:17:33.905919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ea19b7d0>]}
[0m13:17:34.219119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e9d50d10>]}
[0m13:17:34.414100 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:17:34.420061 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:17:34.454054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e9d89f70>]}
[0m13:17:34.454881 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 464 macros
[0m13:17:34.455552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ea5a1a90>]}
[0m13:17:34.458538 [info ] [MainThread]: 
[0m13:17:34.459313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:17:34.459995 [info ] [MainThread]: 
[0m13:17:34.461342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:17:34.470554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m13:17:34.593980 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m13:17:34.594804 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m13:17:34.595474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:36.559150 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.964 seconds
[0m13:17:36.561679 [debug] [ThreadPool]: On list_neondb: Close
[0m13:17:36.565082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m13:17:36.574816 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m13:17:36.575498 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:17:36.576071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:38.113354 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.537 seconds
[0m13:17:38.115499 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m13:17:38.288941 [debug] [ThreadPool]: On list_neondb_public: Close
[0m13:17:38.296352 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:38.297077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:17:38.297623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:39.799238 [debug] [MainThread]: SQL status: SELECT 1 in 1.502 seconds
[0m13:17:39.801860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e8c1f680>]}
[0m13:17:39.803078 [debug] [MainThread]: On master: ROLLBACK
[0m13:17:39.976201 [debug] [MainThread]: On master: COMMIT
[0m13:17:39.976985 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:39.977549 [debug] [MainThread]: On master: COMMIT
[0m13:17:40.332740 [debug] [MainThread]: SQL status: COMMIT in 0.354 seconds
[0m13:17:40.333588 [debug] [MainThread]: On master: Close
[0m13:17:40.382795 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m13:17:40.383568 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m13:17:40.384508 [info ] [Thread-1 (]: 1 of 4 START sql table model public.dim_dates .................................. [RUN]
[0m13:17:40.385458 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m13:17:40.386291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m13:17:40.387662 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m13:17:40.388486 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m13:17:40.389363 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m13:17:40.399899 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m13:17:40.408801 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m13:17:40.412156 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m13:17:40.413149 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m13:17:40.532207 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m13:17:40.541610 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m13:17:40.543838 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:40.544558 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:40.545329 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- Generate date dimension for last 2 years
with dates as (
    select generate_series(
        current_date - interval '2 years',
        current_date + interval '1 year',
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    to_char(full_date, 'Day') as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    to_char(full_date, 'Month') as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from dates
  );
  
[0m13:17:40.546352 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m13:17:40.547240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:40.548086 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:17:42.048317 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.500 seconds
[0m13:17:42.183410 [debug] [Thread-1 (]: SQL status: SELECT 1097 in 1.636 seconds
[0m13:17:42.188956 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:42.198132 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:42.198907 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m13:17:42.199579 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m13:17:42.376243 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m13:17:42.381023 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:42.381614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.181 seconds
[0m13:17:42.382355 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m13:17:42.387074 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:42.388231 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m13:17:42.567497 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.179 seconds
[0m13:17:42.582202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.193 seconds
[0m13:17:42.601720 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m13:17:42.604525 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m13:17:42.605507 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:42.606384 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:42.607473 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m13:17:42.608455 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m13:17:42.779870 [debug] [Thread-2 (]: SQL status: COMMIT in 0.170 seconds
[0m13:17:42.790665 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m13:17:42.798025 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:42.798757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.189 seconds
[0m13:17:42.799346 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m13:17:42.803179 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m13:17:42.808488 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:42.809172 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m13:17:42.982057 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.178 seconds
[0m13:17:42.987120 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m13:17:42.991505 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.182 seconds
[0m13:17:42.993586 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m13:17:42.995728 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ee9ef680>]}
[0m13:17:42.996425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e9d53080>]}
[0m13:17:42.997467 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 2.60s]
[0m13:17:42.998533 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.dim_dates ............................. [[32mSELECT 1097[0m in 2.61s]
[0m13:17:42.999496 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m13:17:43.000283 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m13:17:43.001376 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m13:17:43.002168 [debug] [Thread-4 (]: Began running node model.medical_warehouse.fct_messages
[0m13:17:43.003408 [info ] [Thread-1 (]: 3 of 4 START sql table model public.dim_channels ............................... [RUN]
[0m13:17:43.005177 [info ] [Thread-4 (]: 4 of 4 START sql table model public.fct_messages ............................... [RUN]
[0m13:17:43.007773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.dim_channels)
[0m13:17:43.009353 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m13:17:43.010367 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m13:17:43.011582 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.fct_messages
[0m13:17:43.018179 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m13:17:43.024792 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m13:17:43.028132 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m13:17:43.029680 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.fct_messages
[0m13:17:43.039644 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m13:17:43.048809 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:43.050015 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m13:17:43.059072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:43.056660 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m13:17:43.063486 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:43.066509 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m13:17:43.067787 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:17:44.532288 [debug] [Thread-4 (]: SQL status: SELECT 276 in 1.464 seconds
[0m13:17:44.538560 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:44.539478 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages" rename to "fct_messages__dbt_backup"
[0m13:17:44.714575 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.174 seconds
[0m13:17:44.722195 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:44.723345 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m13:17:44.741771 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.683 seconds
[0m13:17:44.749385 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:44.750502 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m13:17:44.900023 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m13:17:44.903505 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m13:17:44.904437 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:44.905189 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m13:17:44.936928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.185 seconds
[0m13:17:44.944336 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:44.945623 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m13:17:45.096307 [debug] [Thread-4 (]: SQL status: COMMIT in 0.190 seconds
[0m13:17:45.099668 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."fct_messages__dbt_backup"
[0m13:17:45.100985 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:45.101675 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "neondb"."public"."fct_messages__dbt_backup" cascade
[0m13:17:45.129225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.183 seconds
[0m13:17:45.134711 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m13:17:45.135538 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:45.136269 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m13:17:45.316532 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.214 seconds
[0m13:17:45.320279 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: Close
[0m13:17:45.322050 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e8b76510>]}
[0m13:17:45.323562 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.fct_messages .......................... [[32mSELECT 276[0m in 2.31s]
[0m13:17:45.325376 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.fct_messages
[0m13:17:45.354773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.218 seconds
[0m13:17:45.359318 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m13:17:45.361354 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:45.362472 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m13:17:45.541435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.177 seconds
[0m13:17:45.543560 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: Close
[0m13:17:45.544884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e8b39550>]}
[0m13:17:45.545902 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 2.54s]
[0m13:17:45.546866 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m13:17:45.548675 [debug] [MainThread]: On master: COMMIT
[0m13:17:45.549357 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:45.549946 [debug] [MainThread]: On master: COMMIT
[0m13:17:45.550448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:17:46.990758 [debug] [MainThread]: SQL status: COMMIT in 1.440 seconds
[0m13:17:46.991535 [debug] [MainThread]: On master: Close
[0m13:17:46.994764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:46.995478 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m13:17:46.996285 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m13:17:46.996851 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m13:17:46.997516 [info ] [MainThread]: 
[0m13:17:46.998195 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m13:17:46.999840 [debug] [MainThread]: Command end result
[0m13:17:47.049192 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:17:47.096557 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:17:47.106564 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m13:17:47.107335 [info ] [MainThread]: 
[0m13:17:47.108210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:17:47.108843 [info ] [MainThread]: 
[0m13:17:47.109514 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:17:47.110460 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:17:47.113000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.433573, "process_in_blocks": "136154", "process_kernel_time": 0.487372, "process_mem_max_rss": "127268", "process_out_blocks": "3040", "process_user_time": 4.379402}
[0m13:17:47.114217 [debug] [MainThread]: Command `dbt run` succeeded at 13:17:47.113966 after 14.44 seconds
[0m13:17:47.115022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ec84cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ec84d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ea5c5e50>]}
[0m13:17:47.115817 [debug] [MainThread]: Flushing usage events
[0m13:17:48.481145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:00.516436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e331ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e344f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e12a6de0>]}


============================== 13:18:00.522945 | 3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21 ==============================
[0m13:18:00.522945 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:18:00.524343 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt docs generate', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True'}
[0m13:18:00.866488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e066f9e0>]}
[0m13:18:00.970543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e0b4b2c0>]}
[0m13:18:00.972023 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:18:01.142970 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:18:01.377985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:01.378616 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:18:01.379102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:01.449275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10dfd62a80>]}
[0m13:18:01.482269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10df50ed80>]}
[0m13:18:01.483491 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 464 macros
[0m13:18:01.484433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10dfd60590>]}
[0m13:18:01.489192 [info ] [MainThread]: 
[0m13:18:01.490228 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:18:01.491299 [info ] [MainThread]: 
[0m13:18:01.492862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:18:01.503012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public'
[0m13:18:01.613474 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m13:18:01.614355 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:18:01.615019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:03.050179 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.435 seconds
[0m13:18:03.053037 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m13:18:03.225213 [debug] [ThreadPool]: On list_neondb_public: Close
[0m13:18:03.234328 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:03.235186 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:18:03.235864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:04.927680 [debug] [MainThread]: SQL status: SELECT 1 in 1.692 seconds
[0m13:18:04.930765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e07388f0>]}
[0m13:18:04.931996 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:05.115379 [debug] [MainThread]: On master: Close
[0m13:18:05.121482 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m13:18:05.122139 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m13:18:05.122871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m13:18:05.123691 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m13:18:05.124307 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m13:18:05.124873 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m13:18:05.133922 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m13:18:05.137794 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m13:18:05.138972 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m13:18:05.139771 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m13:18:05.140841 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m13:18:05.141745 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m13:18:05.143001 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m13:18:05.143658 [debug] [Thread-4 (]: Began running node model.medical_warehouse.fct_messages
[0m13:18:05.144475 [debug] [Thread-3 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m13:18:05.145303 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m13:18:05.146103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.dim_channels)
[0m13:18:05.147359 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m13:18:05.148266 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.assert_no_future_messages'
[0m13:18:05.149043 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m13:18:05.150103 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m13:18:05.151249 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.fct_messages
[0m13:18:05.152002 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m13:18:05.152742 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m13:18:05.156369 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m13:18:05.159951 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m13:18:05.163608 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m13:18:05.179596 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m13:18:05.180880 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m13:18:05.182270 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.fct_messages
[0m13:18:05.183435 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m13:18:05.185000 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m13:18:05.186051 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.fct_messages
[0m13:18:05.187045 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m13:18:05.187764 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m13:18:05.188344 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m13:18:05.189177 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m13:18:05.190237 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m13:18:05.191083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1)
[0m13:18:05.192180 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m13:18:05.193069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fct_messages, now test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348)
[0m13:18:05.193691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d)
[0m13:18:05.194483 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m13:18:05.195238 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m13:18:05.195994 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m13:18:05.196560 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m13:18:05.207806 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m13:18:05.208562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0)
[0m13:18:05.213917 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m13:18:05.221893 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m13:18:05.223035 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m13:18:05.223721 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m13:18:05.230953 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m13:18:05.231657 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m13:18:05.233018 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m13:18:05.233820 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m13:18:05.235840 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m13:18:05.237102 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m13:18:05.237874 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m13:18:05.238992 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m13:18:05.240106 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m13:18:05.240870 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m13:18:05.241600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1, now test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56)
[0m13:18:05.242457 [debug] [Thread-3 (]: Began running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m13:18:05.243411 [debug] [Thread-2 (]: Began running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m13:18:05.244282 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348, now test.medical_warehouse.not_null_fct_messages_message_id.de346706b5)
[0m13:18:05.245072 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m13:18:05.246020 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d, now test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a)
[0m13:18:05.246823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0, now test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32)
[0m13:18:05.247523 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m13:18:05.254631 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m13:18:05.255432 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m13:18:05.256226 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m13:18:05.262582 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m13:18:05.263950 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m13:18:05.277975 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m13:18:05.287569 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m13:18:05.289244 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m13:18:05.290108 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m13:18:05.291059 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m13:18:05.291654 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m13:18:05.292430 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m13:18:05.293631 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m13:18:05.294517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56, now test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d)
[0m13:18:05.295621 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m13:18:05.296816 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m13:18:05.297848 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m13:18:05.305403 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m13:18:05.307123 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m13:18:05.308221 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m13:18:05.309792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:05.310467 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d' was properly closed.
[0m13:18:05.311133 [debug] [MainThread]: Connection 'test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32' was properly closed.
[0m13:18:05.311638 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_fct_messages_message_id.de346706b5' was properly closed.
[0m13:18:05.312143 [debug] [MainThread]: Connection 'test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a' was properly closed.
[0m13:18:05.315885 [debug] [MainThread]: Command end result
[0m13:18:05.475734 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:18:05.481864 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:18:05.492264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m13:18:05.501219 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:18:05.501985 [info ] [MainThread]: Building catalog
[0m13:18:05.515127 [debug] [ThreadPool]: Acquiring new postgres connection 'neondb.information_schema'
[0m13:18:05.530380 [debug] [ThreadPool]: Using postgres connection "neondb.information_schema"
[0m13:18:05.531722 [debug] [ThreadPool]: On neondb.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "neondb.information_schema"} */

    
    

    select
        'neondb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_dates')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_telegram_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:18:05.532893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:07.204047 [debug] [ThreadPool]: SQL status: SELECT 41 in 1.671 seconds
[0m13:18:07.210114 [debug] [ThreadPool]: On neondb.information_schema: ROLLBACK
[0m13:18:07.389277 [debug] [ThreadPool]: On neondb.information_schema: Close
[0m13:18:07.404968 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m13:18:07.431348 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:18:07.437013 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:18:07.437675 [info ] [MainThread]: Catalog written to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m13:18:07.439476 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.063155, "process_in_blocks": "61792", "process_kernel_time": 0.444885, "process_mem_max_rss": "124992", "process_out_blocks": "5560", "process_user_time": 3.929327}
[0m13:18:07.440320 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:18:07.440173 after 7.06 seconds
[0m13:18:07.440913 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:18:07.441401 [debug] [MainThread]: Connection 'neondb.information_schema' was properly closed.
[0m13:18:07.442036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e16809b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e0f80950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e0f81a00>]}
[0m13:18:07.442744 [debug] [MainThread]: Flushing usage events
[0m13:18:08.344001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:14.100107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8ceed20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8d0c475c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8ce9fd160>]}


============================== 13:18:14.106417 | 9c5e49e3-0f18-4d36-beb4-7537a06f5067 ==============================
[0m13:18:14.106417 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:18:14.107673 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'debug': 'False', 'empty': 'None', 'target_path': 'None', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt docs serve', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'warn_error': 'None', 'introspect': 'True'}
[0m13:18:14.377563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c5e49e3-0f18-4d36-beb4-7537a06f5067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8ce010c20>]}
[0m13:18:14.474276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c5e49e3-0f18-4d36-beb4-7537a06f5067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8ce82d700>]}
[0m13:31:37.635051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba31250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0ebb35850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba15790>]}


============================== 13:31:37.642790 | c0d6725f-056f-4c7c-b2d0-280dbb94348f ==============================
[0m13:31:37.642790 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:31:37.644059 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'use_colors': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True'}
[0m13:31:37.657055 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m13:31:37.659271 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.19986153, "process_in_blocks": "103344", "process_kernel_time": 0.449726, "process_mem_max_rss": "123016", "process_out_blocks": "8", "process_user_time": 4.590582}
[0m13:31:37.660484 [debug] [MainThread]: Command `dbt docs serve` failed at 13:31:37.660307 after 0.20 seconds
[0m13:31:37.661334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba15fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba15390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba0b310>]}
[0m13:31:37.662247 [debug] [MainThread]: Flushing usage events
[0m13:31:38.623510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:44.192150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bfa00b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bfa012d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bf9dbd50>]}


============================== 13:33:44.196066 | 97db6748-731e-423b-97b7-c684a50d1ab2 ==============================
[0m13:33:44.196066 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:33:44.197280 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True'}
[0m13:33:44.208924 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m13:33:44.211300 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.15401903, "process_in_blocks": "256", "process_kernel_time": 0.271286, "process_mem_max_rss": "123204", "process_out_blocks": "8", "process_user_time": 3.507769}
[0m13:33:44.212564 [debug] [MainThread]: Command `dbt docs serve` failed at 13:33:44.212326 after 0.16 seconds
[0m13:33:44.213455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bfa5c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bfa5e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bf9d95d0>]}
[0m13:33:44.214406 [debug] [MainThread]: Flushing usage events
[0m13:33:45.225000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:33.926931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f6634650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f67b3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f649bf10>]}


============================== 13:34:33.937499 | b3d4a9cf-5ed4-4a95-a5d5-ec950c3e0dcd ==============================
[0m13:34:33.937499 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:34:33.939154 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m13:34:33.991023 [info ] [MainThread]: dbt version: 1.11.2
[0m13:34:33.993154 [info ] [MainThread]: python version: 3.11.14
[0m13:34:33.994270 [info ] [MainThread]: python path: /usr/bin/python3.11
[0m13:34:33.995298 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m13:34:34.026152 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m13:34:34.028535 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.32322937, "process_in_blocks": "864", "process_kernel_time": 0.354009, "process_mem_max_rss": "123660", "process_out_blocks": "16", "process_user_time": 4.597164}
[0m13:34:34.031727 [debug] [MainThread]: Command `dbt debug` failed at 13:34:34.029833 after 0.33 seconds
[0m13:34:34.033279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f64bba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f64bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319fbb3b550>]}
[0m13:34:34.034608 [debug] [MainThread]: Flushing usage events
[0m13:34:34.967769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:48.024814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77875281cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778752693f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778752690650>]}


============================== 13:36:48.028557 | a16fb5b8-c5ba-47c7-9022-b349ad41475b ==============================
[0m13:36:48.028557 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:36:48.029675 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'partial_parse': 'True', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'target_path': 'None', 'version_check': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug'}
[0m13:36:48.040657 [info ] [MainThread]: dbt version: 1.11.2
[0m13:36:48.041368 [info ] [MainThread]: python version: 3.11.14
[0m13:36:48.042021 [info ] [MainThread]: python path: /usr/bin/python3.11
[0m13:36:48.042724 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m13:36:48.055611 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m13:36:48.057468 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12418421, "process_in_blocks": "0", "process_kernel_time": 0.284369, "process_mem_max_rss": "123664", "process_out_blocks": "8", "process_user_time": 3.570089}
[0m13:36:48.058907 [debug] [MainThread]: Command `dbt debug` failed at 13:36:48.058619 after 0.13 seconds
[0m13:36:48.060449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778752692bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778757d26c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778757d26a10>]}
[0m13:36:48.061829 [debug] [MainThread]: Flushing usage events
[0m13:36:49.023579 [debug] [MainThread]: An error was encountered while trying to flush usage events
