[0m12:15:44.704518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724741ab2a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724741684980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7247410723f0>]}


============================== 12:15:44.711203 | 26207949-4888-419c-be87-590fe35c18c6 ==============================
[0m12:15:44.711203 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:15:44.712202 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'invocation_command': 'dbt debug', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'target_path': 'None', 'write_json': 'True'}
[0m12:15:44.737233 [info ] [MainThread]: dbt version: 1.11.2
[0m12:15:44.738421 [info ] [MainThread]: python version: 3.12.3
[0m12:15:44.739510 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:15:44.740907 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:15:44.755057 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:15:44.760695 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1420297, "process_in_blocks": "107664", "process_kernel_time": 0.271495, "process_mem_max_rss": "98960", "process_out_blocks": "16", "process_user_time": 2.052748}
[0m12:15:44.763276 [debug] [MainThread]: Command `dbt debug` failed at 12:15:44.761962 after 0.14 seconds
[0m12:15:44.765671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724741964a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724740c70bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7247411920c0>]}
[0m12:15:44.767097 [debug] [MainThread]: Flushing usage events
[0m12:15:45.745168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:51.800952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265feaa0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265ff999550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265fef4b320>]}


============================== 12:17:51.810525 | d4ed91cd-40f8-4f77-a647-ded623a41322 ==============================
[0m12:17:51.810525 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:17:51.811927 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'target_path': 'None'}
[0m12:17:51.842740 [info ] [MainThread]: dbt version: 1.11.2
[0m12:17:51.843542 [info ] [MainThread]: python version: 3.12.3
[0m12:17:51.844251 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:17:51.845111 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:17:51.854637 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:17:51.858129 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.16273409, "process_in_blocks": "130786", "process_kernel_time": 0.320149, "process_mem_max_rss": "91880", "process_out_blocks": "16", "process_user_time": 2.32033}
[0m12:17:51.859146 [debug] [MainThread]: Command `dbt debug` failed at 12:17:51.858945 after 0.16 seconds
[0m12:17:51.859886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265fdd59010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265fdd07470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7265fe11fd40>]}
[0m12:17:51.861231 [debug] [MainThread]: Flushing usage events
[0m12:17:52.945829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:56.029310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a966b3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a98453800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a97792b70>]}


============================== 12:18:56.047840 | f5db1b40-3d39-4c73-8bda-1c9b580e4407 ==============================
[0m12:18:56.047840 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:18:56.049038 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'empty': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt debug', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False'}
[0m12:18:56.119590 [info ] [MainThread]: dbt version: 1.11.2
[0m12:18:56.120776 [info ] [MainThread]: python version: 3.12.3
[0m12:18:56.122477 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:18:56.123361 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:18:56.299695 [info ] [MainThread]: Using profiles dir at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse
[0m12:18:56.301087 [info ] [MainThread]: Using profiles.yml file at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/profiles.yml
[0m12:18:56.302156 [info ] [MainThread]: Using dbt_project.yml file at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/dbt_project.yml
[0m12:18:56.304199 [info ] [MainThread]: adapter type: postgres
[0m12:18:56.305345 [info ] [MainThread]: adapter version: 1.10.0
[0m12:18:56.558238 [info ] [MainThread]: Configuration:
[0m12:18:56.560060 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:18:56.560881 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:18:56.561977 [info ] [MainThread]: Required dependencies:
[0m12:18:56.564386 [debug] [MainThread]: Executing "git --help"
[0m12:18:56.658379 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:18:56.659628 [debug] [MainThread]: STDERR: "b''"
[0m12:18:56.660380 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:18:56.661164 [info ] [MainThread]: Connection:
[0m12:18:56.662145 [info ] [MainThread]:   host: ep-young-brook-ah5jgfxg-pooler.c-3.us-east-1.aws.neon.tech
[0m12:18:56.663119 [info ] [MainThread]:   port: 5432
[0m12:18:56.664016 [info ] [MainThread]:   user: neondb_owner
[0m12:18:56.664792 [info ] [MainThread]:   database: neondb
[0m12:18:56.665605 [info ] [MainThread]:   schema: public
[0m12:18:56.666612 [info ] [MainThread]:   connect_timeout: 10
[0m12:18:56.667915 [info ] [MainThread]:   role: None
[0m12:18:56.668892 [info ] [MainThread]:   search_path: None
[0m12:18:56.669819 [info ] [MainThread]:   keepalives_idle: 0
[0m12:18:56.670780 [info ] [MainThread]:   sslmode: None
[0m12:18:56.671532 [info ] [MainThread]:   sslcert: None
[0m12:18:56.672424 [info ] [MainThread]:   sslkey: None
[0m12:18:56.673263 [info ] [MainThread]:   sslrootcert: None
[0m12:18:56.673985 [info ] [MainThread]:   application_name: dbt
[0m12:18:56.674658 [info ] [MainThread]:   retries: 1
[0m12:18:56.678492 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:18:57.089026 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:18:57.161331 [debug] [MainThread]: Using postgres connection "debug"
[0m12:18:57.162313 [debug] [MainThread]: On debug: select 1 as id
[0m12:18:57.163127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:59.724222 [debug] [MainThread]: SQL status: SELECT 1 in 2.550 seconds
[0m12:18:59.755071 [debug] [MainThread]: On debug: Close
[0m12:18:59.778807 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:18:59.782204 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:18:59.817546 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.9344578, "process_in_blocks": "251302", "process_kernel_time": 0.526594, "process_mem_max_rss": "99824", "process_out_blocks": "72", "process_user_time": 3.080779}
[0m12:18:59.823533 [debug] [MainThread]: Command `dbt debug` succeeded at 12:18:59.821256 after 3.94 seconds
[0m12:18:59.827482 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:18:59.831648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a99bb7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a94d4a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a957fb8c0>]}
[0m12:18:59.835319 [debug] [MainThread]: Flushing usage events
[0m12:19:01.507043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:20.061126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae904c32fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae90425e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae903fb7bc0>]}


============================== 12:19:20.073495 | e7886ff8-ad2e-421b-83da-a3841a7b2840 ==============================
[0m12:19:20.073495 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:19:20.074888 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'empty': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80'}
[0m12:19:20.111562 [info ] [MainThread]: dbt version: 1.11.2
[0m12:19:20.112679 [info ] [MainThread]: python version: 3.12.3
[0m12:19:20.113597 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:19:20.114520 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:19:20.124977 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:19:20.127731 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.20539492, "process_in_blocks": "149376", "process_kernel_time": 0.353052, "process_mem_max_rss": "90072", "process_out_blocks": "8", "process_user_time": 2.511374}
[0m12:19:20.128729 [debug] [MainThread]: Command `dbt debug` failed at 12:19:20.128543 after 0.21 seconds
[0m12:19:20.129427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae904970500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae903cd3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae903b22f00>]}
[0m12:19:20.130828 [debug] [MainThread]: Flushing usage events
[0m12:19:21.134274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:26.132896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384e34bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384e3813a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384dfba7b0>]}


============================== 12:20:26.139129 | 80459f75-8d64-42a9-a723-504e5a083893 ==============================
[0m12:20:26.139129 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:20:26.140128 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'empty': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'use_experimental_parser': 'False', 'indirect_selection': 'eager'}
[0m12:20:26.166935 [info ] [MainThread]: dbt version: 1.11.2
[0m12:20:26.168154 [info ] [MainThread]: python version: 3.12.3
[0m12:20:26.169169 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:20:26.170183 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:20:26.179999 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:20:26.182557 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12919685, "process_in_blocks": "96104", "process_kernel_time": 0.245682, "process_mem_max_rss": "99696", "process_out_blocks": "8", "process_user_time": 2.002408}
[0m12:20:26.183998 [debug] [MainThread]: Command `dbt debug` failed at 12:20:26.183775 after 0.13 seconds
[0m12:20:26.185190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384dcc1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384cfe9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74384d17a660>]}
[0m12:20:26.186634 [debug] [MainThread]: Flushing usage events
[0m12:20:27.428753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:59.661717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb0e45580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb0c9e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb0e20c80>]}


============================== 12:21:59.668880 | 1aeacb8c-f3d8-49e4-9bf5-d709e19457f2 ==============================
[0m12:21:59.668880 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:21:59.670034 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False'}
[0m12:21:59.696079 [info ] [MainThread]: dbt version: 1.11.2
[0m12:21:59.697049 [info ] [MainThread]: python version: 3.12.3
[0m12:21:59.698138 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:21:59.699073 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:21:59.708574 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m12:21:59.712353 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13688487, "process_in_blocks": "53808", "process_kernel_time": 0.239784, "process_mem_max_rss": "100132", "process_out_blocks": "16", "process_user_time": 2.113289}
[0m12:21:59.714600 [debug] [MainThread]: Command `dbt debug` failed at 12:21:59.714385 after 0.14 seconds
[0m12:21:59.715556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb055fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb0497470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714eb039fd40>]}
[0m12:21:59.717203 [debug] [MainThread]: Flushing usage events
[0m12:22:00.720242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:12.676546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730847c6b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730847b01ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7308474f4b30>]}


============================== 12:24:12.685320 | 92cf703f-128b-4207-b413-eec05401c79d ==============================
[0m12:24:12.685320 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:24:12.686522 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'invocation_command': 'dbt debug', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs'}
[0m12:24:12.714937 [info ] [MainThread]: dbt version: 1.11.2
[0m12:24:12.718077 [info ] [MainThread]: python version: 3.12.3
[0m12:24:12.719029 [info ] [MainThread]: python path: /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/bin/python3
[0m12:24:12.719965 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m12:24:12.853431 [info ] [MainThread]: Using profiles dir at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse
[0m12:24:12.854129 [info ] [MainThread]: Using profiles.yml file at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/profiles.yml
[0m12:24:12.854913 [info ] [MainThread]: Using dbt_project.yml file at /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/dbt_project.yml
[0m12:24:12.856388 [info ] [MainThread]: adapter type: postgres
[0m12:24:12.857110 [info ] [MainThread]: adapter version: 1.10.0
[0m12:24:13.186082 [info ] [MainThread]: Configuration:
[0m12:24:13.186857 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:24:13.187560 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:24:13.188216 [info ] [MainThread]: Required dependencies:
[0m12:24:13.188970 [debug] [MainThread]: Executing "git --help"
[0m12:24:13.194681 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:24:13.196342 [debug] [MainThread]: STDERR: "b''"
[0m12:24:13.198129 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:24:13.199590 [info ] [MainThread]: Connection:
[0m12:24:13.200850 [info ] [MainThread]:   host: ep-young-brook-ah5jgfxg-pooler.c-3.us-east-1.aws.neon.tech
[0m12:24:13.205307 [info ] [MainThread]:   port: 5432
[0m12:24:13.206628 [info ] [MainThread]:   user: neondb_owner
[0m12:24:13.208816 [info ] [MainThread]:   database: neondb
[0m12:24:13.210210 [info ] [MainThread]:   schema: public
[0m12:24:13.211583 [info ] [MainThread]:   connect_timeout: 10
[0m12:24:13.213101 [info ] [MainThread]:   role: None
[0m12:24:13.214524 [info ] [MainThread]:   search_path: None
[0m12:24:13.216015 [info ] [MainThread]:   keepalives_idle: 0
[0m12:24:13.217425 [info ] [MainThread]:   sslmode: require
[0m12:24:13.218927 [info ] [MainThread]:   sslcert: None
[0m12:24:13.220455 [info ] [MainThread]:   sslkey: None
[0m12:24:13.221810 [info ] [MainThread]:   sslrootcert: None
[0m12:24:13.222838 [info ] [MainThread]:   application_name: dbt
[0m12:24:13.223572 [info ] [MainThread]:   retries: 1
[0m12:24:13.224593 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:24:13.479683 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:24:13.544421 [debug] [MainThread]: Using postgres connection "debug"
[0m12:24:13.545325 [debug] [MainThread]: On debug: select 1 as id
[0m12:24:13.546250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:16.628845 [debug] [MainThread]: SQL status: SELECT 1 in 3.083 seconds
[0m12:24:16.630372 [debug] [MainThread]: On debug: Close
[0m12:24:16.631152 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:24:16.631774 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:24:16.633454 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.0433774, "process_in_blocks": "107426", "process_kernel_time": 0.314338, "process_mem_max_rss": "116216", "process_out_blocks": "24", "process_user_time": 2.486041}
[0m12:24:16.634465 [debug] [MainThread]: Command `dbt debug` succeeded at 12:24:16.634225 after 4.04 seconds
[0m12:24:16.635765 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:24:16.637245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730848395c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7308479472c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7308474f4b30>]}
[0m12:24:16.638577 [debug] [MainThread]: Flushing usage events
[0m12:24:17.632238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:05.488526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abb144ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abaf2cbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abaeee2840>]}


============================== 12:26:05.494905 | 2e65e85d-2f13-4008-82bc-5200542c96a1 ==============================
[0m12:26:05.494905 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:26:05.495837 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False'}
[0m12:26:05.747372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e65e85d-2f13-4008-82bc-5200542c96a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abadf5fda0>]}
[0m12:26:05.838571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e65e85d-2f13-4008-82bc-5200542c96a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abaf332660>]}
[0m12:26:05.841473 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:26:06.069809 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:26:06.072446 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:26:06.073448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e65e85d-2f13-4008-82bc-5200542c96a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abadfa6ed0>]}
[0m12:26:07.646208 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m12:26:07.648161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2397048, "process_in_blocks": "55592", "process_kernel_time": 0.311105, "process_mem_max_rss": "115500", "process_out_blocks": "16", "process_user_time": 3.880262}
[0m12:26:07.649002 [debug] [MainThread]: Command `dbt run` failed at 12:26:07.648862 after 2.24 seconds
[0m12:26:07.649620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abaeee2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abad31ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70abacbe33b0>]}
[0m12:26:07.650240 [debug] [MainThread]: Flushing usage events
[0m12:26:08.692759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:46.504945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7b42ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec792a7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7a85fc20>]}


============================== 12:31:46.512024 | 8e254b02-cf7f-43c6-9d00-c5c3278b2887 ==============================
[0m12:31:46.512024 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:31:46.513606 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'empty': 'False', 'static_parser': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True'}
[0m12:31:46.785138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec787aa690>]}
[0m12:31:46.878135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec787831d0>]}
[0m12:31:46.879584 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:31:47.028461 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:31:47.030331 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:31:47.031061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7882ff80>]}
[0m12:31:48.712023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec77f5d7c0>]}
[0m12:31:48.826165 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m12:31:48.829692 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m12:31:48.858511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec77b6c440>]}
[0m12:31:48.859448 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m12:31:48.860174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7675e360>]}
[0m12:31:48.863066 [info ] [MainThread]: 
[0m12:31:48.863800 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:48.864417 [info ] [MainThread]: 
[0m12:31:48.865430 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:31:48.874124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m12:31:48.953270 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m12:31:48.953921 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m12:31:48.954544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:51.024144 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.070 seconds
[0m12:31:51.028340 [debug] [ThreadPool]: On list_neondb: Close
[0m12:31:51.030665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m12:31:51.038201 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m12:31:51.038899 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:31:51.039408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:52.766363 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.727 seconds
[0m12:31:52.768799 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m12:31:52.953264 [debug] [ThreadPool]: On list_neondb_public: Close
[0m12:31:52.960844 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:52.961527 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:31:52.962116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:54.421843 [debug] [MainThread]: SQL status: SELECT 0 in 1.460 seconds
[0m12:31:54.426270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec77b007d0>]}
[0m12:31:54.428823 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:54.601573 [debug] [MainThread]: On master: COMMIT
[0m12:31:54.602324 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:54.603079 [debug] [MainThread]: On master: COMMIT
[0m12:31:54.944068 [debug] [MainThread]: SQL status: COMMIT in 0.339 seconds
[0m12:31:54.945032 [debug] [MainThread]: On master: Close
[0m12:31:54.952232 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m12:31:54.953185 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m12:31:54.953981 [info ] [Thread-1 (]: 1 of 4 START sql table model public.dim_dates .................................. [RUN]
[0m12:31:54.954891 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m12:31:54.955779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m12:31:54.956606 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m12:31:54.957324 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m12:31:54.958122 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m12:31:54.968050 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m12:31:54.976122 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m12:31:54.977865 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m12:31:54.985151 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m12:31:55.086167 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m12:31:55.091051 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m12:31:55.092645 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:31:55.093389 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:31:55.094093 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m12:31:55.094919 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- Generate date dimension for last 2 years
with dates as (
    select generate_series(
        current_date - interval '2 years',
        current_date + interval '1 year',
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    to_char(full_date, 'Day') as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    to_char(full_date, 'Month') as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from dates
  );
  
[0m12:31:55.095648 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:31:55.096428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:56.550321 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.453 seconds
[0m12:31:56.558898 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:31:56.559646 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m12:31:56.583496 [debug] [Thread-1 (]: SQL status: SELECT 1097 in 1.487 seconds
[0m12:31:56.591694 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:31:56.592400 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:31:56.733345 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.173 seconds
[0m12:31:56.751374 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m12:31:56.752113 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:31:56.752723 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m12:31:56.769459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m12:31:56.771763 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m12:31:56.772551 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:31:56.773179 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m12:31:56.922172 [debug] [Thread-2 (]: SQL status: COMMIT in 0.169 seconds
[0m12:31:56.932525 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m12:31:56.939540 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:31:56.940301 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m12:31:56.947669 [debug] [Thread-1 (]: SQL status: COMMIT in 0.174 seconds
[0m12:31:56.951052 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m12:31:56.955053 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:31:56.955750 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m12:31:57.109468 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.168 seconds
[0m12:31:57.114010 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m12:31:57.135409 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.179 seconds
[0m12:31:57.137454 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m12:31:57.161312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7b32f6b0>]}
[0m12:31:57.162233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec74dbdb50>]}
[0m12:31:57.163360 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 2.16s]
[0m12:31:57.164549 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.dim_dates ............................. [[32mSELECT 1097[0m in 2.18s]
[0m12:31:57.165747 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m12:31:57.166654 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m12:31:57.167843 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_channels
[0m12:31:57.168568 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m12:31:57.169486 [info ] [Thread-4 (]: 3 of 4 START sql table model public.dim_channels ............................... [RUN]
[0m12:31:57.172099 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m12:31:57.170896 [info ] [Thread-1 (]: 4 of 4 START sql table model public.fct_messages ............................... [RUN]
[0m12:31:57.173059 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_channels
[0m12:31:57.173766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.fct_messages)
[0m12:31:57.178119 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m12:31:57.179060 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m12:31:57.183410 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m12:31:57.184290 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_channels
[0m12:31:57.190016 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m12:31:57.190749 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m12:31:57.199458 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m12:31:57.200613 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:31:57.202385 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m12:31:57.203377 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m12:31:57.204251 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:31:57.205040 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m12:31:57.206081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:58.610396 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column s.has_media does not exist
LINE 20:     s.has_media
             ^

[0m12:31:58.611453 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: ROLLBACK
[0m12:31:58.719175 [debug] [Thread-4 (]: SQL status: SELECT 3 in 1.515 seconds
[0m12:31:58.723991 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:31:58.724650 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m12:31:58.785395 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m12:31:58.794432 [debug] [Thread-1 (]: Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql
[0m12:31:58.796780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7442fad0>]}
[0m12:31:58.797835 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.fct_messages ...................... [[31mERROR[0m in 1.62s]
[0m12:31:58.798993 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m12:31:58.800135 [debug] [Thread-7 (]: Marking all children of 'model.medical_warehouse.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql.
[0m12:31:58.910477 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.185 seconds
[0m12:31:58.916781 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m12:31:58.917948 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:31:58.919006 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m12:31:59.107425 [debug] [Thread-4 (]: SQL status: COMMIT in 0.187 seconds
[0m12:31:59.112023 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m12:31:59.113562 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:31:59.114961 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m12:31:59.297111 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.181 seconds
[0m12:31:59.299319 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: Close
[0m12:31:59.300315 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e254b02-cf7f-43c6-9d00-c5c3278b2887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec744655e0>]}
[0m12:31:59.301238 [info ] [Thread-4 (]: 3 of 4 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 2.13s]
[0m12:31:59.303279 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_channels
[0m12:31:59.306075 [debug] [MainThread]: On master: COMMIT
[0m12:31:59.306764 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:59.307301 [debug] [MainThread]: On master: COMMIT
[0m12:31:59.307950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:32:00.758136 [debug] [MainThread]: SQL status: COMMIT in 1.450 seconds
[0m12:32:00.760440 [debug] [MainThread]: On master: Close
[0m12:32:00.763606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:00.765547 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m12:32:00.766297 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m12:32:00.766901 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m12:32:00.767586 [info ] [MainThread]: 
[0m12:32:00.768197 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 11.90 seconds (11.90s).
[0m12:32:00.769761 [debug] [MainThread]: Command end result
[0m12:32:00.806616 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m12:32:00.810122 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m12:32:00.821683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m12:32:00.822609 [info ] [MainThread]: 
[0m12:32:00.823555 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:32:00.824456 [info ] [MainThread]: 
[0m12:32:00.825467 [error] [MainThread]: [31mFailure in model fct_messages (models/marts/fct_messages.sql)[0m
[0m12:32:00.826488 [error] [MainThread]:   Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql
[0m12:32:00.827345 [info ] [MainThread]: 
[0m12:32:00.828356 [info ] [MainThread]:   compiled code at target/compiled/medical_warehouse/models/marts/fct_messages.sql
[0m12:32:00.829284 [info ] [MainThread]: 
[0m12:32:00.830469 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m12:32:00.833000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.428364, "process_in_blocks": "129920", "process_kernel_time": 0.405302, "process_mem_max_rss": "128164", "process_out_blocks": "2912", "process_user_time": 4.707509}
[0m12:32:00.834404 [debug] [MainThread]: Command `dbt run` failed at 12:32:00.834127 after 14.43 seconds
[0m12:32:00.835620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec7cee3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec78c90ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ec797e80e0>]}
[0m12:32:00.836931 [debug] [MainThread]: Flushing usage events
[0m12:32:01.954576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:04.764887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c72c7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c97578c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c79c7fe0>]}


============================== 12:54:04.773658 | 984135a1-ca97-4b06-906f-6999190e06bb ==============================
[0m12:54:04.773658 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:54:04.774812 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'use_experimental_parser': 'False', 'empty': 'False', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'static_parser': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m12:54:05.071255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c6b0fbc0>]}
[0m12:54:05.172268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c7266960>]}
[0m12:54:05.173996 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:54:05.332537 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:54:05.611804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:05.612498 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:54:05.613102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:05.674576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c59c9f10>]}
[0m12:54:05.779465 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m12:54:05.782341 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m12:54:05.817157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c51ca630>]}
[0m12:54:05.817948 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m12:54:05.818538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c55caae0>]}
[0m12:54:05.821149 [info ] [MainThread]: 
[0m12:54:05.821852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:05.822613 [info ] [MainThread]: 
[0m12:54:05.823764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:05.831989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m12:54:05.913157 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m12:54:05.913866 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m12:54:05.914433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:08.010476 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.096 seconds
[0m12:54:08.013133 [debug] [ThreadPool]: On list_neondb: Close
[0m12:54:08.015859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m12:54:08.023240 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m12:54:08.024157 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:54:08.024868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:10.011905 [debug] [ThreadPool]: SQL status: SELECT 3 in 1.987 seconds
[0m12:54:10.014456 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m12:54:10.315516 [debug] [ThreadPool]: On list_neondb_public: Close
[0m12:54:10.324864 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:10.326505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:54:10.327698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:15.071263 [debug] [MainThread]: SQL status: SELECT 1 in 4.743 seconds
[0m12:54:15.073692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c6a4c2c0>]}
[0m12:54:15.074913 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:15.330912 [debug] [MainThread]: On master: COMMIT
[0m12:54:15.333195 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:15.335415 [debug] [MainThread]: On master: COMMIT
[0m12:54:15.798029 [debug] [MainThread]: SQL status: COMMIT in 0.460 seconds
[0m12:54:15.799000 [debug] [MainThread]: On master: Close
[0m12:54:15.849788 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m12:54:15.850536 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m12:54:15.851519 [info ] [Thread-1 (]: 1 of 4 START sql table model public.dim_dates .................................. [RUN]
[0m12:54:15.852578 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m12:54:15.853445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m12:54:15.856535 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m12:54:15.857298 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m12:54:15.858227 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m12:54:15.880217 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m12:54:15.881555 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m12:54:15.883782 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m12:54:15.908545 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m12:54:15.972067 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m12:54:15.982285 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m12:54:15.986101 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:15.988651 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:15.990974 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m12:54:15.992293 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- Generate date dimension for last 2 years
with dates as (
    select generate_series(
        current_date - interval '2 years',
        current_date + interval '1 year',
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    to_char(full_date, 'Day') as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    to_char(full_date, 'Month') as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from dates
  );
  
[0m12:54:15.993724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:15.994604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:18.194522 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 2.201 seconds
[0m12:54:18.221860 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:18.223969 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m12:54:18.225516 [debug] [Thread-1 (]: SQL status: SELECT 1097 in 2.231 seconds
[0m12:54:18.243309 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:18.245507 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m12:54:18.511754 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.285 seconds
[0m12:54:18.512626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.266 seconds
[0m12:54:18.517517 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:18.524813 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:18.525608 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m12:54:18.526375 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:54:18.803368 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.276 seconds
[0m12:54:18.810119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.282 seconds
[0m12:54:18.851031 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m12:54:18.853388 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m12:54:18.855295 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:18.856863 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:18.857760 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m12:54:18.858725 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m12:54:19.118215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.259 seconds
[0m12:54:19.126473 [debug] [Thread-2 (]: SQL status: COMMIT in 0.267 seconds
[0m12:54:19.134306 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m12:54:19.144677 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m12:54:19.168235 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m12:54:19.173496 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m12:54:19.174478 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m12:54:19.175332 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m12:54:19.457830 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.281 seconds
[0m12:54:19.458911 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.283 seconds
[0m12:54:19.462795 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m12:54:19.464844 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m12:54:19.467944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c9557770>]}
[0m12:54:19.468766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c79c54c0>]}
[0m12:54:19.470252 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 3.61s]
[0m12:54:19.471975 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.dim_dates ............................. [[32mSELECT 1097[0m in 3.61s]
[0m12:54:19.473997 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m12:54:19.475313 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m12:54:19.477558 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m12:54:19.479140 [debug] [Thread-4 (]: Began running node model.medical_warehouse.fct_messages
[0m12:54:19.481556 [info ] [Thread-1 (]: 3 of 4 START sql table model public.dim_channels ............................... [RUN]
[0m12:54:19.483218 [info ] [Thread-4 (]: 4 of 4 START sql table model public.fct_messages ............................... [RUN]
[0m12:54:19.484321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.dim_channels)
[0m12:54:19.485688 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m12:54:19.487064 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m12:54:19.490097 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.fct_messages
[0m12:54:19.504252 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m12:54:19.505528 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m12:54:19.507660 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m12:54:19.514397 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.fct_messages
[0m12:54:19.521564 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m12:54:19.530585 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:19.532201 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m12:54:19.533371 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m12:54:19.538731 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m12:54:19.540357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:19.543356 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m12:54:19.546603 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:54:21.408339 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.868 seconds
[0m12:54:21.419008 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:21.420142 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m12:54:21.597227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m12:54:21.607078 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:21.608362 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m12:54:21.765723 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column s.has_media does not exist
LINE 20:     s.has_media
             ^

[0m12:54:21.766507 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: ROLLBACK
[0m12:54:21.781805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.171 seconds
[0m12:54:21.789372 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m12:54:21.790965 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:21.792140 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m12:54:21.969011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.175 seconds
[0m12:54:21.973813 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m12:54:21.975170 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m12:54:21.975750 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m12:54:22.025270 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: Close
[0m12:54:22.038619 [debug] [Thread-4 (]: Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql
[0m12:54:22.039642 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c5d658e0>]}
[0m12:54:22.040658 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model public.fct_messages ...................... [[31mERROR[0m in 2.55s]
[0m12:54:22.041751 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.fct_messages
[0m12:54:22.042577 [debug] [Thread-7 (]: Marking all children of 'model.medical_warehouse.fct_messages' to be skipped because of status 'error'.  Reason: Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql.
[0m12:54:22.151265 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.175 seconds
[0m12:54:22.160781 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: Close
[0m12:54:22.161918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984135a1-ca97-4b06-906f-6999190e06bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c516d340>]}
[0m12:54:22.162911 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 2.68s]
[0m12:54:22.164798 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m12:54:22.170368 [debug] [MainThread]: On master: COMMIT
[0m12:54:22.171106 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:22.171882 [debug] [MainThread]: On master: COMMIT
[0m12:54:22.172532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:24.277101 [debug] [MainThread]: SQL status: COMMIT in 2.105 seconds
[0m12:54:24.277976 [debug] [MainThread]: On master: Close
[0m12:54:24.279471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:24.281792 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m12:54:24.282758 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m12:54:24.283362 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m12:54:24.284146 [info ] [MainThread]: 
[0m12:54:24.284855 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 18.46 seconds (18.46s).
[0m12:54:24.286629 [debug] [MainThread]: Command end result
[0m12:54:24.336472 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m12:54:24.340691 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m12:54:24.353483 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m12:54:24.354416 [info ] [MainThread]: 
[0m12:54:24.355470 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:54:24.356686 [info ] [MainThread]: 
[0m12:54:24.357949 [error] [MainThread]: [31mFailure in model fct_messages (models/marts/fct_messages.sql)[0m
[0m12:54:24.359498 [error] [MainThread]:   Database Error in model fct_messages (models/marts/fct_messages.sql)
  column s.has_media does not exist
  LINE 20:     s.has_media
               ^
  compiled code at target/run/medical_warehouse/models/marts/fct_messages.sql
[0m12:54:24.360674 [info ] [MainThread]: 
[0m12:54:24.362144 [info ] [MainThread]:   compiled code at target/compiled/medical_warehouse/models/marts/fct_messages.sql
[0m12:54:24.363295 [info ] [MainThread]: 
[0m12:54:24.366212 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m12:54:24.369628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 19.715199, "process_in_blocks": "124048", "process_kernel_time": 0.421761, "process_mem_max_rss": "125716", "process_out_blocks": "1984", "process_user_time": 3.506079}
[0m12:54:24.371351 [debug] [MainThread]: Command `dbt run` failed at 12:54:24.370941 after 19.72 seconds
[0m12:54:24.372906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c97578c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c6b0fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab0c0886fc0>]}
[0m12:54:24.374442 [debug] [MainThread]: Flushing usage events
[0m12:54:25.690622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:09.902756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aadb1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aa6c6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230ad24f410>]}


============================== 13:02:09.909253 | 1fb4da35-f56d-48a3-a960-102fba477ba6 ==============================
[0m13:02:09.909253 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:02:09.911162 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'empty': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'quiet': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'no_print': 'None'}
[0m13:02:10.167847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aa2a3e90>]}
[0m13:02:10.256712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aad52a20>]}
[0m13:02:10.257884 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:02:10.397164 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:02:10.569474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:02:10.571167 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/staging/stg_telegram_messages.sql
[0m13:02:11.061935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a8ffd2e0>]}
[0m13:02:11.187477 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:02:11.191901 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:02:11.220381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a870adb0>]}
[0m13:02:11.221179 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m13:02:11.221804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a8fb4f80>]}
[0m13:02:11.224440 [info ] [MainThread]: 
[0m13:02:11.225138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:02:11.225731 [info ] [MainThread]: 
[0m13:02:11.226569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:02:11.233074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m13:02:11.295846 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m13:02:11.296968 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m13:02:11.298077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:12.870902 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.573 seconds
[0m13:02:12.873801 [debug] [ThreadPool]: On list_neondb: Close
[0m13:02:12.876118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m13:02:12.883762 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m13:02:12.884479 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:02:12.885069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:14.333216 [debug] [ThreadPool]: SQL status: SELECT 3 in 1.448 seconds
[0m13:02:14.335944 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m13:02:14.512238 [debug] [ThreadPool]: On list_neondb_public: Close
[0m13:02:14.519948 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:14.521027 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:02:14.521870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:16.100680 [debug] [MainThread]: SQL status: SELECT 1 in 1.579 seconds
[0m13:02:16.103032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a8becaa0>]}
[0m13:02:16.104020 [debug] [MainThread]: On master: ROLLBACK
[0m13:02:16.283971 [debug] [MainThread]: On master: COMMIT
[0m13:02:16.284764 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:16.285331 [debug] [MainThread]: On master: COMMIT
[0m13:02:16.650132 [debug] [MainThread]: SQL status: COMMIT in 0.364 seconds
[0m13:02:16.650880 [debug] [MainThread]: On master: Close
[0m13:02:16.677285 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m13:02:16.678429 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m13:02:16.679521 [info ] [Thread-1 (]: 1 of 4 START sql table model public.dim_dates .................................. [RUN]
[0m13:02:16.680740 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m13:02:16.681607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m13:02:16.682771 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m13:02:16.683613 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m13:02:16.684348 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m13:02:16.699074 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m13:02:16.700453 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m13:02:16.726349 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m13:02:16.734108 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m13:02:16.847961 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m13:02:16.860196 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m13:02:16.861376 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:16.862670 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m13:02:16.863797 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:02:16.864611 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:16.866042 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- Generate date dimension for last 2 years
with dates as (
    select generate_series(
        current_date - interval '2 years',
        current_date + interval '1 year',
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    to_char(full_date, 'Day') as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    to_char(full_date, 'Month') as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from dates
  );
  
[0m13:02:16.867221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:18.380315 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.516 seconds
[0m13:02:18.393344 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:18.394060 [debug] [Thread-1 (]: SQL status: SELECT 1097 in 1.527 seconds
[0m13:02:18.394839 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m13:02:18.403896 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:18.404694 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m13:02:18.577584 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.173 seconds
[0m13:02:18.582445 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:18.583116 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m13:02:18.586554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.181 seconds
[0m13:02:18.590802 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:18.591514 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m13:02:18.754497 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.171 seconds
[0m13:02:18.775533 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m13:02:18.776139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.183 seconds
[0m13:02:18.776777 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:18.779068 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m13:02:18.779652 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m13:02:18.780524 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:18.781407 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m13:02:18.962419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.180 seconds
[0m13:02:18.970892 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m13:02:18.983545 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:02:18.984968 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m13:02:19.001226 [debug] [Thread-2 (]: SQL status: COMMIT in 0.220 seconds
[0m13:02:19.009929 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m13:02:19.121935 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:02:19.122613 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m13:02:19.178825 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.193 seconds
[0m13:02:19.182820 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m13:02:19.185600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a93bbb60>]}
[0m13:02:19.186894 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.dim_dates ............................. [[32mSELECT 1097[0m in 2.50s]
[0m13:02:19.188091 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m13:02:19.297318 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.174 seconds
[0m13:02:19.300052 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m13:02:19.301234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230ab4d8ce0>]}
[0m13:02:19.302395 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 2.62s]
[0m13:02:19.303567 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m13:02:19.305785 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_channels
[0m13:02:19.306988 [info ] [Thread-4 (]: 3 of 4 START sql table model public.dim_channels ............................... [RUN]
[0m13:02:19.308573 [debug] [Thread-3 (]: Began running node model.medical_warehouse.fct_messages
[0m13:02:19.310314 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m13:02:19.312741 [info ] [Thread-3 (]: 4 of 4 START sql table model public.fct_messages ............................... [RUN]
[0m13:02:19.314486 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_channels
[0m13:02:19.317129 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m13:02:19.327302 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.fct_messages
[0m13:02:19.325890 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m13:02:19.342132 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_channels
[0m13:02:19.339722 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m13:02:19.361930 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.fct_messages
[0m13:02:19.358498 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m13:02:19.379329 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:19.380881 [debug] [Thread-3 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m13:02:19.381629 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m13:02:19.382830 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:02:19.384941 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:02:19.386198 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m13:02:19.387036 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:02:20.846435 [debug] [Thread-4 (]: SQL status: SELECT 3 in 1.464 seconds
[0m13:02:20.855407 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:20.856406 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m13:02:20.869691 [debug] [Thread-3 (]: SQL status: SELECT 276 in 1.483 seconds
[0m13:02:20.874585 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:02:20.875216 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m13:02:21.033679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m13:02:21.038647 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:21.039906 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m13:02:21.058846 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.183 seconds
[0m13:02:21.061674 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m13:02:21.062612 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:02:21.063367 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m13:02:21.217567 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.177 seconds
[0m13:02:21.220034 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m13:02:21.220615 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:21.221169 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m13:02:21.241265 [debug] [Thread-3 (]: SQL status: COMMIT in 0.177 seconds
[0m13:02:21.247200 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public"."fct_messages__dbt_backup"
[0m13:02:21.248831 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:02:21.249500 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "neondb"."public"."fct_messages__dbt_backup" cascade
[0m13:02:21.398694 [debug] [Thread-4 (]: SQL status: COMMIT in 0.177 seconds
[0m13:02:21.401798 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m13:02:21.402980 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:02:21.403544 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m13:02:21.428363 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.178 seconds
[0m13:02:21.431109 [debug] [Thread-3 (]: On model.medical_warehouse.fct_messages: Close
[0m13:02:21.432066 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230aa64c7a0>]}
[0m13:02:21.432989 [info ] [Thread-3 (]: 4 of 4 OK created sql table model public.fct_messages .......................... [[32mSELECT 276[0m in 2.12s]
[0m13:02:21.433958 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.fct_messages
[0m13:02:21.583493 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.179 seconds
[0m13:02:21.586197 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: Close
[0m13:02:21.587550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fb4da35-f56d-48a3-a960-102fba477ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a6ae7110>]}
[0m13:02:21.588543 [info ] [Thread-4 (]: 3 of 4 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 2.28s]
[0m13:02:21.590000 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_channels
[0m13:02:21.591872 [debug] [MainThread]: On master: COMMIT
[0m13:02:21.592550 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:21.593121 [debug] [MainThread]: On master: COMMIT
[0m13:02:21.593629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:02:23.051098 [debug] [MainThread]: SQL status: COMMIT in 1.457 seconds
[0m13:02:23.052739 [debug] [MainThread]: On master: Close
[0m13:02:23.054988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:23.056150 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_dates' was properly closed.
[0m13:02:23.057236 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m13:02:23.058104 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m13:02:23.059192 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m13:02:23.060646 [info ] [MainThread]: 
[0m13:02:23.061421 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 11.83 seconds (11.83s).
[0m13:02:23.063269 [debug] [MainThread]: Command end result
[0m13:02:23.128745 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:02:23.135172 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:02:23.153327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m13:02:23.154492 [info ] [MainThread]: 
[0m13:02:23.162423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:23.164269 [info ] [MainThread]: 
[0m13:02:23.167077 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:02:23.173082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.412904, "process_in_blocks": "63128", "process_kernel_time": 0.343797, "process_mem_max_rss": "128956", "process_out_blocks": "2896", "process_user_time": 3.977092}
[0m13:02:23.174593 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:23.174285 after 13.41 seconds
[0m13:02:23.175834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230ab12d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230abb52a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7230a6ab9e20>]}
[0m13:02:23.177042 [debug] [MainThread]: Flushing usage events
[0m13:02:24.282863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:51.865771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe33792b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2a79910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2ace600>]}


============================== 13:02:51.871670 | ec27bbb7-2e87-47f4-88bc-26abffe28479 ==============================
[0m13:02:51.871670 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:02:51.872856 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'empty': 'None', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'write_json': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs generate', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'cache_selected_only': 'False'}
[0m13:02:52.119346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe28a0920>]}
[0m13:02:52.206570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe3058830>]}
[0m13:02:52.207615 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:02:52.352882 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:02:52.491910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:52.492568 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:02:52.493166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:52.549784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2943740>]}
[0m13:02:52.567770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe13cd220>]}
[0m13:02:52.568617 [info ] [MainThread]: Found 4 models, 1 test, 1 source, 464 macros
[0m13:02:52.569338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2a074a0>]}
[0m13:02:52.572367 [info ] [MainThread]: 
[0m13:02:52.573172 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:02:52.573888 [info ] [MainThread]: 
[0m13:02:52.575118 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:02:52.581270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public'
[0m13:02:52.659793 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m13:02:52.660545 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:02:52.661184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:54.124826 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.464 seconds
[0m13:02:54.130799 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m13:02:54.312896 [debug] [ThreadPool]: On list_neondb_public: Close
[0m13:02:54.322358 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:54.323237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:02:54.323994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:55.732090 [debug] [MainThread]: SQL status: SELECT 1 in 1.408 seconds
[0m13:02:55.734237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec27bbb7-2e87-47f4-88bc-26abffe28479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe2940440>]}
[0m13:02:55.735062 [debug] [MainThread]: On master: ROLLBACK
[0m13:02:55.908339 [debug] [MainThread]: On master: Close
[0m13:02:55.916660 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m13:02:55.917310 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m13:02:55.918008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m13:02:55.918933 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m13:02:55.919617 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m13:02:55.920224 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m13:02:55.930823 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m13:02:55.934995 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m13:02:55.936311 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m13:02:55.936935 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m13:02:55.938110 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m13:02:55.939582 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m13:02:55.941616 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_channels
[0m13:02:55.942835 [debug] [Thread-3 (]: Began running node model.medical_warehouse.fct_messages
[0m13:02:55.943889 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m13:02:55.945412 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m13:02:55.946375 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m13:02:55.947436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now test.medical_warehouse.assert_no_future_messages)
[0m13:02:55.948226 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_channels
[0m13:02:55.948840 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.fct_messages
[0m13:02:55.949445 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m13:02:55.953311 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m13:02:55.957439 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m13:02:55.963153 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m13:02:55.964515 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_channels
[0m13:02:55.965812 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.fct_messages
[0m13:02:55.967269 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_channels
[0m13:02:55.967960 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m13:02:55.969171 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.fct_messages
[0m13:02:55.970615 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m13:02:55.974462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:55.975388 [debug] [MainThread]: Connection 'test.medical_warehouse.assert_no_future_messages' was properly closed.
[0m13:02:55.976141 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m13:02:55.977415 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m13:02:55.978389 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m13:02:55.981349 [debug] [MainThread]: Command end result
[0m13:02:56.217844 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:02:56.220191 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:02:56.231555 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m13:02:56.238337 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:02:56.239197 [info ] [MainThread]: Building catalog
[0m13:02:56.257223 [debug] [ThreadPool]: Acquiring new postgres connection 'neondb.information_schema'
[0m13:02:56.274153 [debug] [ThreadPool]: Using postgres connection "neondb.information_schema"
[0m13:02:56.275727 [debug] [ThreadPool]: On neondb.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "neondb.information_schema"} */

    
    

    select
        'neondb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_dates')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_telegram_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:02:56.277090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:57.891820 [debug] [ThreadPool]: SQL status: SELECT 41 in 1.615 seconds
[0m13:02:57.899747 [debug] [ThreadPool]: On neondb.information_schema: ROLLBACK
[0m13:02:58.084302 [debug] [ThreadPool]: On neondb.information_schema: Close
[0m13:02:58.112549 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m13:02:58.146603 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:02:58.149120 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:02:58.149754 [info ] [MainThread]: Catalog written to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m13:02:58.151156 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.363494, "process_in_blocks": "21496", "process_kernel_time": 0.293286, "process_mem_max_rss": "123876", "process_out_blocks": "5296", "process_user_time": 3.015107}
[0m13:02:58.152206 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:02:58.152000 after 6.36 seconds
[0m13:02:58.153100 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:02:58.153652 [debug] [MainThread]: Connection 'neondb.information_schema' was properly closed.
[0m13:02:58.154219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe47d7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe6db7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ebbe32ca1e0>]}
[0m13:02:58.154814 [debug] [MainThread]: Flushing usage events
[0m13:02:59.152386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:01.750643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b513ce840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b5133bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b5375f5f0>]}


============================== 13:03:01.754822 | 056a8159-7676-44f4-a985-eee98dfd1b8f ==============================
[0m13:03:01.754822 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:03:01.755957 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'empty': 'None'}
[0m13:03:01.994911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '056a8159-7676-44f4-a985-eee98dfd1b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b50b9a7e0>]}
[0m13:03:02.085640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '056a8159-7676-44f4-a985-eee98dfd1b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b50147e90>]}
[0m13:12:22.762363 [error] [MainThread]: Encountered an error:

[0m13:12:22.795323 [error] [MainThread]: Traceback (most recent call last):
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:12:22.815444 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 561.14154, "process_in_blocks": "37856", "process_kernel_time": 0.199594, "process_mem_max_rss": "107716", "process_out_blocks": "3360", "process_user_time": 2.390072}
[0m13:12:22.818986 [debug] [MainThread]: Command `dbt docs serve` failed at 13:12:22.818661 after 561.15 seconds
[0m13:12:22.823931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b512bcfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b4fd62900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b5015b2c0>]}
[0m13:12:22.825937 [debug] [MainThread]: Flushing usage events
[0m13:12:23.831334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:32.759906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a80cd4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a80b497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a807395e0>]}


============================== 13:12:32.766330 | 8f921f87-14a1-411d-81d4-e7bd252b6206 ==============================
[0m13:12:32.766330 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:12:32.767594 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'no_print': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:12:33.035778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f921f87-14a1-411d-81d4-e7bd252b6206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7ff15d00>]}
[0m13:12:33.126751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f921f87-14a1-411d-81d4-e7bd252b6206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7fecff20>]}
[0m13:12:33.128233 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:12:33.283265 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:12:33.501637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:12:33.503837 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/sources.yml
[0m13:12:34.130156 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_messages' in
package 'medical_warehouse' (models/sources.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m13:12:34.130938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8f921f87-14a1-411d-81d4-e7bd252b6206', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7df2cb30>]}
[0m13:12:34.173214 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m13:12:34.174205 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:12:34.175433 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 1.5085763, "process_in_blocks": "21320", "process_kernel_time": 0.272659, "process_mem_max_rss": "119432", "process_out_blocks": "8", "process_user_time": 3.248026}
[0m13:12:34.176252 [debug] [MainThread]: Command `dbt docs generate` failed at 13:12:34.176125 after 1.51 seconds
[0m13:12:34.176990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a80a5ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7e75c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7e340710>]}
[0m13:12:34.177663 [debug] [MainThread]: Flushing usage events
[0m13:12:35.030050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:59.848882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d6d21c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d6eff680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d4176f00>]}


============================== 13:12:59.853105 | a9bc1ddf-954b-4de7-9df9-73b342986031 ==============================
[0m13:12:59.853105 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:12:59.854422 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs generate', 'debug': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'version_check': 'True', 'empty': 'None', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'False'}
[0m13:13:00.085377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9bc1ddf-954b-4de7-9df9-73b342986031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d4ff1130>]}
[0m13:13:00.184179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9bc1ddf-954b-4de7-9df9-73b342986031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d659ddf0>]}
[0m13:13:00.185361 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:13:00.329885 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:13:00.471671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:00.473109 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/sources.yml
[0m13:13:01.115658 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_messages' in
package 'medical_warehouse' (models/sources.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m13:13:01.116435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9bc1ddf-954b-4de7-9df9-73b342986031', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d27e4e30>]}
[0m13:13:01.175843 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.medical_warehouse.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages' which was not found
[0m13:13:01.176895 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:13:01.178293 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 1.4127607, "process_in_blocks": "0", "process_kernel_time": 0.236956, "process_mem_max_rss": "119456", "process_out_blocks": "16", "process_user_time": 3.231409}
[0m13:13:01.179499 [debug] [MainThread]: Command `dbt docs generate` failed at 13:13:01.179291 after 1.41 seconds
[0m13:13:01.180183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d41ff1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d27e49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99d373a000>]}
[0m13:13:01.180864 [debug] [MainThread]: Flushing usage events
[0m13:13:01.998205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:04.466411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb13bc1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb1410cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb13d5dbe0>]}


============================== 13:13:04.470744 | 4d3aab00-413a-46aa-a305-ad452d989311 ==============================
[0m13:13:04.470744 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:13:04.471965 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'debug': 'False', 'invocation_command': 'dbt docs serve', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:13:04.734443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d3aab00-413a-46aa-a305-ad452d989311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb130afe00>]}
[0m13:13:04.834886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d3aab00-413a-46aa-a305-ad452d989311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb13fea000>]}
[0m13:16:52.681542 [error] [MainThread]: Encountered an error:

[0m13:16:52.706664 [error] [MainThread]: Traceback (most recent call last):
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:16:52.724598 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 228.3388, "process_in_blocks": "41160", "process_kernel_time": 0.192364, "process_mem_max_rss": "107972", "process_out_blocks": "3360", "process_user_time": 2.309377}
[0m13:16:52.726227 [debug] [MainThread]: Command `dbt docs serve` failed at 13:16:52.725951 after 228.34 seconds
[0m13:16:52.727812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb1410cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb130f42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79eb13abe1b0>]}
[0m13:16:52.728900 [debug] [MainThread]: Flushing usage events
[0m13:17:32.798613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ec79dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ece6d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ed1a0350>]}


============================== 13:17:32.806621 | 9d726aae-e935-4804-a088-7ccb9c4ec20e ==============================
[0m13:17:32.806621 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:17:32.808056 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'use_experimental_parser': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'False', 'target_path': 'None'}
[0m13:17:33.140893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ebe3a750>]}
[0m13:17:33.235968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ec0c3020>]}
[0m13:17:33.237386 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:17:33.434229 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:17:33.645586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:17:33.646727 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models/schema.yml
[0m13:17:33.905137 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_messages' in
package 'medical_warehouse' (models/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m13:17:33.905919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ea19b7d0>]}
[0m13:17:34.219119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e9d50d10>]}
[0m13:17:34.414100 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:17:34.420061 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:17:34.454054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e9d89f70>]}
[0m13:17:34.454881 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 464 macros
[0m13:17:34.455552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ea5a1a90>]}
[0m13:17:34.458538 [info ] [MainThread]: 
[0m13:17:34.459313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:17:34.459995 [info ] [MainThread]: 
[0m13:17:34.461342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:17:34.470554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m13:17:34.593980 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m13:17:34.594804 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m13:17:34.595474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:36.559150 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.964 seconds
[0m13:17:36.561679 [debug] [ThreadPool]: On list_neondb: Close
[0m13:17:36.565082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m13:17:36.574816 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m13:17:36.575498 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:17:36.576071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:38.113354 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.537 seconds
[0m13:17:38.115499 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m13:17:38.288941 [debug] [ThreadPool]: On list_neondb_public: Close
[0m13:17:38.296352 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:38.297077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:17:38.297623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:39.799238 [debug] [MainThread]: SQL status: SELECT 1 in 1.502 seconds
[0m13:17:39.801860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e8c1f680>]}
[0m13:17:39.803078 [debug] [MainThread]: On master: ROLLBACK
[0m13:17:39.976201 [debug] [MainThread]: On master: COMMIT
[0m13:17:39.976985 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:39.977549 [debug] [MainThread]: On master: COMMIT
[0m13:17:40.332740 [debug] [MainThread]: SQL status: COMMIT in 0.354 seconds
[0m13:17:40.333588 [debug] [MainThread]: On master: Close
[0m13:17:40.382795 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m13:17:40.383568 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m13:17:40.384508 [info ] [Thread-1 (]: 1 of 4 START sql table model public.dim_dates .................................. [RUN]
[0m13:17:40.385458 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m13:17:40.386291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m13:17:40.387662 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m13:17:40.388486 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m13:17:40.389363 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m13:17:40.399899 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m13:17:40.408801 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m13:17:40.412156 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m13:17:40.413149 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m13:17:40.532207 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m13:17:40.541610 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m13:17:40.543838 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:40.544558 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:40.545329 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- Generate date dimension for last 2 years
with dates as (
    select generate_series(
        current_date - interval '2 years',
        current_date + interval '1 year',
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    to_char(full_date, 'Day') as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    to_char(full_date, 'Month') as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from dates
  );
  
[0m13:17:40.546352 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m13:17:40.547240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:40.548086 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:17:42.048317 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.500 seconds
[0m13:17:42.183410 [debug] [Thread-1 (]: SQL status: SELECT 1097 in 1.636 seconds
[0m13:17:42.188956 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:42.198132 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:42.198907 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m13:17:42.199579 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m13:17:42.376243 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m13:17:42.381023 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:42.381614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.181 seconds
[0m13:17:42.382355 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m13:17:42.387074 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:42.388231 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m13:17:42.567497 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.179 seconds
[0m13:17:42.582202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.193 seconds
[0m13:17:42.601720 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m13:17:42.604525 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m13:17:42.605507 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:42.606384 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:42.607473 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m13:17:42.608455 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m13:17:42.779870 [debug] [Thread-2 (]: SQL status: COMMIT in 0.170 seconds
[0m13:17:42.790665 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m13:17:42.798025 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m13:17:42.798757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.189 seconds
[0m13:17:42.799346 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m13:17:42.803179 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m13:17:42.808488 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m13:17:42.809172 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m13:17:42.982057 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.178 seconds
[0m13:17:42.987120 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m13:17:42.991505 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.182 seconds
[0m13:17:42.993586 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m13:17:42.995728 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ee9ef680>]}
[0m13:17:42.996425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e9d53080>]}
[0m13:17:42.997467 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 2.60s]
[0m13:17:42.998533 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.dim_dates ............................. [[32mSELECT 1097[0m in 2.61s]
[0m13:17:42.999496 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m13:17:43.000283 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m13:17:43.001376 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m13:17:43.002168 [debug] [Thread-4 (]: Began running node model.medical_warehouse.fct_messages
[0m13:17:43.003408 [info ] [Thread-1 (]: 3 of 4 START sql table model public.dim_channels ............................... [RUN]
[0m13:17:43.005177 [info ] [Thread-4 (]: 4 of 4 START sql table model public.fct_messages ............................... [RUN]
[0m13:17:43.007773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.dim_channels)
[0m13:17:43.009353 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m13:17:43.010367 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m13:17:43.011582 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.fct_messages
[0m13:17:43.018179 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m13:17:43.024792 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m13:17:43.028132 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m13:17:43.029680 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.fct_messages
[0m13:17:43.039644 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m13:17:43.048809 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:43.050015 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m13:17:43.059072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:43.056660 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m13:17:43.063486 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:43.066509 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m13:17:43.067787 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:17:44.532288 [debug] [Thread-4 (]: SQL status: SELECT 276 in 1.464 seconds
[0m13:17:44.538560 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:44.539478 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages" rename to "fct_messages__dbt_backup"
[0m13:17:44.714575 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.174 seconds
[0m13:17:44.722195 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:44.723345 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m13:17:44.741771 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.683 seconds
[0m13:17:44.749385 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:44.750502 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m13:17:44.900023 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.176 seconds
[0m13:17:44.903505 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m13:17:44.904437 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:44.905189 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m13:17:44.936928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.185 seconds
[0m13:17:44.944336 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:44.945623 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m13:17:45.096307 [debug] [Thread-4 (]: SQL status: COMMIT in 0.190 seconds
[0m13:17:45.099668 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."fct_messages__dbt_backup"
[0m13:17:45.100985 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m13:17:45.101675 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "neondb"."public"."fct_messages__dbt_backup" cascade
[0m13:17:45.129225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.183 seconds
[0m13:17:45.134711 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m13:17:45.135538 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:45.136269 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m13:17:45.316532 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.214 seconds
[0m13:17:45.320279 [debug] [Thread-4 (]: On model.medical_warehouse.fct_messages: Close
[0m13:17:45.322050 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e8b76510>]}
[0m13:17:45.323562 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.fct_messages .......................... [[32mSELECT 276[0m in 2.31s]
[0m13:17:45.325376 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.fct_messages
[0m13:17:45.354773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.218 seconds
[0m13:17:45.359318 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m13:17:45.361354 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m13:17:45.362472 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m13:17:45.541435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.177 seconds
[0m13:17:45.543560 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: Close
[0m13:17:45.544884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d726aae-e935-4804-a088-7ccb9c4ec20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97e8b39550>]}
[0m13:17:45.545902 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 2.54s]
[0m13:17:45.546866 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m13:17:45.548675 [debug] [MainThread]: On master: COMMIT
[0m13:17:45.549357 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:45.549946 [debug] [MainThread]: On master: COMMIT
[0m13:17:45.550448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:17:46.990758 [debug] [MainThread]: SQL status: COMMIT in 1.440 seconds
[0m13:17:46.991535 [debug] [MainThread]: On master: Close
[0m13:17:46.994764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:46.995478 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m13:17:46.996285 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m13:17:46.996851 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m13:17:46.997516 [info ] [MainThread]: 
[0m13:17:46.998195 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m13:17:46.999840 [debug] [MainThread]: Command end result
[0m13:17:47.049192 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:17:47.096557 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:17:47.106564 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m13:17:47.107335 [info ] [MainThread]: 
[0m13:17:47.108210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:17:47.108843 [info ] [MainThread]: 
[0m13:17:47.109514 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:17:47.110460 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:17:47.113000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.433573, "process_in_blocks": "136154", "process_kernel_time": 0.487372, "process_mem_max_rss": "127268", "process_out_blocks": "3040", "process_user_time": 4.379402}
[0m13:17:47.114217 [debug] [MainThread]: Command `dbt run` succeeded at 13:17:47.113966 after 14.44 seconds
[0m13:17:47.115022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ec84cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ec84d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b97ea5c5e50>]}
[0m13:17:47.115817 [debug] [MainThread]: Flushing usage events
[0m13:17:48.481145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:00.516436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e331ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e344f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e12a6de0>]}


============================== 13:18:00.522945 | 3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21 ==============================
[0m13:18:00.522945 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:18:00.524343 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt docs generate', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True'}
[0m13:18:00.866488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e066f9e0>]}
[0m13:18:00.970543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e0b4b2c0>]}
[0m13:18:00.972023 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:18:01.142970 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:18:01.377985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:01.378616 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:18:01.379102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:01.449275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10dfd62a80>]}
[0m13:18:01.482269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10df50ed80>]}
[0m13:18:01.483491 [info ] [MainThread]: Found 4 models, 11 data tests, 1 source, 464 macros
[0m13:18:01.484433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10dfd60590>]}
[0m13:18:01.489192 [info ] [MainThread]: 
[0m13:18:01.490228 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:18:01.491299 [info ] [MainThread]: 
[0m13:18:01.492862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:18:01.503012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public'
[0m13:18:01.613474 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m13:18:01.614355 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:18:01.615019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:03.050179 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.435 seconds
[0m13:18:03.053037 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m13:18:03.225213 [debug] [ThreadPool]: On list_neondb_public: Close
[0m13:18:03.234328 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:03.235186 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:18:03.235864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:04.927680 [debug] [MainThread]: SQL status: SELECT 1 in 1.692 seconds
[0m13:18:04.930765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aaf91e7-8ce3-4632-b2d6-0d5ea690cf21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e07388f0>]}
[0m13:18:04.931996 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:05.115379 [debug] [MainThread]: On master: Close
[0m13:18:05.121482 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m13:18:05.122139 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m13:18:05.122871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m13:18:05.123691 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m13:18:05.124307 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m13:18:05.124873 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m13:18:05.133922 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m13:18:05.137794 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m13:18:05.138972 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m13:18:05.139771 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m13:18:05.140841 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m13:18:05.141745 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m13:18:05.143001 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m13:18:05.143658 [debug] [Thread-4 (]: Began running node model.medical_warehouse.fct_messages
[0m13:18:05.144475 [debug] [Thread-3 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m13:18:05.145303 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m13:18:05.146103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.dim_channels)
[0m13:18:05.147359 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_messages'
[0m13:18:05.148266 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.assert_no_future_messages'
[0m13:18:05.149043 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m13:18:05.150103 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m13:18:05.151249 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.fct_messages
[0m13:18:05.152002 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m13:18:05.152742 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m13:18:05.156369 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m13:18:05.159951 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m13:18:05.163608 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m13:18:05.179596 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m13:18:05.180880 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m13:18:05.182270 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.fct_messages
[0m13:18:05.183435 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m13:18:05.185000 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m13:18:05.186051 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.fct_messages
[0m13:18:05.187045 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m13:18:05.187764 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m13:18:05.188344 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m13:18:05.189177 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m13:18:05.190237 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m13:18:05.191083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1)
[0m13:18:05.192180 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m13:18:05.193069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fct_messages, now test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348)
[0m13:18:05.193691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d)
[0m13:18:05.194483 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m13:18:05.195238 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m13:18:05.195994 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m13:18:05.196560 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m13:18:05.207806 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m13:18:05.208562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0)
[0m13:18:05.213917 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m13:18:05.221893 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m13:18:05.223035 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m13:18:05.223721 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m13:18:05.230953 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m13:18:05.231657 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m13:18:05.233018 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m13:18:05.233820 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m13:18:05.235840 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m13:18:05.237102 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m13:18:05.237874 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m13:18:05.238992 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m13:18:05.240106 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m13:18:05.240870 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m13:18:05.241600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1, now test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56)
[0m13:18:05.242457 [debug] [Thread-3 (]: Began running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m13:18:05.243411 [debug] [Thread-2 (]: Began running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m13:18:05.244282 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348, now test.medical_warehouse.not_null_fct_messages_message_id.de346706b5)
[0m13:18:05.245072 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m13:18:05.246020 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d, now test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a)
[0m13:18:05.246823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0, now test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32)
[0m13:18:05.247523 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m13:18:05.254631 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m13:18:05.255432 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m13:18:05.256226 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m13:18:05.262582 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m13:18:05.263950 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m13:18:05.277975 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m13:18:05.287569 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m13:18:05.289244 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m13:18:05.290108 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m13:18:05.291059 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m13:18:05.291654 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m13:18:05.292430 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m13:18:05.293631 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m13:18:05.294517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56, now test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d)
[0m13:18:05.295621 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m13:18:05.296816 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m13:18:05.297848 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m13:18:05.305403 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m13:18:05.307123 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m13:18:05.308221 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m13:18:05.309792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:05.310467 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d' was properly closed.
[0m13:18:05.311133 [debug] [MainThread]: Connection 'test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32' was properly closed.
[0m13:18:05.311638 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_fct_messages_message_id.de346706b5' was properly closed.
[0m13:18:05.312143 [debug] [MainThread]: Connection 'test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a' was properly closed.
[0m13:18:05.315885 [debug] [MainThread]: Command end result
[0m13:18:05.475734 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:18:05.481864 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:18:05.492264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m13:18:05.501219 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:18:05.501985 [info ] [MainThread]: Building catalog
[0m13:18:05.515127 [debug] [ThreadPool]: Acquiring new postgres connection 'neondb.information_schema'
[0m13:18:05.530380 [debug] [ThreadPool]: Using postgres connection "neondb.information_schema"
[0m13:18:05.531722 [debug] [ThreadPool]: On neondb.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "neondb.information_schema"} */

    
    

    select
        'neondb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_dates')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_telegram_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:18:05.532893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:07.204047 [debug] [ThreadPool]: SQL status: SELECT 41 in 1.671 seconds
[0m13:18:07.210114 [debug] [ThreadPool]: On neondb.information_schema: ROLLBACK
[0m13:18:07.389277 [debug] [ThreadPool]: On neondb.information_schema: Close
[0m13:18:07.404968 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m13:18:07.431348 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m13:18:07.437013 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m13:18:07.437675 [info ] [MainThread]: Catalog written to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m13:18:07.439476 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.063155, "process_in_blocks": "61792", "process_kernel_time": 0.444885, "process_mem_max_rss": "124992", "process_out_blocks": "5560", "process_user_time": 3.929327}
[0m13:18:07.440320 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:18:07.440173 after 7.06 seconds
[0m13:18:07.440913 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:18:07.441401 [debug] [MainThread]: Connection 'neondb.information_schema' was properly closed.
[0m13:18:07.442036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e16809b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e0f80950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c10e0f81a00>]}
[0m13:18:07.442744 [debug] [MainThread]: Flushing usage events
[0m13:18:08.344001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:14.100107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8ceed20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8d0c475c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8ce9fd160>]}


============================== 13:18:14.106417 | 9c5e49e3-0f18-4d36-beb4-7537a06f5067 ==============================
[0m13:18:14.106417 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:18:14.107673 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'debug': 'False', 'empty': 'None', 'target_path': 'None', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt docs serve', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'warn_error': 'None', 'introspect': 'True'}
[0m13:18:14.377563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c5e49e3-0f18-4d36-beb4-7537a06f5067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8ce010c20>]}
[0m13:18:14.474276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c5e49e3-0f18-4d36-beb4-7537a06f5067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8ce82d700>]}
[0m13:31:37.635051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba31250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0ebb35850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba15790>]}


============================== 13:31:37.642790 | c0d6725f-056f-4c7c-b2d0-280dbb94348f ==============================
[0m13:31:37.642790 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:31:37.644059 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'use_colors': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True'}
[0m13:31:37.657055 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m13:31:37.659271 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.19986153, "process_in_blocks": "103344", "process_kernel_time": 0.449726, "process_mem_max_rss": "123016", "process_out_blocks": "8", "process_user_time": 4.590582}
[0m13:31:37.660484 [debug] [MainThread]: Command `dbt docs serve` failed at 13:31:37.660307 after 0.20 seconds
[0m13:31:37.661334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba15fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba15390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0eba0b310>]}
[0m13:31:37.662247 [debug] [MainThread]: Flushing usage events
[0m13:31:38.623510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:44.192150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bfa00b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bfa012d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bf9dbd50>]}


============================== 13:33:44.196066 | 97db6748-731e-423b-97b7-c684a50d1ab2 ==============================
[0m13:33:44.196066 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:33:44.197280 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True'}
[0m13:33:44.208924 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m13:33:44.211300 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.15401903, "process_in_blocks": "256", "process_kernel_time": 0.271286, "process_mem_max_rss": "123204", "process_out_blocks": "8", "process_user_time": 3.507769}
[0m13:33:44.212564 [debug] [MainThread]: Command `dbt docs serve` failed at 13:33:44.212326 after 0.16 seconds
[0m13:33:44.213455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bfa5c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bfa5e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7513bf9d95d0>]}
[0m13:33:44.214406 [debug] [MainThread]: Flushing usage events
[0m13:33:45.225000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:33.926931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f6634650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f67b3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f649bf10>]}


============================== 13:34:33.937499 | b3d4a9cf-5ed4-4a95-a5d5-ec950c3e0dcd ==============================
[0m13:34:33.937499 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:34:33.939154 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m13:34:33.991023 [info ] [MainThread]: dbt version: 1.11.2
[0m13:34:33.993154 [info ] [MainThread]: python version: 3.11.14
[0m13:34:33.994270 [info ] [MainThread]: python path: /usr/bin/python3.11
[0m13:34:33.995298 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m13:34:34.026152 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m13:34:34.028535 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.32322937, "process_in_blocks": "864", "process_kernel_time": 0.354009, "process_mem_max_rss": "123660", "process_out_blocks": "16", "process_user_time": 4.597164}
[0m13:34:34.031727 [debug] [MainThread]: Command `dbt debug` failed at 13:34:34.029833 after 0.33 seconds
[0m13:34:34.033279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f64bba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319f64bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7319fbb3b550>]}
[0m13:34:34.034608 [debug] [MainThread]: Flushing usage events
[0m13:34:34.967769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:48.024814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77875281cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778752693f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778752690650>]}


============================== 13:36:48.028557 | a16fb5b8-c5ba-47c7-9022-b349ad41475b ==============================
[0m13:36:48.028557 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:36:48.029675 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'partial_parse': 'True', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'target_path': 'None', 'version_check': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug'}
[0m13:36:48.040657 [info ] [MainThread]: dbt version: 1.11.2
[0m13:36:48.041368 [info ] [MainThread]: python version: 3.11.14
[0m13:36:48.042021 [info ] [MainThread]: python path: /usr/bin/python3.11
[0m13:36:48.042724 [info ] [MainThread]: os info: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
[0m13:36:48.055611 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m13:36:48.057468 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12418421, "process_in_blocks": "0", "process_kernel_time": 0.284369, "process_mem_max_rss": "123664", "process_out_blocks": "8", "process_user_time": 3.570089}
[0m13:36:48.058907 [debug] [MainThread]: Command `dbt debug` failed at 13:36:48.058619 after 0.13 seconds
[0m13:36:48.060449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778752692bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778757d26c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778757d26a10>]}
[0m13:36:48.061829 [debug] [MainThread]: Flushing usage events
[0m13:36:49.023579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:51.818618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e605a4814f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e605af75fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e605a481460>]}


============================== 09:32:51.825038 | 3bfe844b-eca9-4a3a-8d1f-ca61bd7aadbf ==============================
[0m09:32:51.825038 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:32:51.826462 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'quiet': 'False', 'empty': 'False'}
[0m09:32:51.836136 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m09:32:51.838504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.103154406, "process_in_blocks": "59432", "process_kernel_time": 0.285021, "process_mem_max_rss": "99516", "process_out_blocks": "8", "process_user_time": 2.141673}
[0m09:32:51.839609 [debug] [MainThread]: Command `dbt run` failed at 09:32:51.839367 after 0.10 seconds
[0m09:32:51.840621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e605a6c6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6059b7bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e605a405430>]}
[0m09:32:51.841746 [debug] [MainThread]: Flushing usage events
[0m09:32:53.451949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:15.490360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac046b3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac02e764e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac02a80bc0>]}


============================== 09:35:15.496523 | dbca57fb-ef77-40c9-a55c-d184b24f0d63 ==============================
[0m09:35:15.496523 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:35:15.497721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'static_parser': 'True', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'warn_error': 'None', 'target_path': 'None', 'empty': 'False', 'debug': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:35:15.747719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac01b430e0>]}
[0m09:35:15.850236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac01fd9be0>]}
[0m09:35:15.851906 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:35:16.022548 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:35:16.226666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m09:35:16.227590 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models/marts/fct_image_detections.sql
[0m09:35:16.228664 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/marts/fct_messages.sql
[0m09:35:16.229620 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/sources.yml
[0m09:35:16.230561 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/schema.yml
[0m09:35:16.929473 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_messages' in
package 'medical_warehouse' (models/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m09:35:16.930274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abff57e930>]}
[0m09:35:17.396839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abff5353a0>]}
[0m09:35:17.572207 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:35:17.575419 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:35:17.613811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac001b5730>]}
[0m09:35:17.614608 [info ] [MainThread]: Found 5 models, 12 data tests, 2 sources, 464 macros
[0m09:35:17.615274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abffd92c30>]}
[0m09:35:17.619509 [info ] [MainThread]: 
[0m09:35:17.620631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:35:17.621572 [info ] [MainThread]: 
[0m09:35:17.622955 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:35:17.629483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m09:35:17.716449 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m09:35:17.717787 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m09:35:17.718898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:20.049932 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.331 seconds
[0m09:35:20.052306 [debug] [ThreadPool]: On list_neondb: Close
[0m09:35:20.054930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m09:35:20.063779 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m09:35:20.064530 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:35:20.065097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:22.050983 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.986 seconds
[0m09:35:22.057828 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m09:35:22.280514 [debug] [ThreadPool]: On list_neondb_public: Close
[0m09:35:22.305644 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:22.309686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:35:22.311639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:35:24.202148 [debug] [MainThread]: SQL status: SELECT 1 in 1.890 seconds
[0m09:35:24.209047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abfe008a70>]}
[0m09:35:24.210779 [debug] [MainThread]: On master: ROLLBACK
[0m09:35:24.449805 [debug] [MainThread]: On master: COMMIT
[0m09:35:24.450659 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:24.451291 [debug] [MainThread]: On master: COMMIT
[0m09:35:24.900112 [debug] [MainThread]: SQL status: COMMIT in 0.448 seconds
[0m09:35:24.900856 [debug] [MainThread]: On master: Close
[0m09:35:24.949381 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_dates
[0m09:35:24.950395 [debug] [Thread-2 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m09:35:24.951826 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_dates .................................. [RUN]
[0m09:35:24.953119 [info ] [Thread-2 (]: 2 of 5 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m09:35:24.953963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.dim_dates)
[0m09:35:24.955064 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m09:35:24.955845 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_dates
[0m09:35:24.956586 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m09:35:24.971214 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m09:35:24.976036 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m09:35:24.978075 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_dates
[0m09:35:24.990247 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m09:35:25.131971 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m09:35:25.142270 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m09:35:25.143935 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:35:25.144847 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:35:25.145770 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- Generate date dimension for last 2 years
with dates as (
    select generate_series(
        current_date - interval '2 years',
        current_date + interval '1 year',
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    to_char(full_date, 'Day') as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    to_char(full_date, 'Month') as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from dates
  );
  
[0m09:35:25.146650 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m09:35:25.147625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:25.148809 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:35:27.057158 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.908 seconds
[0m09:35:27.068074 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:35:27.069076 [debug] [Thread-1 (]: SQL status: SELECT 1097 in 1.921 seconds
[0m09:35:27.069812 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m09:35:27.078483 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:35:27.079378 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m09:35:27.320569 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.241 seconds
[0m09:35:27.325360 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:35:27.326211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.246 seconds
[0m09:35:27.326944 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m09:35:27.330762 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:35:27.331641 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m09:35:27.557667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.225 seconds
[0m09:35:27.572708 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.241 seconds
[0m09:35:27.704353 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m09:35:27.706597 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m09:35:27.709292 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:35:27.711338 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:35:27.713267 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m09:35:27.714489 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m09:35:27.982587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.267 seconds
[0m09:35:27.990334 [debug] [Thread-2 (]: SQL status: COMMIT in 0.275 seconds
[0m09:35:27.994791 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m09:35:27.999684 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m09:35:28.009903 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:35:28.014274 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:35:28.015173 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m09:35:28.016181 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m09:35:28.253568 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.236 seconds
[0m09:35:28.257449 [debug] [Thread-1 (]: On model.medical_warehouse.dim_dates: Close
[0m09:35:28.258234 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.241 seconds
[0m09:35:28.260177 [debug] [Thread-2 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m09:35:28.263315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac045c04d0>]}
[0m09:35:28.264028 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac02aa6630>]}
[0m09:35:28.265374 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.dim_dates ............................. [[32mSELECT 1097[0m in 3.31s]
[0m09:35:28.267020 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 3.31s]
[0m09:35:28.268378 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_dates
[0m09:35:28.269959 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m09:35:28.272020 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_channels
[0m09:35:28.273301 [debug] [Thread-3 (]: Began running node model.medical_warehouse.fct_image_detections
[0m09:35:28.274171 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m09:35:28.275587 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_channels ............................... [RUN]
[0m09:35:28.277029 [info ] [Thread-3 (]: 4 of 5 START sql table model public.fct_image_detections ....................... [RUN]
[0m09:35:28.278004 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fct_messages ............................... [RUN]
[0m09:35:28.279583 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m09:35:28.280782 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m09:35:28.281905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now model.medical_warehouse.fct_messages)
[0m09:35:28.283276 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_channels
[0m09:35:28.284929 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m09:35:28.286841 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m09:35:28.293880 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m09:35:28.313841 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_channels
[0m09:35:28.321649 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m09:35:28.323304 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m09:35:28.312919 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m09:35:28.340632 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m09:35:28.354240 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m09:35:28.356098 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:35:28.358425 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m09:35:28.365586 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:35:28.364254 [debug] [Thread-3 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m09:35:28.370960 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m09:35:28.373333 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:35:28.374570 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m09:35:28.377069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:28.379417 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m09:35:28.381644 [debug] [Thread-3 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "neondb"."public"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    /*
  Enriched fact table: links YOLO image categories to messages.
  Enables analysis like: "Do promotional posts get more views?"
*/
select
    y.message_id::bigint,
    md5(y.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    y.detected_objects,
    y.confidence_score,
    y.image_category
from "neondb"."raw"."yolo_detections" y
join "neondb"."public"."stg_telegram_messages" s
    on y.message_id::text = s.message_id::text
    and y.channel_name = s.channel_name
  );
  
[0m09:35:28.384423 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:35:30.303188 [debug] [Thread-1 (]: SQL status: SELECT 276 in 1.927 seconds
[0m09:35:30.303921 [debug] [Thread-4 (]: SQL status: SELECT 3 in 1.938 seconds
[0m09:35:30.304610 [debug] [Thread-3 (]: SQL status: SELECT 133 in 1.920 seconds
[0m09:35:30.310981 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:35:30.318163 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:35:30.324954 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m09:35:30.325953 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages" rename to "fct_messages__dbt_backup"
[0m09:35:30.326871 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m09:35:30.327608 [debug] [Thread-3 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "neondb"."public"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m09:35:30.554438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.226 seconds
[0m09:35:30.561551 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:35:30.562710 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m09:35:30.570448 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.242 seconds
[0m09:35:30.574178 [debug] [Thread-3 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m09:35:30.575368 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m09:35:30.576511 [debug] [Thread-3 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m09:35:30.790749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.227 seconds
[0m09:35:30.793542 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m09:35:30.794215 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:35:30.794790 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m09:35:30.811516 [debug] [Thread-3 (]: SQL status: COMMIT in 0.234 seconds
[0m09:35:30.814945 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public"."fct_image_detections__dbt_backup"
[0m09:35:30.816634 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m09:35:30.817371 [debug] [Thread-3 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
drop table if exists "neondb"."public"."fct_image_detections__dbt_backup" cascade
[0m09:35:31.050048 [debug] [Thread-1 (]: SQL status: COMMIT in 0.255 seconds
[0m09:35:31.054368 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."fct_messages__dbt_backup"
[0m09:35:31.055086 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.237 seconds
[0m09:35:31.055831 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.727 seconds
[0m09:35:31.057222 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:35:31.059466 [debug] [Thread-3 (]: On model.medical_warehouse.fct_image_detections: Close
[0m09:35:31.063462 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:35:31.064164 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "neondb"."public"."fct_messages__dbt_backup" cascade
[0m09:35:31.064975 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m09:35:31.066322 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abfe1e5eb0>]}
[0m09:35:31.068119 [info ] [Thread-3 (]: 4 of 5 OK created sql table model public.fct_image_detections .................. [[32mSELECT 133[0m in 2.79s]
[0m09:35:31.069416 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m09:35:31.305085 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.238 seconds
[0m09:35:31.308029 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m09:35:31.308706 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.241 seconds
[0m09:35:31.310209 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:35:31.312763 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m09:35:31.313526 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m09:35:31.315272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abfe0f2180>]}
[0m09:35:31.316658 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fct_messages .......................... [[32mSELECT 276[0m in 3.03s]
[0m09:35:31.317847 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m09:35:31.558897 [debug] [Thread-4 (]: SQL status: COMMIT in 0.244 seconds
[0m09:35:31.562349 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m09:35:31.563594 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:35:31.564196 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m09:35:31.811089 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.246 seconds
[0m09:35:31.813159 [debug] [Thread-4 (]: On model.medical_warehouse.dim_channels: Close
[0m09:35:31.814173 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbca57fb-ef77-40c9-a55c-d184b24f0d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abfc74ade0>]}
[0m09:35:31.815613 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 3.53s]
[0m09:35:31.817391 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_channels
[0m09:35:31.819717 [debug] [MainThread]: On master: COMMIT
[0m09:35:31.820322 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:31.820833 [debug] [MainThread]: On master: COMMIT
[0m09:35:31.821312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:35:33.730656 [debug] [MainThread]: SQL status: COMMIT in 1.909 seconds
[0m09:35:33.731766 [debug] [MainThread]: On master: Close
[0m09:35:33.733304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:33.734277 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m09:35:33.735194 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m09:35:33.736119 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m09:35:33.736856 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m09:35:33.737562 [info ] [MainThread]: 
[0m09:35:33.738200 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 16.11 seconds (16.11s).
[0m09:35:33.740215 [debug] [MainThread]: Command end result
[0m09:35:33.799206 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:35:33.804101 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:35:33.819589 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m09:35:33.820997 [info ] [MainThread]: 
[0m09:35:33.822585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:35:33.823843 [info ] [MainThread]: 
[0m09:35:33.825097 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m09:35:33.826974 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:35:33.829743 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.42754, "process_in_blocks": "50536", "process_kernel_time": 0.386286, "process_mem_max_rss": "133924", "process_out_blocks": "3136", "process_user_time": 4.892298}
[0m09:35:33.833908 [debug] [MainThread]: Command `dbt run` succeeded at 09:35:33.833502 after 18.43 seconds
[0m09:35:33.835470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac025c7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac03f945f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac03f96030>]}
[0m09:35:33.836866 [debug] [MainThread]: Flushing usage events
[0m09:35:36.499235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:05.126139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d30e57980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2ead6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2ead6180>]}


============================== 09:37:05.133013 | 8b244538-d15b-4af4-9084-2324be896a73 ==============================
[0m09:37:05.133013 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:37:05.134517 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'empty': 'None', 'printer_width': '80', 'invocation_command': 'dbt test', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'write_json': 'True'}
[0m09:37:05.434502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b244538-d15b-4af4-9084-2324be896a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2e1b8b00>]}
[0m09:37:05.540591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b244538-d15b-4af4-9084-2324be896a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2ec8a000>]}
[0m09:37:05.542276 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:37:05.721461 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:37:05.987976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:37:05.988978 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:37:05.989850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:37:06.070992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b244538-d15b-4af4-9084-2324be896a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2d578c50>]}
[0m09:37:06.219725 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:37:06.222420 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:37:06.314824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b244538-d15b-4af4-9084-2324be896a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2c18b500>]}
[0m09:37:06.315643 [info ] [MainThread]: Found 5 models, 12 data tests, 2 sources, 464 macros
[0m09:37:06.316393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b244538-d15b-4af4-9084-2324be896a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2d902750>]}
[0m09:37:06.319801 [info ] [MainThread]: 
[0m09:37:06.321108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:06.322161 [info ] [MainThread]: 
[0m09:37:06.323584 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:37:06.330713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public'
[0m09:37:06.445147 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m09:37:06.446348 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:37:06.447377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:08.602595 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.155 seconds
[0m09:37:08.606143 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m09:37:08.833049 [debug] [ThreadPool]: On list_neondb_public: Close
[0m09:37:08.841016 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:08.841996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:37:08.842803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:10.695338 [debug] [MainThread]: SQL status: SELECT 1 in 1.852 seconds
[0m09:37:10.697764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b244538-d15b-4af4-9084-2324be896a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2c5c6bd0>]}
[0m09:37:10.698750 [debug] [MainThread]: On master: ROLLBACK
[0m09:37:10.919541 [debug] [MainThread]: On master: COMMIT
[0m09:37:10.920401 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:10.921083 [debug] [MainThread]: On master: COMMIT
[0m09:37:11.375047 [debug] [MainThread]: SQL status: COMMIT in 0.453 seconds
[0m09:37:11.375941 [debug] [MainThread]: On master: Close
[0m09:37:11.381536 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m09:37:11.382257 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:37:11.382840 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:37:11.383581 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:37:11.384266 [info ] [Thread-1 (]: 1 of 12 START test assert_no_future_messages ................................... [RUN]
[0m09:37:11.387889 [info ] [Thread-2 (]: 2 of 12 START test not_null_dim_channels_channel_key ........................... [RUN]
[0m09:37:11.388830 [info ] [Thread-3 (]: 3 of 12 START test not_null_dim_dates_date_key ................................. [RUN]
[0m09:37:11.389860 [info ] [Thread-4 (]: 4 of 12 START test not_null_fct_messages_message_id ............................ [RUN]
[0m09:37:11.390724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now test.medical_warehouse.assert_no_future_messages)
[0m09:37:11.391598 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0'
[0m09:37:11.392441 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348'
[0m09:37:11.393553 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_fct_messages_message_id.de346706b5'
[0m09:37:11.394362 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m09:37:11.395070 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:37:11.395665 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:37:11.396329 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:37:11.409619 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m09:37:11.468815 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m09:37:11.472500 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m09:37:11.477420 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m09:37:11.479278 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:37:11.480193 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m09:37:11.481091 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:37:11.527784 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m09:37:11.529644 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.assert_no_future_messages"
[0m09:37:11.530338 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:37:11.533476 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m09:37:11.538817 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m09:37:11.540541 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m09:37:11.541780 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.assert_no_future_messages"
[0m09:37:11.542665 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m09:37:11.543422 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "neondb"."public"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m09:37:11.544277 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m09:37:11.545262 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.assert_no_future_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
  CUSTOM TEST: No messages should have future dates
  This enforces a business rule: data must be from the past/present
  PASS = returns 0 rows
*/

select *
from "neondb"."public"."stg_telegram_messages"
where message_date > current_timestamp
  
  
      
    ) dbt_internal_test
[0m09:37:11.546085 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "neondb"."public"."fct_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m09:37:11.546755 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:37:11.547600 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_key
from "neondb"."public"."dim_channels"
where channel_key is null



  
  
      
    ) dbt_internal_test
[0m09:37:11.548398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:11.549148 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:37:11.550138 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:37:13.521816 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.973 seconds
[0m09:37:13.528435 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m09:37:13.529244 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.981 seconds
[0m09:37:13.531483 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: ROLLBACK
[0m09:37:13.532331 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.982 seconds
[0m09:37:13.532984 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.986 seconds
[0m09:37:13.535594 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: ROLLBACK
[0m09:37:13.538211 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m09:37:13.772957 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: Close
[0m09:37:13.774362 [info ] [Thread-1 (]: 1 of 12 PASS assert_no_future_messages ......................................... [[32mPASS[0m in 2.38s]
[0m09:37:13.775951 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m09:37:13.776911 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348: Close
[0m09:37:13.777534 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: Close
[0m09:37:13.778140 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: Close
[0m09:37:13.778886 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:37:13.780144 [info ] [Thread-3 (]: 3 of 12 PASS not_null_dim_dates_date_key ....................................... [[32mPASS[0m in 2.39s]
[0m09:37:13.781640 [info ] [Thread-4 (]: 4 of 12 PASS not_null_fct_messages_message_id .................................. [[32mPASS[0m in 2.39s]
[0m09:37:13.783142 [info ] [Thread-2 (]: 2 of 12 PASS not_null_dim_channels_channel_key ................................. [[32mPASS[0m in 2.39s]
[0m09:37:13.785517 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:37:13.784095 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_telegram_messages_message_id ................... [RUN]
[0m09:37:13.787242 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:37:13.790467 [debug] [Thread-3 (]: Began running node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:37:13.789177 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:37:13.791916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m09:37:13.793057 [debug] [Thread-4 (]: Began running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:37:13.793895 [info ] [Thread-3 (]: 6 of 12 START test relationships_fct_image_detections_message_id__message_id__ref_fct_messages_  [RUN]
[0m09:37:13.795047 [debug] [Thread-2 (]: Began running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:37:13.795868 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:37:13.796715 [info ] [Thread-4 (]: 7 of 12 START test relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [RUN]
[0m09:37:13.805908 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_message_id.de346706b5, now test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a)
[0m09:37:13.798396 [info ] [Thread-2 (]: 8 of 12 START test relationships_fct_messages_date_key__date_key__ref_dim_dates_  [RUN]
[0m09:37:13.797528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348, now test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62)
[0m09:37:13.812948 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:37:13.811785 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0, now test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32)
[0m09:37:13.810521 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m09:37:13.831163 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:37:13.819383 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:37:13.807072 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:37:13.873698 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m09:37:13.870128 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m09:37:13.847664 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m09:37:13.887827 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m09:37:13.885746 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:37:13.895233 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m09:37:13.889050 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "neondb"."public"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m09:37:13.890336 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:37:13.904076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:13.912662 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:37:13.917431 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m09:37:13.914094 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m09:37:13.926784 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m09:37:13.927892 [debug] [Thread-2 (]: On test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_key as from_field
    from "neondb"."public"."fct_messages"
    where date_key is not null
),

parent as (
    select date_key as to_field
    from "neondb"."public"."dim_dates"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:37:13.929241 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m09:37:13.924892 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m09:37:13.932818 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:37:13.934704 [debug] [Thread-3 (]: On test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select message_id as from_field
    from "neondb"."public"."fct_image_detections"
    where message_id is not null
),

parent as (
    select message_id as to_field
    from "neondb"."public"."fct_messages"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:37:13.938920 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:37:13.937716 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m09:37:13.941213 [debug] [Thread-4 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_key as from_field
    from "neondb"."public"."fct_messages"
    where channel_key is not null
),

parent as (
    select channel_key as to_field
    from "neondb"."public"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:37:13.943075 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:37:15.876465 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.934 seconds
[0m09:37:15.877404 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.945 seconds
[0m09:37:15.878156 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.939 seconds
[0m09:37:15.880705 [debug] [Thread-4 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: ROLLBACK
[0m09:37:15.883035 [debug] [Thread-2 (]: On test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32: ROLLBACK
[0m09:37:15.885123 [debug] [Thread-3 (]: On test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62: ROLLBACK
[0m09:37:15.895514 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.991 seconds
[0m09:37:15.899654 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m09:37:16.102996 [debug] [Thread-2 (]: On test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32: Close
[0m09:37:16.106829 [error] [Thread-2 (]: 8 of 12 FAIL 76 relationships_fct_messages_date_key__date_key__ref_dim_dates_ .. [[31mFAIL 76[0m in 2.29s]
[0m09:37:16.107878 [debug] [Thread-4 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: Close
[0m09:37:16.108883 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:37:16.109683 [debug] [Thread-2 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:37:16.110409 [debug] [Thread-3 (]: On test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62: Close
[0m09:37:16.111213 [info ] [Thread-4 (]: 7 of 12 PASS relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [[32mPASS[0m in 2.31s]
[0m09:37:16.112204 [info ] [Thread-2 (]: 9 of 12 START test unique_dim_channels_channel_key ............................. [RUN]
[0m09:37:16.114344 [info ] [Thread-3 (]: 6 of 12 PASS relationships_fct_image_detections_message_id__message_id__ref_fct_messages_  [[32mPASS[0m in 2.32s]
[0m09:37:16.116048 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:37:16.117110 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m09:37:16.118237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32, now test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56)
[0m09:37:16.119970 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:37:16.121410 [debug] [Thread-4 (]: Began running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:37:16.123472 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_telegram_messages_message_id ......................... [[32mPASS[0m in 2.33s]
[0m09:37:16.124732 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:37:16.125628 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:37:16.126951 [info ] [Thread-4 (]: 10 of 12 START test unique_dim_dates_date_key .................................. [RUN]
[0m09:37:16.128331 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:37:16.135138 [info ] [Thread-3 (]: 11 of 12 START test unique_fct_messages_message_id ............................. [RUN]
[0m09:37:16.137204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a, now test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d)
[0m09:37:16.157153 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:37:16.153744 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m09:37:16.155826 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62, now test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d)
[0m09:37:16.144806 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:37:16.166574 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m09:37:16.168616 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:37:16.170376 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:37:16.181027 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m09:37:16.171977 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_telegram_messages_message_id .................... [RUN]
[0m09:37:16.174259 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:37:16.195718 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m09:37:16.197270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1)
[0m09:37:16.303780 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m09:37:16.308259 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m09:37:16.306787 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:37:16.305501 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:37:16.310278 [debug] [Thread-2 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_key as unique_field,
    count(*) as n_records

from "neondb"."public"."dim_channels"
where channel_key is not null
group by channel_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:37:16.316963 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m09:37:16.319808 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m09:37:16.323686 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m09:37:16.324449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:37:16.325812 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "neondb"."public"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:37:16.328176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:37:16.330099 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m09:37:16.331139 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:37:16.331813 [debug] [Thread-3 (]: On test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "neondb"."public"."fct_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:37:16.335493 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m09:37:16.336631 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:37:16.338564 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m09:37:16.339659 [debug] [Thread-1 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "neondb"."public"."stg_telegram_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:37:16.340981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:18.261541 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.925 seconds
[0m09:37:18.263891 [debug] [Thread-3 (]: On test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d: ROLLBACK
[0m09:37:18.265016 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.941 seconds
[0m09:37:18.267460 [debug] [Thread-2 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: ROLLBACK
[0m09:37:18.269497 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.929 seconds
[0m09:37:18.268494 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.940 seconds
[0m09:37:18.271817 [debug] [Thread-1 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: ROLLBACK
[0m09:37:18.273911 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m09:37:18.491634 [debug] [Thread-3 (]: On test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d: Close
[0m09:37:18.493040 [info ] [Thread-3 (]: 11 of 12 PASS unique_fct_messages_message_id ................................... [[32mPASS[0m in 2.34s]
[0m09:37:18.494358 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:37:18.495254 [debug] [Thread-2 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: Close
[0m09:37:18.496513 [info ] [Thread-2 (]: 9 of 12 PASS unique_dim_channels_channel_key ................................... [[32mPASS[0m in 2.38s]
[0m09:37:18.497511 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:37:18.500294 [debug] [Thread-1 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: Close
[0m09:37:18.502099 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_telegram_messages_message_id .......................... [[32mPASS[0m in 2.30s]
[0m09:37:18.503966 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:37:18.505195 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d: Close
[0m09:37:18.507061 [info ] [Thread-4 (]: 10 of 12 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 2.37s]
[0m09:37:18.508495 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:37:18.511210 [debug] [MainThread]: On master: COMMIT
[0m09:37:18.512141 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:18.512901 [debug] [MainThread]: On master: COMMIT
[0m09:37:18.513630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:37:20.428094 [debug] [MainThread]: SQL status: COMMIT in 1.914 seconds
[0m09:37:20.428885 [debug] [MainThread]: On master: Close
[0m09:37:20.430125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:20.430859 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1' was properly closed.
[0m09:37:20.431484 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56' was properly closed.
[0m09:37:20.432166 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d' was properly closed.
[0m09:37:20.432861 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d' was properly closed.
[0m09:37:20.433560 [info ] [MainThread]: 
[0m09:37:20.434297 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 14.11 seconds (14.11s).
[0m09:37:20.437753 [debug] [MainThread]: Command end result
[0m09:37:20.534186 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:37:20.538631 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:37:20.551503 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m09:37:20.552336 [info ] [MainThread]: 
[0m09:37:20.553736 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:37:20.554597 [info ] [MainThread]: 
[0m09:37:20.555428 [error] [MainThread]: [31mFailure in test relationships_fct_messages_date_key__date_key__ref_dim_dates_ (models/schema.yml)[0m
[0m09:37:20.556466 [error] [MainThread]:   Got 76 results, configured to fail if != 0
[0m09:37:20.557349 [info ] [MainThread]: 
[0m09:37:20.558530 [info ] [MainThread]:   compiled code at target/compiled/medical_warehouse/models/schema.yml/relationships_fct_messages_date_key__date_key__ref_dim_dates_.sql
[0m09:37:20.559642 [info ] [MainThread]: 
[0m09:37:20.560811 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m09:37:20.562556 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 15.531962, "process_in_blocks": "49480", "process_kernel_time": 0.420688, "process_mem_max_rss": "128420", "process_out_blocks": "2312", "process_user_time": 4.334483}
[0m09:37:20.563512 [debug] [MainThread]: Command `dbt test` failed at 09:37:20.563346 after 15.53 seconds
[0m09:37:20.564590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2d9890a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2d98af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d2d9898b0>]}
[0m09:37:20.565945 [debug] [MainThread]: Flushing usage events
[0m09:37:22.186582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:56:54.146572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaecb56240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaecd3b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaecd3a4e0>]}


============================== 09:56:54.153011 | 3982511f-dffc-4fc4-99dc-eb244122d067 ==============================
[0m09:56:54.153011 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:56:54.154113 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'empty': 'False', 'introspect': 'True', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True'}
[0m09:56:54.434955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaeb9d1820>]}
[0m09:56:54.533396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaee77bf80>]}
[0m09:56:54.534944 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:56:54.706175 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:56:54.898928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:56:54.900355 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/marts/fct_image_detections.sql
[0m09:56:54.901028 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/marts/fct_messages.sql
[0m09:56:54.901627 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models/marts/dim_dates.sql
[0m09:56:55.292941 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fct_image_detections' in package 'medical_warehouse' (models/schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m09:56:55.293798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaea5bc770>]}
[0m09:56:55.602846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adae9de7b60>]}
[0m09:56:55.752460 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:56:55.754798 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:56:55.867144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaea17a030>]}
[0m09:56:55.868648 [info ] [MainThread]: Found 5 models, 12 data tests, 2 sources, 464 macros
[0m09:56:55.870067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaea19e660>]}
[0m09:56:55.874141 [info ] [MainThread]: 
[0m09:56:55.875278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:56:55.876265 [info ] [MainThread]: 
[0m09:56:55.877651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:55.885885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m09:56:55.982206 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m09:56:55.983495 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m09:56:55.984599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:58.833554 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.849 seconds
[0m09:56:58.835740 [debug] [ThreadPool]: On list_neondb: Close
[0m09:56:58.838330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m09:56:58.847766 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m09:56:58.848404 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:56:58.848948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:00.866029 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.017 seconds
[0m09:57:00.868525 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m09:57:01.100628 [debug] [ThreadPool]: On list_neondb_public: Close
[0m09:57:01.110318 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:01.111695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:57:01.112983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:03.185218 [debug] [MainThread]: SQL status: SELECT 1 in 2.072 seconds
[0m09:57:03.190047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adae9dc3c50>]}
[0m09:57:03.191173 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:03.420091 [debug] [MainThread]: On master: COMMIT
[0m09:57:03.420906 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:03.421477 [debug] [MainThread]: On master: COMMIT
[0m09:57:03.880629 [debug] [MainThread]: SQL status: COMMIT in 0.459 seconds
[0m09:57:03.881417 [debug] [MainThread]: On master: Close
[0m09:57:03.885461 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m09:57:03.886724 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m09:57:03.887606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.stg_telegram_messages)
[0m09:57:03.888230 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m09:57:03.900934 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m09:57:03.902097 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m09:57:03.979860 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m09:57:03.982393 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:57:03.983590 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m09:57:03.984901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:06.020101 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 2.035 seconds
[0m09:57:06.030320 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:57:06.031016 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m09:57:06.263584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.232 seconds
[0m09:57:06.274878 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:57:06.278035 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m09:57:06.506089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.226 seconds
[0m09:57:06.556433 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m09:57:06.558000 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:57:06.559441 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m09:57:06.782737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.221 seconds
[0m09:57:06.792292 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m09:57:06.803262 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m09:57:06.804059 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m09:57:07.060751 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.256 seconds
[0m09:57:07.066815 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m09:57:07.071543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaeeddc290>]}
[0m09:57:07.073733 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 3.18s]
[0m09:57:07.075594 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m09:57:07.077517 [debug] [Thread-3 (]: Began running node model.medical_warehouse.dim_channels
[0m09:57:07.078710 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_dates
[0m09:57:07.079763 [debug] [Thread-2 (]: Began running node model.medical_warehouse.fct_image_detections
[0m09:57:07.081052 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m09:57:07.082154 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_channels ............................... [RUN]
[0m09:57:07.083600 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_dates .................................. [RUN]
[0m09:57:07.084935 [info ] [Thread-2 (]: 4 of 5 START sql table model public.fct_image_detections ....................... [RUN]
[0m09:57:07.086204 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fct_messages ............................... [RUN]
[0m09:57:07.087749 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m09:57:07.089046 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_dates'
[0m09:57:07.090574 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m09:57:07.095578 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m09:57:07.092691 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.dim_channels
[0m09:57:07.094399 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_dates
[0m09:57:07.091730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.fct_messages)
[0m09:57:07.129687 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m09:57:07.102429 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m09:57:07.128196 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m09:57:07.122352 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m09:57:07.135549 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m09:57:07.137817 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.dim_channels
[0m09:57:07.139027 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_dates
[0m09:57:07.140218 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m09:57:07.152633 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m09:57:07.256620 [debug] [Thread-3 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m09:57:07.259831 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m09:57:07.261355 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m09:57:07.263045 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m09:57:07.264700 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m09:57:07.265778 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:57:07.267437 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "neondb"."public"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    /*
  Enriched fact table: links YOLO image categories to messages.
  Enables analysis like: "Do promotional posts get more views?"
*/
select
    y.message_id::bigint,
    md5(y.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    y.detected_objects,
    y.confidence_score,
    y.image_category
from "neondb"."raw"."yolo_detections" y
join "neondb"."public"."stg_telegram_messages" s
    on y.message_id::text = s.message_id::text
    and y.channel_name = s.channel_name
  );
  
[0m09:57:07.269737 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:57:07.268603 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:57:07.271002 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m09:57:07.272240 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:57:07.273011 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m09:57:07.274022 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql
with date_range as (
    select 
        min(message_date)::date as min_date,
        max(message_date)::date as max_date
    from "neondb"."public"."stg_telegram_messages"
),
date_series as (
    select generate_series(
        (select min_date - 30 from date_range),   -- 30 days before earliest message
        (select max_date + 30 from date_range),   -- 30 days after latest message
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    trim(to_char(full_date, 'Day')) as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    trim(to_char(full_date, 'Month')) as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from date_series
  );
  
[0m09:57:07.277043 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:57:07.274787 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:57:07.276033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:09.261666 [debug] [Thread-3 (]: SQL status: SELECT 3 in 1.987 seconds
[0m09:57:09.274130 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:57:09.275042 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m09:57:09.286462 [debug] [Thread-4 (]: SQL status: SELECT 1291 in 2.009 seconds
[0m09:57:09.291628 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:57:09.292518 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m09:57:09.325323 [debug] [Thread-1 (]: SQL status: SELECT 276 in 2.049 seconds
[0m09:57:09.333266 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:57:09.335066 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages" rename to "fct_messages__dbt_backup"
[0m09:57:09.516722 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.241 seconds
[0m09:57:09.517417 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.224 seconds
[0m09:57:09.521979 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:57:09.527014 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:57:09.527960 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m09:57:09.528687 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m09:57:09.564420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.228 seconds
[0m09:57:09.581315 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:57:09.582864 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m09:57:09.765530 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.236 seconds
[0m09:57:09.774553 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m09:57:09.779142 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:57:09.782023 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m09:57:09.807769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.223 seconds
[0m09:57:09.820143 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m09:57:09.824108 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:57:09.825383 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m09:57:10.022324 [debug] [Thread-4 (]: SQL status: COMMIT in 0.239 seconds
[0m09:57:10.034775 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m09:57:10.043769 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m09:57:10.045579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.218 seconds
[0m09:57:10.046948 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m09:57:10.050869 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."fct_messages__dbt_backup"
[0m09:57:10.052435 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m09:57:10.053100 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "neondb"."public"."fct_messages__dbt_backup" cascade
[0m09:57:10.061593 [debug] [Thread-2 (]: SQL status: SELECT 133 in 2.789 seconds
[0m09:57:10.066628 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m09:57:10.067352 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "neondb"."public"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m09:57:10.260261 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.731 seconds
[0m09:57:10.264777 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m09:57:10.265759 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:57:10.266313 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m09:57:10.285872 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.234 seconds
[0m09:57:10.287878 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: Close
[0m09:57:10.288486 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.235 seconds
[0m09:57:10.290645 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m09:57:10.291399 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adae150e750>]}
[0m09:57:10.295361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adae152faa0>]}
[0m09:57:10.293741 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_dates ............................. [[32mSELECT 1291[0m in 3.20s]
[0m09:57:10.297328 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fct_messages .......................... [[32mSELECT 276[0m in 3.20s]
[0m09:57:10.299115 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_dates
[0m09:57:10.300157 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m09:57:10.502471 [debug] [Thread-3 (]: SQL status: COMMIT in 0.235 seconds
[0m09:57:10.507073 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m09:57:10.508877 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m09:57:10.509546 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m09:57:10.788642 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.278 seconds
[0m09:57:10.790884 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: Close
[0m09:57:10.792064 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adae8910b30>]}
[0m09:57:10.793125 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 3.70s]
[0m09:57:10.794366 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.dim_channels
[0m09:57:10.811091 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.743 seconds
[0m09:57:10.819631 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m09:57:10.820868 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "neondb"."public"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m09:57:11.047747 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.226 seconds
[0m09:57:11.055484 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m09:57:11.057184 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m09:57:11.057902 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m09:57:11.291194 [debug] [Thread-2 (]: SQL status: COMMIT in 0.233 seconds
[0m09:57:11.294750 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."fct_image_detections__dbt_backup"
[0m09:57:11.296012 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m09:57:11.296575 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
drop table if exists "neondb"."public"."fct_image_detections__dbt_backup" cascade
[0m09:57:11.540912 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.243 seconds
[0m09:57:11.543921 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: Close
[0m09:57:11.545651 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3982511f-dffc-4fc4-99dc-eb244122d067', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adae895bc20>]}
[0m09:57:11.547512 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.fct_image_detections .................. [[32mSELECT 133[0m in 4.46s]
[0m09:57:11.549379 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m09:57:11.551401 [debug] [MainThread]: On master: COMMIT
[0m09:57:11.552183 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:11.552839 [debug] [MainThread]: On master: COMMIT
[0m09:57:11.553708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:13.481668 [debug] [MainThread]: SQL status: COMMIT in 1.928 seconds
[0m09:57:13.482758 [debug] [MainThread]: On master: Close
[0m09:57:13.483792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:13.484391 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m09:57:13.484922 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m09:57:13.485425 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_dates' was properly closed.
[0m09:57:13.485942 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m09:57:13.486645 [info ] [MainThread]: 
[0m09:57:13.487542 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 17.61 seconds (17.61s).
[0m09:57:13.489643 [debug] [MainThread]: Command end result
[0m09:57:13.534753 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:57:13.538504 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:57:13.551897 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m09:57:13.553114 [info ] [MainThread]: 
[0m09:57:13.554393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:13.555420 [info ] [MainThread]: 
[0m09:57:13.556519 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m09:57:13.557858 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:57:13.578439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.513395, "process_in_blocks": "74080", "process_kernel_time": 0.388203, "process_mem_max_rss": "132108", "process_out_blocks": "3144", "process_user_time": 4.538377}
[0m09:57:13.580469 [debug] [MainThread]: Command `dbt run` succeeded at 09:57:13.580060 after 19.52 seconds
[0m09:57:13.581954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaed4323f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adae9d95a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adaea5de180>]}
[0m09:57:13.583492 [debug] [MainThread]: Flushing usage events
[0m09:57:15.508928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:29.823879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9fb9f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9f469eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9f49a150>]}


============================== 09:57:29.832252 | 5294ed89-004e-4289-9fcf-28833837f943 ==============================
[0m09:57:29.832252 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:57:29.834568 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'no_print': 'None', 'debug': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'warn_error': 'None', 'write_json': 'True', 'static_parser': 'True', 'target_path': 'None', 'empty': 'None', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse'}
[0m09:57:30.300505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5294ed89-004e-4289-9fcf-28833837f943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9f49a150>]}
[0m09:57:30.431865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5294ed89-004e-4289-9fcf-28833837f943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9ec80530>]}
[0m09:57:30.433265 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:57:30.634051 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:57:30.853436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:30.854087 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:57:30.854634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:30.934531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5294ed89-004e-4289-9fcf-28833837f943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9dfc10a0>]}
[0m09:57:31.104049 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:57:31.106402 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:57:31.141553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5294ed89-004e-4289-9fcf-28833837f943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9cb8b290>]}
[0m09:57:31.142455 [info ] [MainThread]: Found 5 models, 12 data tests, 2 sources, 464 macros
[0m09:57:31.143536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5294ed89-004e-4289-9fcf-28833837f943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9df79880>]}
[0m09:57:31.147492 [info ] [MainThread]: 
[0m09:57:31.148366 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:31.149118 [info ] [MainThread]: 
[0m09:57:31.150184 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:31.156844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public'
[0m09:57:31.232350 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m09:57:31.233853 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:57:31.235133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:33.183192 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.948 seconds
[0m09:57:33.185696 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m09:57:33.421329 [debug] [ThreadPool]: On list_neondb_public: Close
[0m09:57:33.430507 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:33.431246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:57:33.431842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:35.343435 [debug] [MainThread]: SQL status: SELECT 1 in 1.911 seconds
[0m09:57:35.347207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5294ed89-004e-4289-9fcf-28833837f943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9cbd19d0>]}
[0m09:57:35.348576 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:35.576021 [debug] [MainThread]: On master: COMMIT
[0m09:57:35.577446 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:35.578725 [debug] [MainThread]: On master: COMMIT
[0m09:57:36.061443 [debug] [MainThread]: SQL status: COMMIT in 0.481 seconds
[0m09:57:36.062614 [debug] [MainThread]: On master: Close
[0m09:57:36.067436 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m09:57:36.068311 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:57:36.070081 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:57:36.075318 [info ] [Thread-2 (]: 2 of 12 START test not_null_dim_channels_channel_key ........................... [RUN]
[0m09:57:36.069062 [info ] [Thread-1 (]: 1 of 12 START test assert_no_future_messages ................................... [RUN]
[0m09:57:36.079813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now test.medical_warehouse.assert_no_future_messages)
[0m09:57:36.071501 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:57:36.078270 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0'
[0m09:57:36.081193 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m09:57:36.076491 [info ] [Thread-3 (]: 3 of 12 START test not_null_dim_dates_date_key ................................. [RUN]
[0m09:57:36.095707 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348'
[0m09:57:36.083954 [info ] [Thread-4 (]: 4 of 12 START test not_null_fct_messages_message_id ............................ [RUN]
[0m09:57:36.086220 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:57:36.097016 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:57:36.108881 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_fct_messages_message_id.de346706b5'
[0m09:57:36.111267 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m09:57:36.152239 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:57:36.182013 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m09:57:36.177327 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m09:57:36.183319 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m09:57:36.192919 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:57:36.197352 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m09:57:36.199138 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:57:36.215720 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:57:36.327837 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m09:57:36.332260 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m09:57:36.330564 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.assert_no_future_messages"
[0m09:57:36.333387 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "neondb"."public"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m09:57:36.340608 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.assert_no_future_messages"
[0m09:57:36.361066 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:57:36.362557 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.assert_no_future_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
  CUSTOM TEST: No messages should have future dates
  This enforces a business rule: data must be from the past/present
  PASS = returns 0 rows
*/

select *
from "neondb"."public"."stg_telegram_messages"
where message_date > current_timestamp
  
  
      
    ) dbt_internal_test
[0m09:57:36.366733 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m09:57:36.369766 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m09:57:36.371491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:36.373282 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m09:57:36.375235 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_key
from "neondb"."public"."dim_channels"
where channel_key is null



  
  
      
    ) dbt_internal_test
[0m09:57:36.377250 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:57:36.378820 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m09:57:36.382324 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "neondb"."public"."fct_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m09:57:36.384275 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:57:38.373325 [debug] [Thread-3 (]: SQL status: SELECT 1 in 2.012 seconds
[0m09:57:38.380111 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.996 seconds
[0m09:57:38.381196 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.004 seconds
[0m09:57:38.383396 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m09:57:38.384069 [debug] [Thread-1 (]: SQL status: SELECT 1 in 2.013 seconds
[0m09:57:38.386736 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m09:57:38.389571 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: ROLLBACK
[0m09:57:38.391947 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: ROLLBACK
[0m09:57:38.616998 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: Close
[0m09:57:38.619210 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348: Close
[0m09:57:38.618332 [info ] [Thread-4 (]: 4 of 12 PASS not_null_fct_messages_message_id .................................. [[32mPASS[0m in 2.51s]
[0m09:57:38.620841 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:57:38.622736 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:57:38.621794 [info ] [Thread-3 (]: 3 of 12 PASS not_null_dim_dates_date_key ....................................... [[32mPASS[0m in 2.53s]
[0m09:57:38.626278 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:57:38.628241 [debug] [Thread-3 (]: Began running node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:57:38.624155 [info ] [Thread-4 (]: 5 of 12 START test not_null_stg_telegram_messages_message_id ................... [RUN]
[0m09:57:38.633534 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_message_id.de346706b5, now test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m09:57:38.634925 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:57:38.636356 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: Close
[0m09:57:38.648347 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m09:57:38.649138 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: Close
[0m09:57:38.632319 [info ] [Thread-3 (]: 6 of 12 START test relationships_fct_image_detections_message_id__message_id__ref_fct_messages_  [RUN]
[0m09:57:38.652102 [info ] [Thread-2 (]: 2 of 12 PASS not_null_dim_channels_channel_key ................................. [[32mPASS[0m in 2.57s]
[0m09:57:38.660172 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:57:38.655429 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:57:38.657357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348, now test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62)
[0m09:57:38.669612 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:57:38.654465 [info ] [Thread-1 (]: 1 of 12 PASS assert_no_future_messages ......................................... [[32mPASS[0m in 2.57s]
[0m09:57:38.661448 [debug] [Thread-2 (]: Began running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:57:38.687338 [info ] [Thread-2 (]: 7 of 12 START test relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [RUN]
[0m09:57:38.688641 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0, now test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a)
[0m09:57:38.678009 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m09:57:38.679801 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m09:57:38.690017 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:57:38.694271 [debug] [Thread-1 (]: Began running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:57:38.692650 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m09:57:38.727436 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "neondb"."public"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m09:57:38.712646 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m09:57:38.723553 [info ] [Thread-1 (]: 8 of 12 START test relationships_fct_messages_date_key__date_key__ref_dim_dates_  [RUN]
[0m09:57:38.721205 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m09:57:38.728930 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:57:38.737453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32)
[0m09:57:38.731299 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:57:38.739572 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:57:38.741154 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:57:38.774825 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m09:57:38.764354 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m09:57:38.787618 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m09:57:38.784947 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m09:57:38.783884 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m09:57:38.789032 [debug] [Thread-3 (]: On test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select message_id as from_field
    from "neondb"."public"."fct_image_detections"
    where message_id is not null
),

parent as (
    select message_id as to_field
    from "neondb"."public"."fct_messages"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:57:38.796566 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:57:38.795393 [debug] [Thread-2 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_key as from_field
    from "neondb"."public"."fct_messages"
    where channel_key is not null
),

parent as (
    select channel_key as to_field
    from "neondb"."public"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:57:38.798721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:38.794107 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:57:38.808937 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m09:57:38.811278 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m09:57:38.812981 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_key as from_field
    from "neondb"."public"."fct_messages"
    where date_key is not null
),

parent as (
    select date_key as to_field
    from "neondb"."public"."dim_dates"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:57:38.816504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:40.612876 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.884 seconds
[0m09:57:40.617103 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m09:57:40.742472 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.943 seconds
[0m09:57:40.748194 [debug] [Thread-2 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: ROLLBACK
[0m09:57:40.749380 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.953 seconds
[0m09:57:40.752403 [debug] [Thread-3 (]: On test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62: ROLLBACK
[0m09:57:40.852179 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m09:57:40.853558 [info ] [Thread-4 (]: 5 of 12 PASS not_null_stg_telegram_messages_message_id ......................... [[32mPASS[0m in 2.22s]
[0m09:57:40.854778 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:57:40.855516 [debug] [Thread-4 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:57:40.856254 [info ] [Thread-4 (]: 9 of 12 START test unique_dim_channels_channel_key ............................. [RUN]
[0m09:57:40.857115 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56)
[0m09:57:40.857731 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:57:40.877211 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m09:57:40.879158 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:57:40.885086 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m09:57:40.886789 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m09:57:40.887843 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_key as unique_field,
    count(*) as n_records

from "neondb"."public"."dim_channels"
where channel_key is not null
group by channel_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:57:40.889028 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:57:40.982119 [debug] [Thread-2 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: Close
[0m09:57:40.985535 [debug] [Thread-3 (]: On test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62: Close
[0m09:57:40.984374 [info ] [Thread-2 (]: 7 of 12 PASS relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [[32mPASS[0m in 2.30s]
[0m09:57:40.990481 [info ] [Thread-3 (]: 6 of 12 PASS relationships_fct_image_detections_message_id__message_id__ref_fct_messages_  [[32mPASS[0m in 2.33s]
[0m09:57:40.994198 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:57:40.996862 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:57:40.998358 [debug] [Thread-2 (]: Began running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:57:41.000692 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:57:41.002250 [info ] [Thread-2 (]: 10 of 12 START test unique_dim_dates_date_key .................................. [RUN]
[0m09:57:41.004719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a, now test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d)
[0m09:57:41.003346 [info ] [Thread-3 (]: 11 of 12 START test unique_fct_messages_message_id ............................. [RUN]
[0m09:57:41.006347 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:57:41.007725 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62, now test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d)
[0m09:57:41.040981 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:57:41.056362 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m09:57:41.060376 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:57:41.209377 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m09:57:41.214714 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m09:57:41.217899 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m09:57:41.219583 [debug] [Thread-2 (]: On test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "neondb"."public"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:57:41.221189 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:41.223131 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:57:41.231817 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m09:57:41.233637 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m09:57:41.235096 [debug] [Thread-3 (]: On test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "neondb"."public"."fct_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:57:41.236478 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:57:41.305161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 2.489 seconds
[0m09:57:41.311838 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32: ROLLBACK
[0m09:57:41.542001 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32: Close
[0m09:57:41.544033 [info ] [Thread-1 (]: 8 of 12 PASS relationships_fct_messages_date_key__date_key__ref_dim_dates_ ..... [[32mPASS[0m in 2.81s]
[0m09:57:41.545651 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:57:41.546871 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:57:41.547857 [info ] [Thread-1 (]: 12 of 12 START test unique_stg_telegram_messages_message_id .................... [RUN]
[0m09:57:41.548910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32, now test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1)
[0m09:57:41.549727 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:57:41.557740 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m09:57:41.559277 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:57:41.565829 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m09:57:41.567511 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m09:57:41.568741 [debug] [Thread-1 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "neondb"."public"."stg_telegram_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:57:41.569822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:42.782869 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.894 seconds
[0m09:57:42.787558 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: ROLLBACK
[0m09:57:43.029875 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: Close
[0m09:57:43.031301 [info ] [Thread-4 (]: 9 of 12 PASS unique_dim_channels_channel_key ................................... [[32mPASS[0m in 2.17s]
[0m09:57:43.033042 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:57:43.142726 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.921 seconds
[0m09:57:43.146588 [debug] [Thread-2 (]: On test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m09:57:43.147314 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.911 seconds
[0m09:57:43.149841 [debug] [Thread-3 (]: On test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d: ROLLBACK
[0m09:57:43.383575 [debug] [Thread-3 (]: On test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d: Close
[0m09:57:43.384496 [debug] [Thread-2 (]: On test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d: Close
[0m09:57:43.385934 [info ] [Thread-2 (]: 10 of 12 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 2.38s]
[0m09:57:43.387204 [info ] [Thread-3 (]: 11 of 12 PASS unique_fct_messages_message_id ................................... [[32mPASS[0m in 2.38s]
[0m09:57:43.388527 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:57:43.389716 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:57:43.503266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.933 seconds
[0m09:57:43.505311 [debug] [Thread-1 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: ROLLBACK
[0m09:57:43.741302 [debug] [Thread-1 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: Close
[0m09:57:43.743560 [info ] [Thread-1 (]: 12 of 12 PASS unique_stg_telegram_messages_message_id .......................... [[32mPASS[0m in 2.19s]
[0m09:57:43.745528 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:57:43.747760 [debug] [MainThread]: On master: COMMIT
[0m09:57:43.748442 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:43.748987 [debug] [MainThread]: On master: COMMIT
[0m09:57:43.749578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:45.661851 [debug] [MainThread]: SQL status: COMMIT in 1.912 seconds
[0m09:57:45.662602 [debug] [MainThread]: On master: Close
[0m09:57:45.663725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:45.664326 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1' was properly closed.
[0m09:57:45.664855 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d' was properly closed.
[0m09:57:45.665370 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d' was properly closed.
[0m09:57:45.665912 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56' was properly closed.
[0m09:57:45.666533 [info ] [MainThread]: 
[0m09:57:45.667389 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 14.52 seconds (14.52s).
[0m09:57:45.672137 [debug] [MainThread]: Command end result
[0m09:57:45.735066 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:57:45.739287 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:57:45.755811 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m09:57:45.756680 [info ] [MainThread]: 
[0m09:57:45.757569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:45.758526 [info ] [MainThread]: 
[0m09:57:45.759745 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m09:57:45.762523 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 16.048218, "process_in_blocks": "1128", "process_kernel_time": 0.348695, "process_mem_max_rss": "129264", "process_out_blocks": "2312", "process_user_time": 4.70343}
[0m09:57:45.763752 [debug] [MainThread]: Command `dbt test` succeeded at 09:57:45.763509 after 16.05 seconds
[0m09:57:45.764755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9fb78830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9b9b0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9b9b0140>]}
[0m09:57:45.772133 [debug] [MainThread]: Flushing usage events
[0m09:57:46.853987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:50.334640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b457a7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b43fdd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b43fdf830>]}


============================== 09:58:50.340364 | e874b69f-752c-47a6-816c-b7bc0db71b01 ==============================
[0m09:58:50.340364 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:58:50.341491 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'write_json': 'True', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_format': 'default'}
[0m09:58:50.601620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e874b69f-752c-47a6-816c-b7bc0db71b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b44177170>]}
[0m09:58:50.691256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e874b69f-752c-47a6-816c-b7bc0db71b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b4389deb0>]}
[0m09:58:50.692606 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:58:50.855296 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:58:51.043019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:51.043619 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m09:58:51.044149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:51.111103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e874b69f-752c-47a6-816c-b7bc0db71b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b429ad430>]}
[0m09:58:51.138059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e874b69f-752c-47a6-816c-b7bc0db71b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b41ddb440>]}
[0m09:58:51.138786 [info ] [MainThread]: Found 5 models, 12 data tests, 2 sources, 464 macros
[0m09:58:51.139434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e874b69f-752c-47a6-816c-b7bc0db71b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b440cf140>]}
[0m09:58:51.142494 [info ] [MainThread]: 
[0m09:58:51.143324 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:58:51.144006 [info ] [MainThread]: 
[0m09:58:51.145264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:58:51.152619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public'
[0m09:58:51.242593 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m09:58:51.246562 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:58:51.247485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:53.238213 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.991 seconds
[0m09:58:53.241046 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m09:58:53.468837 [debug] [ThreadPool]: On list_neondb_public: Close
[0m09:58:53.475855 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:53.476529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:58:53.477133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:58:56.513407 [debug] [MainThread]: SQL status: SELECT 1 in 3.036 seconds
[0m09:58:56.517064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e874b69f-752c-47a6-816c-b7bc0db71b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b42da8140>]}
[0m09:58:56.517927 [debug] [MainThread]: On master: ROLLBACK
[0m09:58:56.750358 [debug] [MainThread]: On master: Close
[0m09:58:56.797780 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m09:58:56.798634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.stg_telegram_messages)
[0m09:58:56.799336 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m09:58:56.809254 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m09:58:56.810460 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m09:58:56.812084 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m09:58:56.813778 [debug] [Thread-3 (]: Began running node model.medical_warehouse.dim_channels
[0m09:58:56.814441 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_dates
[0m09:58:56.815200 [debug] [Thread-2 (]: Began running node model.medical_warehouse.fct_image_detections
[0m09:58:56.815788 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m09:58:56.816651 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m09:58:56.817736 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_dates'
[0m09:58:56.818536 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m09:58:56.819210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.fct_messages)
[0m09:58:56.819968 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.dim_channels
[0m09:58:56.820717 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_dates
[0m09:58:56.821358 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m09:58:56.822058 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m09:58:56.825780 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m09:58:56.830335 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m09:58:56.835361 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m09:58:56.841111 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m09:58:56.842346 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.dim_channels
[0m09:58:56.843142 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_dates
[0m09:58:56.844751 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m09:58:56.845625 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m09:58:56.847047 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.dim_channels
[0m09:58:56.848076 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_dates
[0m09:58:56.849126 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m09:58:56.850329 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m09:58:56.851157 [debug] [Thread-3 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m09:58:56.852236 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:58:56.853806 [debug] [Thread-2 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:58:56.854801 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:58:56.856142 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now test.medical_warehouse.assert_no_future_messages)
[0m09:58:56.856964 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m09:58:56.857683 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fct_image_detections, now test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1)
[0m09:58:56.858701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fct_messages, now test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0)
[0m09:58:56.859644 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m09:58:56.860874 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:58:56.861802 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:58:56.862557 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:58:56.866364 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m09:58:56.885945 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m09:58:56.895469 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m09:58:56.902537 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m09:58:56.904183 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m09:58:56.905209 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:58:56.906582 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m09:58:56.908009 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m09:58:56.908623 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:58:56.909298 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:58:56.910288 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:58:56.911398 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:58:56.912657 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m09:58:56.914492 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m09:58:56.915661 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56)
[0m09:58:56.916788 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348)
[0m09:58:56.917490 [debug] [Thread-2 (]: Began running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:58:56.918208 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:58:56.919028 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:58:56.919919 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:58:56.920561 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1, now test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d)
[0m09:58:56.921321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0, now test.medical_warehouse.not_null_fct_messages_message_id.de346706b5)
[0m09:58:56.927563 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m09:58:56.933586 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m09:58:56.934490 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:58:56.935273 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:58:56.941188 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m09:58:56.942039 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:58:56.948015 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:58:56.949252 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m09:58:56.950433 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m09:58:56.951478 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m09:58:56.952180 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:58:56.952987 [debug] [Thread-3 (]: Began running node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:58:56.953783 [debug] [Thread-4 (]: Began running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:58:56.954617 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:58:56.956029 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m09:58:56.956988 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56, now test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62)
[0m09:58:56.958083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348, now test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a)
[0m09:58:56.959867 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m09:58:56.961060 [debug] [Thread-2 (]: Began running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:58:56.962442 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:58:56.963741 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:58:56.965063 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:58:56.966299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d, now test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32)
[0m09:58:56.983319 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m09:58:56.993146 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m09:58:56.994046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_message_id.de346706b5, now test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d)
[0m09:58:56.995141 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:58:56.996367 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:58:56.997337 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:58:57.005107 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m09:58:57.005799 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:58:57.012229 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m09:58:57.013398 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m09:58:57.015119 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m09:58:57.015997 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:58:57.017117 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:58:57.018366 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m09:58:57.019763 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m09:58:57.022572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:57.023175 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d' was properly closed.
[0m09:58:57.023657 [debug] [MainThread]: Connection 'test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62' was properly closed.
[0m09:58:57.024141 [debug] [MainThread]: Connection 'test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a' was properly closed.
[0m09:58:57.024609 [debug] [MainThread]: Connection 'test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32' was properly closed.
[0m09:58:57.027998 [debug] [MainThread]: Command end result
[0m09:58:57.174928 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:58:57.177463 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:58:57.188114 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m09:58:57.195350 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m09:58:57.196007 [info ] [MainThread]: Building catalog
[0m09:58:57.209011 [debug] [ThreadPool]: Acquiring new postgres connection 'neondb.information_schema'
[0m09:58:57.222261 [debug] [ThreadPool]: Using postgres connection "neondb.information_schema"
[0m09:58:57.223521 [debug] [ThreadPool]: On neondb.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "neondb.information_schema"} */

    
    

    select
        'neondb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_telegram_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_image_detections')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('yolo_detections')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_dates')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m09:58:57.224554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:59.836901 [debug] [ThreadPool]: SQL status: SELECT 52 in 2.612 seconds
[0m09:58:59.868535 [debug] [ThreadPool]: On neondb.information_schema: ROLLBACK
[0m09:59:00.109268 [debug] [ThreadPool]: On neondb.information_schema: Close
[0m09:59:00.190945 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m09:59:00.374403 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m09:59:00.378394 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m09:59:00.379472 [info ] [MainThread]: Catalog written to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/catalog.json
[0m09:59:00.381898 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 10.12501, "process_in_blocks": "53272", "process_kernel_time": 0.337405, "process_mem_max_rss": "125816", "process_out_blocks": "5624", "process_user_time": 3.499836}
[0m09:59:00.383631 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:59:00.383378 after 10.13 seconds
[0m09:59:00.384654 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:59:00.385602 [debug] [MainThread]: Connection 'neondb.information_schema' was properly closed.
[0m09:59:00.386667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b43ca7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b45494320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781b404cbc20>]}
[0m09:59:00.387804 [debug] [MainThread]: Flushing usage events
[0m09:59:01.916723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:05.121819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72adf2df8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72adf2057770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72adf1fc8560>]}


============================== 09:59:05.126056 | 2c0de889-6113-4681-b05c-169ddf886738 ==============================
[0m09:59:05.126056 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:59:05.127324 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'quiet': 'False', 'introspect': 'True', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt docs serve', 'debug': 'False', 'warn_error': 'None'}
[0m09:59:05.449166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c0de889-6113-4681-b05c-169ddf886738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72adf1724080>]}
[0m09:59:05.562955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c0de889-6113-4681-b05c-169ddf886738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72adf18b3590>]}
[0m08:00:47.827381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5206f01190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c520753d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c52071ea600>]}


============================== 08:00:47.861856 | 76f54cc6-185b-40ef-b986-4f4bb395e1fa ==============================
[0m08:00:47.861856 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:00:47.863719 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'empty': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'partial_parse': 'True', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run'}
[0m08:00:48.343300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c52097699a0>]}
[0m08:00:48.603648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5206d240b0>]}
[0m08:00:48.605943 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m08:00:49.001990 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:00:49.379300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:49.382320 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m08:00:49.385473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:49.536198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5205bc4530>]}
[0m08:00:49.816308 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m08:00:49.826658 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m08:00:49.888284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5204f13500>]}
[0m08:00:49.891761 [info ] [MainThread]: Found 5 models, 12 data tests, 2 sources, 464 macros
[0m08:00:49.892850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5205f964b0>]}
[0m08:00:49.897538 [info ] [MainThread]: 
[0m08:00:49.898697 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:00:49.901109 [info ] [MainThread]: 
[0m08:00:49.902477 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:00:49.920235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m08:00:50.109084 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m08:00:50.110370 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m08:00:50.111597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:04.724967 [debug] [ThreadPool]: SQL status: SELECT 5 in 14.613 seconds
[0m08:01:04.730193 [debug] [ThreadPool]: On list_neondb: Close
[0m08:01:04.738768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m08:01:04.754774 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m08:01:04.756206 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:01:04.757082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:01:06.914997 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.158 seconds
[0m08:01:06.918977 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m08:01:07.145923 [debug] [ThreadPool]: On list_neondb_public: Close
[0m08:01:07.172772 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:07.174352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:01:07.176244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:01:09.126149 [debug] [MainThread]: SQL status: SELECT 1 in 1.950 seconds
[0m08:01:09.132219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5205bc44a0>]}
[0m08:01:09.137794 [debug] [MainThread]: On master: ROLLBACK
[0m08:01:09.370854 [debug] [MainThread]: On master: COMMIT
[0m08:01:09.371781 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:09.372487 [debug] [MainThread]: On master: COMMIT
[0m08:01:09.845422 [debug] [MainThread]: SQL status: COMMIT in 0.472 seconds
[0m08:01:09.850174 [debug] [MainThread]: On master: Close
[0m08:01:09.855666 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m08:01:09.857600 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m08:01:09.859241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.stg_telegram_messages)
[0m08:01:09.860096 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m08:01:09.875149 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m08:01:09.876829 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m08:01:09.969425 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m08:01:09.971396 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m08:01:09.972728 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m08:01:09.973933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:12.163180 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 2.189 seconds
[0m08:01:12.184946 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m08:01:12.186378 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m08:01:12.450782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.263 seconds
[0m08:01:12.475274 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m08:01:12.482149 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m08:01:12.724234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.235 seconds
[0m08:01:12.803164 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m08:01:12.806777 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m08:01:12.810998 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m08:01:13.060332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.247 seconds
[0m08:01:13.081367 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m08:01:13.095325 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m08:01:13.096849 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m08:01:13.344315 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.246 seconds
[0m08:01:13.351734 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m08:01:13.358649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5209768a10>]}
[0m08:01:13.360481 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 3.49s]
[0m08:01:13.364802 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m08:01:13.372756 [debug] [Thread-3 (]: Began running node model.medical_warehouse.dim_channels
[0m08:01:13.381594 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_dates
[0m08:01:13.383927 [debug] [Thread-2 (]: Began running node model.medical_warehouse.fct_image_detections
[0m08:01:13.382955 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_dates .................................. [RUN]
[0m08:01:13.389959 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_dates'
[0m08:01:13.393112 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_dates
[0m08:01:13.391767 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m08:01:13.400870 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fct_messages ............................... [RUN]
[0m08:01:13.374266 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_channels ............................... [RUN]
[0m08:01:13.385299 [info ] [Thread-2 (]: 4 of 5 START sql table model public.fct_image_detections ....................... [RUN]
[0m08:01:13.402130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.fct_messages)
[0m08:01:13.412826 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m08:01:13.407186 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m08:01:13.408568 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m08:01:13.446187 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m08:01:13.441598 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.dim_channels
[0m08:01:13.436697 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m08:01:13.447501 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m08:01:13.482810 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_dates
[0m08:01:13.478378 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m08:01:13.496632 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.dim_channels
[0m08:01:13.481384 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m08:01:13.509081 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m08:01:13.484927 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m08:01:13.781347 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m08:01:13.791347 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m08:01:13.808733 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m08:01:13.823593 [debug] [Thread-3 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m08:01:13.826309 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m08:01:13.833659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:13.832085 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m08:01:13.822000 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m08:01:13.828756 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m08:01:13.835587 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m08:01:13.838659 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql
with date_range as (
    select 
        min(message_date)::date as min_date,
        max(message_date)::date as max_date
    from "neondb"."public"."stg_telegram_messages"
),
date_series as (
    select generate_series(
        (select min_date - 30 from date_range),   -- 30 days before earliest message
        (select max_date + 30 from date_range),   -- 30 days after latest message
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    trim(to_char(full_date, 'Day')) as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    trim(to_char(full_date, 'Month')) as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from date_series
  );
  
[0m08:01:13.843247 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:01:13.845538 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m08:01:13.847539 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:01:13.849909 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "neondb"."public"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    /*
  Enriched fact table: links YOLO image categories to messages.
  Enables analysis like: "Do promotional posts get more views?"
*/
select
    y.message_id::bigint,
    md5(y.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    y.detected_objects,
    y.confidence_score,
    y.image_category
from "neondb"."raw"."yolo_detections" y
join "neondb"."public"."stg_telegram_messages" s
    on y.message_id::text = s.message_id::text
    and y.channel_name = s.channel_name
  );
  
[0m08:01:13.852941 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:01:16.044366 [debug] [Thread-2 (]: SQL status: SELECT 133 in 2.191 seconds
[0m08:01:16.067869 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m08:01:16.069217 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "neondb"."public"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m08:01:16.195236 [debug] [Thread-1 (]: SQL status: SELECT 276 in 2.362 seconds
[0m08:01:16.206451 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m08:01:16.207755 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages" rename to "fct_messages__dbt_backup"
[0m08:01:16.215985 [debug] [Thread-4 (]: SQL status: SELECT 1291 in 2.369 seconds
[0m08:01:16.226358 [debug] [Thread-3 (]: SQL status: SELECT 3 in 2.384 seconds
[0m08:01:16.228096 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m08:01:16.239206 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m08:01:16.244014 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m08:01:16.245695 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m08:01:16.325417 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.253 seconds
[0m08:01:16.338802 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m08:01:16.340296 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "neondb"."public"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m08:01:16.444567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.236 seconds
[0m08:01:16.456340 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m08:01:16.457961 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m08:01:16.480909 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.236 seconds
[0m08:01:16.620168 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.278 seconds
[0m08:01:16.621827 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.374 seconds
[0m08:01:16.627351 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m08:01:16.630871 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m08:01:16.640502 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m08:01:16.642838 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m08:01:16.639594 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m08:01:16.644984 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m08:01:16.646841 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m08:01:16.688439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.229 seconds
[0m08:01:16.699012 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m08:01:16.701414 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m08:01:16.704644 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m08:01:16.967661 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.321 seconds
[0m08:01:16.980675 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.332 seconds
[0m08:01:16.984529 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m08:01:16.992242 [debug] [Thread-2 (]: SQL status: COMMIT in 0.344 seconds
[0m08:01:16.995834 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m08:01:16.991339 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m08:01:17.026205 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m08:01:17.027613 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m08:01:17.023318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.317 seconds
[0m08:01:17.011799 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m08:01:17.035348 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."fct_image_detections__dbt_backup"
[0m08:01:17.045281 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."fct_messages__dbt_backup"
[0m08:01:17.054572 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m08:01:17.055709 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "neondb"."public"."fct_messages__dbt_backup" cascade
[0m08:01:17.051723 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m08:01:17.058572 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
drop table if exists "neondb"."public"."fct_image_detections__dbt_backup" cascade
[0m08:01:17.304802 [debug] [Thread-3 (]: SQL status: COMMIT in 0.276 seconds
[0m08:01:17.314100 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.254 seconds
[0m08:01:17.321776 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: Close
[0m08:01:17.322746 [debug] [Thread-4 (]: SQL status: COMMIT in 0.288 seconds
[0m08:01:17.323956 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.266 seconds
[0m08:01:17.326571 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m08:01:17.328955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5203ab0ad0>]}
[0m08:01:17.346195 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.fct_image_detections .................. [[32mSELECT 133[0m in 3.92s]
[0m08:01:17.344109 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m08:01:17.338899 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m08:01:17.342012 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m08:01:17.355323 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m08:01:17.348522 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m08:01:17.351555 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m08:01:17.357079 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m08:01:17.353591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c52008fe930>]}
[0m08:01:17.358864 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fct_messages .......................... [[32mSELECT 276[0m in 3.95s]
[0m08:01:17.363051 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m08:01:17.595087 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.238 seconds
[0m08:01:17.603847 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: Close
[0m08:01:17.611726 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5204b0ba70>]}
[0m08:01:17.615444 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.257 seconds
[0m08:01:17.618316 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: Close
[0m08:01:17.614602 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 4.20s]
[0m08:01:17.620006 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.dim_channels
[0m08:01:17.621532 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f54cc6-185b-40ef-b986-4f4bb395e1fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5203bd6090>]}
[0m08:01:17.623566 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_dates ............................. [[32mSELECT 1291[0m in 4.23s]
[0m08:01:17.625353 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_dates
[0m08:01:17.628774 [debug] [MainThread]: On master: COMMIT
[0m08:01:17.630059 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:17.631212 [debug] [MainThread]: On master: COMMIT
[0m08:01:17.632456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:01:19.601726 [debug] [MainThread]: SQL status: COMMIT in 1.969 seconds
[0m08:01:19.605189 [debug] [MainThread]: On master: Close
[0m08:01:19.607159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:19.608323 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m08:01:19.609092 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_dates' was properly closed.
[0m08:01:19.609753 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m08:01:19.610437 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m08:01:19.611423 [info ] [MainThread]: 
[0m08:01:19.612352 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 29.71 seconds (29.71s).
[0m08:01:19.615460 [debug] [MainThread]: Command end result
[0m08:01:19.664734 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m08:01:19.669090 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m08:01:19.685360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m08:01:19.686469 [info ] [MainThread]: 
[0m08:01:19.687681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:01:19.688555 [info ] [MainThread]: 
[0m08:01:19.689744 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m08:01:19.692740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 32.036083, "process_in_blocks": "45296", "process_kernel_time": 0.609349, "process_mem_max_rss": "129096", "process_out_blocks": "2176", "process_user_time": 5.837961}
[0m08:01:19.697277 [debug] [MainThread]: Command `dbt run` succeeded at 08:01:19.696468 after 32.04 seconds
[0m08:01:19.698446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c520784e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c52072eac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5207b2ab10>]}
[0m08:01:19.702132 [debug] [MainThread]: Flushing usage events
[0m08:01:21.971682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:03.172823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffbf75fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffbfd69af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffbfeb7d10>]}


============================== 15:47:03.191572 | 633a4213-44c5-4056-969b-ba1240cd1b66 ==============================
[0m15:47:03.191572 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:47:03.193765 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run'}
[0m15:47:03.204391 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'postgres_host'
[0m15:47:03.206970 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.1549949, "process_in_blocks": "44456", "process_kernel_time": 0.264832, "process_mem_max_rss": "99912", "process_out_blocks": "8", "process_user_time": 2.24606}
[0m15:47:03.207924 [debug] [MainThread]: Command `dbt run` failed at 15:47:03.207743 after 0.16 seconds
[0m15:47:03.208648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffc33b7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffbf0d7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ffbf0d4b30>]}
[0m15:47:03.209380 [debug] [MainThread]: Flushing usage events
[0m15:47:04.285573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:04.285337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dca359ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc9ad24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dcc6b0410>]}


============================== 15:59:04.289943 | dbd48b8c-f5f1-47c0-9c1d-debbea424583 ==============================
[0m15:59:04.289943 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:59:04.291003 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'quiet': 'False', 'write_json': 'True'}
[0m15:59:04.612557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dcc3d9670>]}
[0m15:59:04.707259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dcc2b4d70>]}
[0m15:59:04.712044 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:59:04.878307 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:59:05.078797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:05.079413 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:59:05.079936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:05.146384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc8b43f20>]}
[0m15:59:05.281916 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m15:59:05.288316 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m15:59:05.320434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc7fcd280>]}
[0m15:59:05.321357 [info ] [MainThread]: Found 5 models, 12 data tests, 2 sources, 464 macros
[0m15:59:05.322163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc8bbf3b0>]}
[0m15:59:05.325224 [info ] [MainThread]: 
[0m15:59:05.326044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:05.326735 [info ] [MainThread]: 
[0m15:59:05.327850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:05.335253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m15:59:05.433176 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m15:59:05.433939 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m15:59:05.434575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:07.520563 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.086 seconds
[0m15:59:07.522726 [debug] [ThreadPool]: On list_neondb: Close
[0m15:59:07.525179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public)
[0m15:59:07.536168 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m15:59:07.536960 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:59:07.537554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:09.009081 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.471 seconds
[0m15:59:09.013242 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m15:59:09.189753 [debug] [ThreadPool]: On list_neondb_public: Close
[0m15:59:09.202306 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:09.203185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:59:09.203863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:10.651867 [debug] [MainThread]: SQL status: SELECT 1 in 1.448 seconds
[0m15:59:10.656649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc73f7e00>]}
[0m15:59:10.657773 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:10.832680 [debug] [MainThread]: On master: COMMIT
[0m15:59:10.833505 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:10.834304 [debug] [MainThread]: On master: COMMIT
[0m15:59:11.181821 [debug] [MainThread]: SQL status: COMMIT in 0.347 seconds
[0m15:59:11.182643 [debug] [MainThread]: On master: Close
[0m15:59:11.186846 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m15:59:11.187891 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m15:59:11.189118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now model.medical_warehouse.stg_telegram_messages)
[0m15:59:11.190159 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m15:59:11.201221 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m15:59:11.202449 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m15:59:11.250165 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m15:59:11.251680 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m15:59:11.252547 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "neondb"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    /*
  STAGING MODEL: stg_telegram_messages

  Purpose:
    - Take raw data from `raw.telegram_messages`
    - Clean it, standardize it, and prepare for modeling
    - This is your "clean room" before building analytics tables

  Why?
    - Raw data may have bad types, missing values, or inconsistent formats
    - We fix that here so marts are trustworthy
*/

select
    -- Primary key
    message_id::bigint as message_id,

    -- Standardize channel name (lowercase for consistency)
    lower(channel_name)::text as channel_name,

    -- Fix date: ensure it's a proper timestamp
    message_date::timestamp as message_date,

    -- Handle missing text: replace NULL with empty string
    coalesce(message_text, '')::text as message_text,

    -- Numeric fields: treat NULL as 0
    coalesce(views, 0)::int as views,
    coalesce(forwards, 0)::int as forwards,

    -- Boolean flag: did this message have an image?
    coalesce(has_media, false)::bool as has_media,

    -- Add useful derived field
    length(coalesce(message_text, ''))::int as message_length

from "neondb"."raw"."telegram_messages"

-- Filter out garbage
where 
    message_id is not null
    and message_date is not null
    and message_date <= current_timestamp  -- no future dates!
  );
[0m15:59:11.253389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:13.138425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.885 seconds
[0m15:59:13.148857 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m15:59:13.149532 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m15:59:13.398229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.248 seconds
[0m15:59:13.405649 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m15:59:13.406918 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "neondb"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m15:59:13.670056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.262 seconds
[0m15:59:13.696332 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m15:59:13.697418 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m15:59:13.698369 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m15:59:13.963858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.265 seconds
[0m15:59:13.972150 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."stg_telegram_messages__dbt_backup"
[0m15:59:13.980103 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m15:59:13.981040 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "neondb"."public"."stg_telegram_messages__dbt_backup" cascade
[0m15:59:14.271224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.289 seconds
[0m15:59:14.275153 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m15:59:14.320986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dcc3d8740>]}
[0m15:59:14.323785 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 3.09s]
[0m15:59:14.327158 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m15:59:14.332732 [debug] [Thread-3 (]: Began running node model.medical_warehouse.dim_channels
[0m15:59:14.333889 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_dates
[0m15:59:14.335003 [debug] [Thread-2 (]: Began running node model.medical_warehouse.fct_image_detections
[0m15:59:14.336015 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fct_messages
[0m15:59:14.342350 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fct_messages ............................... [RUN]
[0m15:59:14.337717 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_channels ............................... [RUN]
[0m15:59:14.345108 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m15:59:14.346100 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.dim_channels
[0m15:59:14.338973 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_dates .................................. [RUN]
[0m15:59:14.353032 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_dates'
[0m15:59:14.341051 [info ] [Thread-2 (]: 4 of 5 START sql table model public.fct_image_detections ....................... [RUN]
[0m15:59:14.355246 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.medical_warehouse.fct_image_detections'
[0m15:59:14.356149 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.fct_image_detections
[0m15:59:14.343554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.fct_messages)
[0m15:59:14.354058 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_dates
[0m15:59:14.363780 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m15:59:14.372810 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m15:59:14.366526 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fct_messages
[0m15:59:14.365457 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.fct_image_detections"
[0m15:59:14.381071 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.fct_image_detections
[0m15:59:14.374386 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.dim_channels
[0m15:59:14.394846 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fct_messages"
[0m15:59:14.450489 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_dates
[0m15:59:14.453229 [debug] [Thread-3 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m15:59:14.458484 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m15:59:14.459159 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fct_messages
[0m15:59:14.450154 [debug] [Thread-2 (]: Writing runtime sql for node "model.medical_warehouse.fct_image_detections"
[0m15:59:14.466172 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m15:59:14.467124 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fct_messages"
[0m15:59:14.467832 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m15:59:14.468736 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  
    

  create  table "neondb"."public"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    select
    md5(channel_name) as channel_key,
    channel_name,
    case
        when channel_name like '%pharma%' then 'Pharmaceutical'
        when channel_name like '%cosmetic%' then 'Cosmetics'
        else 'Medical'
    end as channel_type,
    min(message_date) as first_post_date,
    max(message_date) as last_post_date,
    count(*) as total_posts,
    avg(views) as avg_views
from "neondb"."public"."stg_telegram_messages"
group by 1, 2, 3
  );
  
[0m15:59:14.469837 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m15:59:14.470537 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  
    

  create  table "neondb"."public"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql
with date_range as (
    select 
        min(message_date)::date as min_date,
        max(message_date)::date as max_date
    from "neondb"."public"."stg_telegram_messages"
),
date_series as (
    select generate_series(
        (select min_date - 30 from date_range),   -- 30 days before earliest message
        (select max_date + 30 from date_range),   -- 30 days after latest message
        '1 day'::interval
    )::date as full_date
)
select
    to_char(full_date, 'YYYYMMDD')::int as date_key,
    full_date,
    extract(isodow from full_date)::int as day_of_week,
    trim(to_char(full_date, 'Day')) as day_name,
    extract(week from full_date)::int as week_of_year,
    extract(month from full_date)::int as month,
    trim(to_char(full_date, 'Month')) as month_name,
    extract(quarter from full_date)::int as quarter,
    extract(year from full_date)::int as year,
    case when extract(isodow from full_date) in (6,7) then true else false end as is_weekend
from date_series
  );
  
[0m15:59:14.471366 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:59:14.472229 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */

  
    

  create  table "neondb"."public"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    /*
  Enriched fact table: links YOLO image categories to messages.
  Enables analysis like: "Do promotional posts get more views?"
*/
select
    y.message_id::bigint,
    md5(y.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    y.detected_objects,
    y.confidence_score,
    y.image_category
from "neondb"."raw"."yolo_detections" y
join "neondb"."public"."stg_telegram_messages" s
    on y.message_id::text = s.message_id::text
    and y.channel_name = s.channel_name
  );
  
[0m15:59:14.472897 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m15:59:14.473565 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:59:14.474553 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:59:14.475938 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */

  
    

  create  table "neondb"."public"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    select
    s.message_id,
    md5(s.channel_name) as channel_key,
    to_char(s.message_date, 'YYYYMMDD')::int as date_key,
    s.message_text,
    s.message_length,
    s.views,
    s.forwards,
    s.has_media
from "neondb"."public"."stg_telegram_messages" s
  );
  
[0m15:59:14.477940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:15.913910 [debug] [Thread-4 (]: SQL status: SELECT 1291 in 1.440 seconds
[0m15:59:15.923299 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m15:59:15.923997 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m15:59:16.097071 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.172 seconds
[0m15:59:16.107010 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m15:59:16.107946 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "neondb"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m15:59:16.279168 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.170 seconds
[0m15:59:16.281794 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m15:59:16.282489 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m15:59:16.283140 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m15:59:16.454949 [debug] [Thread-4 (]: SQL status: COMMIT in 0.171 seconds
[0m15:59:16.461238 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public"."dim_dates__dbt_backup"
[0m15:59:16.468131 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m15:59:16.468911 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop table if exists "neondb"."public"."dim_dates__dbt_backup" cascade
[0m15:59:16.648628 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.179 seconds
[0m15:59:16.652176 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: Close
[0m15:59:16.653211 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc4524680>]}
[0m15:59:16.654156 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_dates ............................. [[32mSELECT 1291[0m in 2.30s]
[0m15:59:16.655053 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_dates
[0m15:59:16.756832 [debug] [Thread-1 (]: SQL status: SELECT 276 in 2.279 seconds
[0m15:59:16.762724 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m15:59:16.763525 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages" rename to "fct_messages__dbt_backup"
[0m15:59:16.775593 [debug] [Thread-2 (]: SQL status: SELECT 466 in 2.301 seconds
[0m15:59:16.781729 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m15:59:16.782720 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "neondb"."public"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m15:59:17.082429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.318 seconds
[0m15:59:17.086719 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m15:59:17.087523 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
alter table "neondb"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m15:59:17.201132 [debug] [Thread-3 (]: SQL status: SELECT 3 in 2.730 seconds
[0m15:59:17.210569 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m15:59:17.211356 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels" rename to "dim_channels__dbt_backup"
[0m15:59:17.373734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.285 seconds
[0m15:59:17.378440 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m15:59:17.379699 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m15:59:17.381015 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: COMMIT
[0m15:59:17.498325 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.286 seconds
[0m15:59:17.578060 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m15:59:17.578976 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "neondb"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m15:59:17.658011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.276 seconds
[0m15:59:17.665165 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public"."fct_messages__dbt_backup"
[0m15:59:17.666103 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.883 seconds
[0m15:59:17.667773 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fct_messages"
[0m15:59:17.671703 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m15:59:17.672904 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_messages"} */
drop table if exists "neondb"."public"."fct_messages__dbt_backup" cascade
[0m15:59:17.673869 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
alter table "neondb"."public"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m15:59:17.868449 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.289 seconds
[0m15:59:17.871168 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m15:59:17.871814 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m15:59:17.872384 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m15:59:17.943617 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.269 seconds
[0m15:59:17.944503 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.270 seconds
[0m15:59:17.947125 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m15:59:17.949211 [debug] [Thread-1 (]: On model.medical_warehouse.fct_messages: Close
[0m15:59:17.949976 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m15:59:17.950767 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: COMMIT
[0m15:59:17.951653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc8fa5df0>]}
[0m15:59:17.952955 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fct_messages .......................... [[32mSELECT 276[0m in 3.61s]
[0m15:59:17.954080 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fct_messages
[0m15:59:18.142771 [debug] [Thread-3 (]: SQL status: COMMIT in 0.270 seconds
[0m15:59:18.146315 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public"."dim_channels__dbt_backup"
[0m15:59:18.147564 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m15:59:18.148191 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop table if exists "neondb"."public"."dim_channels__dbt_backup" cascade
[0m15:59:18.224204 [debug] [Thread-2 (]: SQL status: COMMIT in 0.272 seconds
[0m15:59:18.227457 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public"."fct_image_detections__dbt_backup"
[0m15:59:18.228703 [debug] [Thread-2 (]: Using postgres connection "model.medical_warehouse.fct_image_detections"
[0m15:59:18.229290 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fct_image_detections"} */
drop table if exists "neondb"."public"."fct_image_detections__dbt_backup" cascade
[0m15:59:18.428294 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.279 seconds
[0m15:59:18.431438 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: Close
[0m15:59:18.433498 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc663db50>]}
[0m15:59:18.434671 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_channels .......................... [[32mSELECT 3[0m in 4.09s]
[0m15:59:18.435776 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.dim_channels
[0m15:59:18.514485 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.284 seconds
[0m15:59:18.516578 [debug] [Thread-2 (]: On model.medical_warehouse.fct_image_detections: Close
[0m15:59:18.517542 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd48b8c-f5f1-47c0-9c1d-debbea424583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc663d670>]}
[0m15:59:18.519308 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.fct_image_detections .................. [[32mSELECT 466[0m in 4.16s]
[0m15:59:18.520902 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.fct_image_detections
[0m15:59:18.522845 [debug] [MainThread]: On master: COMMIT
[0m15:59:18.523518 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:18.524113 [debug] [MainThread]: On master: COMMIT
[0m15:59:18.524697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:20.240184 [debug] [MainThread]: SQL status: COMMIT in 1.715 seconds
[0m15:59:20.240987 [debug] [MainThread]: On master: Close
[0m15:59:20.242177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:20.242785 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_messages' was properly closed.
[0m15:59:20.243305 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m15:59:20.243823 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_dates' was properly closed.
[0m15:59:20.244324 [debug] [MainThread]: Connection 'model.medical_warehouse.fct_image_detections' was properly closed.
[0m15:59:20.245014 [info ] [MainThread]: 
[0m15:59:20.245744 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 14.92 seconds (14.92s).
[0m15:59:20.247780 [debug] [MainThread]: Command end result
[0m15:59:20.281629 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m15:59:20.284167 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m15:59:20.292001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m15:59:20.292695 [info ] [MainThread]: 
[0m15:59:20.293356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:20.293944 [info ] [MainThread]: 
[0m15:59:20.294734 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:59:20.296190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.088362, "process_in_blocks": "11376", "process_kernel_time": 0.324474, "process_mem_max_rss": "127952", "process_out_blocks": "2184", "process_user_time": 3.647095}
[0m15:59:20.297024 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:20.296874 after 16.09 seconds
[0m15:59:20.297659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dca359ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dca0c7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721dc66e20c0>]}
[0m15:59:20.298270 [debug] [MainThread]: Flushing usage events
[0m15:59:21.361930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:02.722359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaaafeb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaaa89b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaaaf9b200>]}


============================== 16:10:02.729684 | a64bd916-8157-4284-b31c-64c539a13485 ==============================
[0m16:10:02.729684 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:10:02.730902 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/logs', 'invocation_command': 'dbt test', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'no_print': 'None', 'warn_error': 'None', 'empty': 'None', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True'}
[0m16:10:03.015725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a64bd916-8157-4284-b31c-64c539a13485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaa972d640>]}
[0m16:10:03.107007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a64bd916-8157-4284-b31c-64c539a13485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaaa071250>]}
[0m16:10:03.108463 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:10:03.254708 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:10:03.446722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:03.447357 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:10:03.447920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:03.513099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a64bd916-8157-4284-b31c-64c539a13485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaaa1869f0>]}
[0m16:10:03.641697 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m16:10:03.644456 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m16:10:03.687305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a64bd916-8157-4284-b31c-64c539a13485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaa7fc00b0>]}
[0m16:10:03.688084 [info ] [MainThread]: Found 5 models, 12 data tests, 2 sources, 464 macros
[0m16:10:03.688670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a64bd916-8157-4284-b31c-64c539a13485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaa937d7f0>]}
[0m16:10:03.692034 [info ] [MainThread]: 
[0m16:10:03.692729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:03.693575 [info ] [MainThread]: 
[0m16:10:03.694638 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:03.700803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public'
[0m16:10:03.799054 [debug] [ThreadPool]: Using postgres connection "list_neondb_public"
[0m16:10:03.800290 [debug] [ThreadPool]: On list_neondb_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_neondb_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:10:03.801444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:05.915406 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.114 seconds
[0m16:10:05.919559 [debug] [ThreadPool]: On list_neondb_public: ROLLBACK
[0m16:10:06.088017 [debug] [ThreadPool]: On list_neondb_public: Close
[0m16:10:06.095967 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:06.096711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:10:06.097550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:07.551700 [debug] [MainThread]: SQL status: SELECT 1 in 1.454 seconds
[0m16:10:07.553697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a64bd916-8157-4284-b31c-64c539a13485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaacac0fe0>]}
[0m16:10:07.554688 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:07.729491 [debug] [MainThread]: On master: COMMIT
[0m16:10:07.730270 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:07.730890 [debug] [MainThread]: On master: COMMIT
[0m16:10:08.080999 [debug] [MainThread]: SQL status: COMMIT in 0.350 seconds
[0m16:10:08.082038 [debug] [MainThread]: On master: Close
[0m16:10:08.087725 [debug] [Thread-1 (]: Began running node test.medical_warehouse.assert_no_future_messages
[0m16:10:08.088617 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m16:10:08.089437 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m16:10:08.090455 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m16:10:08.091098 [info ] [Thread-1 (]: 1 of 12 START test assert_no_future_messages ................................... [RUN]
[0m16:10:08.095935 [info ] [Thread-2 (]: 2 of 12 START test not_null_dim_channels_channel_key ........................... [RUN]
[0m16:10:08.097298 [info ] [Thread-3 (]: 3 of 12 START test not_null_dim_dates_date_key ................................. [RUN]
[0m16:10:08.098028 [info ] [Thread-4 (]: 4 of 12 START test not_null_fct_messages_message_id ............................ [RUN]
[0m16:10:08.098783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public, now test.medical_warehouse.assert_no_future_messages)
[0m16:10:08.099501 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0'
[0m16:10:08.100199 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348'
[0m16:10:08.101025 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_fct_messages_message_id.de346706b5'
[0m16:10:08.101986 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.assert_no_future_messages
[0m16:10:08.103056 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m16:10:08.103775 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m16:10:08.104577 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m16:10:08.117033 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.assert_no_future_messages"
[0m16:10:08.173213 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m16:10:08.174798 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m16:10:08.175428 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m16:10:08.178478 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.assert_no_future_messages
[0m16:10:08.180149 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m16:10:08.181311 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m16:10:08.197805 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m16:10:08.227723 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.assert_no_future_messages"
[0m16:10:08.238729 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m16:10:08.240153 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m16:10:08.245023 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m16:10:08.248110 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.assert_no_future_messages"
[0m16:10:08.249727 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"
[0m16:10:08.250998 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.assert_no_future_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  /*
  CUSTOM TEST: No messages should have future dates
  This enforces a business rule: data must be from the past/present
  PASS = returns 0 rows
*/

select *
from "neondb"."public"."stg_telegram_messages"
where message_date > current_timestamp
  
  
      
    ) dbt_internal_test
[0m16:10:08.252119 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"
[0m16:10:08.256668 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_key
from "neondb"."public"."dim_channels"
where channel_key is null



  
  
      
    ) dbt_internal_test
[0m16:10:08.253195 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "neondb"."public"."fct_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m16:10:08.258871 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:10:08.255486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:08.254190 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"
[0m16:10:08.260791 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_key
from "neondb"."public"."dim_dates"
where date_key is null



  
  
      
    ) dbt_internal_test
[0m16:10:08.257788 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:10:08.262145 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:10:09.657112 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.395 seconds
[0m16:10:09.666529 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348: ROLLBACK
[0m16:10:09.696193 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.441 seconds
[0m16:10:09.698415 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: ROLLBACK
[0m16:10:09.699094 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.440 seconds
[0m16:10:09.701051 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m16:10:09.838012 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348: Close
[0m16:10:09.839526 [info ] [Thread-3 (]: 3 of 12 PASS not_null_dim_dates_date_key ....................................... [[32mPASS[0m in 1.74s]
[0m16:10:09.840863 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348
[0m16:10:09.841575 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m16:10:09.842401 [info ] [Thread-3 (]: 5 of 12 START test not_null_stg_telegram_messages_message_id ................... [RUN]
[0m16:10:09.843196 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348, now test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m16:10:09.844101 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m16:10:09.852510 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m16:10:09.854017 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m16:10:09.860968 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m16:10:09.865386 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m16:10:09.866561 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "neondb"."public"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m16:10:09.867536 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:09.870534 [debug] [Thread-1 (]: On test.medical_warehouse.assert_no_future_messages: Close
[0m16:10:09.876263 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fct_messages_message_id.de346706b5: Close
[0m16:10:09.873707 [info ] [Thread-1 (]: 1 of 12 PASS assert_no_future_messages ......................................... [[32mPASS[0m in 1.77s]
[0m16:10:09.882222 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.assert_no_future_messages
[0m16:10:09.883287 [debug] [Thread-1 (]: Began running node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m16:10:09.879662 [info ] [Thread-4 (]: 4 of 12 PASS not_null_fct_messages_message_id .................................. [[32mPASS[0m in 1.78s]
[0m16:10:09.890025 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fct_messages_message_id.de346706b5
[0m16:10:09.892241 [debug] [Thread-4 (]: Began running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m16:10:09.887723 [info ] [Thread-1 (]: 6 of 12 START test relationships_fct_image_detections_message_id__message_id__ref_fct_messages_  [RUN]
[0m16:10:09.893470 [info ] [Thread-4 (]: 7 of 12 START test relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [RUN]
[0m16:10:09.895288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.assert_no_future_messages, now test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62)
[0m16:10:09.898144 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m16:10:09.896627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fct_messages_message_id.de346706b5, now test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a)
[0m16:10:09.918478 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m16:10:09.917334 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m16:10:09.935019 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m16:10:09.933669 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m16:10:09.942371 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m16:10:09.947539 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m16:10:09.941131 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m16:10:09.949557 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"
[0m16:10:09.950846 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select message_id as from_field
    from "neondb"."public"."fct_image_detections"
    where message_id is not null
),

parent as (
    select message_id as to_field
    from "neondb"."public"."fct_messages"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:10:09.954521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:09.953410 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"
[0m16:10:09.956780 [debug] [Thread-4 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_key as from_field
    from "neondb"."public"."fct_messages"
    where channel_key is not null
),

parent as (
    select channel_key as to_field
    from "neondb"."public"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:10:09.958431 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:10.429810 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.172 seconds
[0m16:10:10.432488 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: ROLLBACK
[0m16:10:10.704801 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0: Close
[0m16:10:10.706865 [info ] [Thread-2 (]: 2 of 12 PASS not_null_dim_channels_channel_key ................................. [[32mPASS[0m in 2.61s]
[0m16:10:10.708636 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0
[0m16:10:10.709501 [debug] [Thread-2 (]: Began running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m16:10:10.710311 [info ] [Thread-2 (]: 8 of 12 START test relationships_fct_messages_date_key__date_key__ref_dim_dates_  [RUN]
[0m16:10:10.711225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0, now test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32)
[0m16:10:10.711897 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m16:10:10.725684 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m16:10:10.727262 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m16:10:10.733457 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m16:10:10.735255 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"
[0m16:10:10.736845 [debug] [Thread-2 (]: On test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select date_key as from_field
    from "neondb"."public"."fct_messages"
    where date_key is not null
),

parent as (
    select date_key as to_field
    from "neondb"."public"."dim_dates"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:10:10.738454 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:11.266676 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.399 seconds
[0m16:10:11.268823 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m16:10:11.342575 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.388 seconds
[0m16:10:11.347083 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62: ROLLBACK
[0m16:10:11.380861 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.422 seconds
[0m16:10:11.383167 [debug] [Thread-4 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: ROLLBACK
[0m16:10:11.439457 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m16:10:11.444134 [info ] [Thread-3 (]: 5 of 12 PASS not_null_stg_telegram_messages_message_id ......................... [[32mPASS[0m in 1.60s]
[0m16:10:11.445961 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m16:10:11.447130 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m16:10:11.448651 [info ] [Thread-3 (]: 9 of 12 START test unique_dim_channels_channel_key ............................. [RUN]
[0m16:10:11.450599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56)
[0m16:10:11.452689 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m16:10:11.464988 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m16:10:11.466414 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m16:10:11.471438 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m16:10:11.473153 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"
[0m16:10:11.474439 [debug] [Thread-3 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_key as unique_field,
    count(*) as n_records

from "neondb"."public"."dim_channels"
where channel_key is not null
group by channel_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:10:11.475504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:11.517911 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62: Close
[0m16:10:11.519887 [info ] [Thread-1 (]: 6 of 12 PASS relationships_fct_image_detections_message_id__message_id__ref_fct_messages_  [[32mPASS[0m in 1.62s]
[0m16:10:11.522057 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62
[0m16:10:11.523910 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m16:10:11.526122 [info ] [Thread-1 (]: 10 of 12 START test unique_dim_dates_date_key .................................. [RUN]
[0m16:10:11.530646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_image_detections_message_id__message_id__ref_fct_messages_.d16d425f62, now test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d)
[0m16:10:11.531603 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m16:10:11.537190 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m16:10:11.538281 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m16:10:11.544418 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m16:10:11.548322 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"
[0m16:10:11.549544 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "neondb"."public"."dim_dates"
where date_key is not null
group by date_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:10:11.550654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:11.559339 [debug] [Thread-4 (]: On test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a: Close
[0m16:10:11.561448 [info ] [Thread-4 (]: 7 of 12 PASS relationships_fct_messages_channel_key__channel_key__ref_dim_channels_  [[32mPASS[0m in 1.66s]
[0m16:10:11.563869 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a
[0m16:10:11.565200 [debug] [Thread-4 (]: Began running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m16:10:11.566475 [info ] [Thread-4 (]: 11 of 12 START test unique_fct_messages_message_id ............................. [RUN]
[0m16:10:11.568204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a, now test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d)
[0m16:10:11.571158 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m16:10:11.688232 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m16:10:11.689760 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m16:10:11.694704 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m16:10:11.696018 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"
[0m16:10:11.696661 [debug] [Thread-4 (]: On test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "neondb"."public"."fct_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:10:11.697255 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:12.185112 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.447 seconds
[0m16:10:12.187842 [debug] [Thread-2 (]: On test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32: ROLLBACK
[0m16:10:12.362433 [debug] [Thread-2 (]: On test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32: Close
[0m16:10:12.364002 [info ] [Thread-2 (]: 8 of 12 PASS relationships_fct_messages_date_key__date_key__ref_dim_dates_ ..... [[32mPASS[0m in 1.65s]
[0m16:10:12.367431 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32
[0m16:10:12.369855 [debug] [Thread-2 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m16:10:12.372383 [info ] [Thread-2 (]: 12 of 12 START test unique_stg_telegram_messages_message_id .................... [RUN]
[0m16:10:12.373830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32, now test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1)
[0m16:10:12.374518 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m16:10:12.380405 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m16:10:12.381494 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m16:10:12.385998 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m16:10:12.387394 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m16:10:12.388465 [debug] [Thread-2 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "neondb"."public"."stg_telegram_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:10:12.389490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:12.864932 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.389 seconds
[0m16:10:12.868115 [debug] [Thread-3 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: ROLLBACK
[0m16:10:12.981883 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.431 seconds
[0m16:10:12.983946 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d: ROLLBACK
[0m16:10:13.038115 [debug] [Thread-3 (]: On test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56: Close
[0m16:10:13.039422 [info ] [Thread-3 (]: 9 of 12 PASS unique_dim_channels_channel_key ................................... [[32mPASS[0m in 1.59s]
[0m16:10:13.040562 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56
[0m16:10:13.159765 [debug] [Thread-1 (]: On test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d: Close
[0m16:10:13.161234 [info ] [Thread-1 (]: 10 of 12 PASS unique_dim_dates_date_key ........................................ [[32mPASS[0m in 1.63s]
[0m16:10:13.162450 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d
[0m16:10:13.927896 [debug] [Thread-4 (]: SQL status: SELECT 1 in 2.230 seconds
[0m16:10:13.931027 [debug] [Thread-4 (]: On test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d: ROLLBACK
[0m16:10:14.017327 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.628 seconds
[0m16:10:14.020552 [debug] [Thread-2 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: ROLLBACK
[0m16:10:14.194923 [debug] [Thread-2 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: Close
[0m16:10:14.196326 [info ] [Thread-2 (]: 12 of 12 PASS unique_stg_telegram_messages_message_id .......................... [[32mPASS[0m in 1.82s]
[0m16:10:14.197543 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m16:10:14.215918 [debug] [Thread-4 (]: On test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d: Close
[0m16:10:14.217919 [info ] [Thread-4 (]: 11 of 12 PASS unique_fct_messages_message_id ................................... [[32mPASS[0m in 2.65s]
[0m16:10:14.219348 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d
[0m16:10:14.221945 [debug] [MainThread]: On master: COMMIT
[0m16:10:14.222621 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:14.223157 [debug] [MainThread]: On master: COMMIT
[0m16:10:14.223721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:15.607756 [debug] [MainThread]: SQL status: COMMIT in 1.384 seconds
[0m16:10:15.608762 [debug] [MainThread]: On master: Close
[0m16:10:15.611315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:15.612277 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d' was properly closed.
[0m16:10:15.613237 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1' was properly closed.
[0m16:10:15.614197 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56' was properly closed.
[0m16:10:15.615392 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d' was properly closed.
[0m16:10:15.616559 [info ] [MainThread]: 
[0m16:10:15.617623 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 11.92 seconds (11.92s).
[0m16:10:15.621392 [debug] [MainThread]: Command end result
[0m16:10:15.668491 [debug] [MainThread]: Wrote artifact WritableManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/manifest.json
[0m16:10:15.672527 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/semantic_manifest.json
[0m16:10:15.690668 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/haben-etsay/Pictures/week 8/medical-telegram-warehouse/medical_warehouse/target/run_results.json
[0m16:10:15.692243 [info ] [MainThread]: 
[0m16:10:15.693791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:15.695382 [info ] [MainThread]: 
[0m16:10:15.697648 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m16:10:15.713871 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.068586, "process_in_blocks": "82192", "process_kernel_time": 0.420256, "process_mem_max_rss": "128116", "process_out_blocks": "2312", "process_user_time": 3.690255}
[0m16:10:15.716523 [debug] [MainThread]: Command `dbt test` succeeded at 16:10:15.715494 after 13.07 seconds
[0m16:10:15.720269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaacbe1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaacbe0c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaa6da4650>]}
[0m16:10:15.721560 [debug] [MainThread]: Flushing usage events
[0m16:10:16.763690 [debug] [MainThread]: An error was encountered while trying to flush usage events
